%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: paper.dvi
%%Pages: 13
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: /usr/pd/tex/teTeX-1.0/bin/dvips.bin paper -o paper.ps
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2002.05.28:1857
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (paper.dvi)
@start
%DVIPSBitmapFont: Fa cmti7 6 2
/Fa 2 84 df<D9FF80EB01FFA2010FEC03E01606011BEC07C0160D1619A2D931C0EB3380
1663A216C30161ECC700ED0187ED0307EB60E001C0EB060E150CA21518D801805C153015
601470D80300495AEC7180A2EC7300000601765BA2143C121F3AFFE0380FFF143030227A
A134>77 D<903801FC0C903807FF1890381E07B890383801F8EB70004913705B1201A248
481360A26D1300A27FEA01F813FF6C13F0EB3FFCEB0FFE1300141F80EC0780A300301400
A3140E127000785B5C007C5B38EF81E038C3FFC0D880FEC7FC1E247BA221>83
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fb cmsy6 6 2
/Fb 2 95 df<EA01E0EA03F0A4EA07E0A213C0120FA21380A2EA1F00A2121EA2123E123C
A25AA3127012F05A12600C1A7E9B12>48 D<497E497EA2497EA2497EEB0E70EB1E78EB1C
38EB3C3CEB381CEB781EEB700EEBF00F497E00011480EBC003000314C0EB8001000714E0
90C7FC4814F0000E1470001E1478001C1438003C143C0038141C0078141E0070140E00F0
140F481407150320207C9E2A>94 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fc cmmi9 9 7
/Fc 7 63 df<147F903803FFE090380FC0F890383F007C017C017E1360497F484815E048
4890381F80C0120748481481EEC1804848130F003F15C390C7140016C74815C6007E15CE
16DC16D816F8485D5E5E127CA3151F6C143F037713C06C903801E7E03A0F800783E13B07
C07E03E3803B01FFF801FF003A007F80007C2B227EA031>11 D<137CEB7F80EB1FE0130F
6D7EA26D7EA36D7EA36D7EA28080A26E7EA36E7EA281140FA26E7EA381140F141FEC3DFC
1479ECF8FEEB01F0EB03E0903807C07FEB0F80EB1F00013EEB3F80137E4914C04848131F
485A4848EB0FE0EA1FC0123F4848EB07F048C7FC4815F848140348EC01FC48140026357C
B32D>21 D<017FB512F048B612F85A5A4815E0261F0070C7FC123C1238485B126012E0EA
0001A3495AA31307A25C130FA3131FA291C8FC5BA35BA2137E133C25217E9F22>28
D<123C127E12FFA4127E123C08087A8715>58 D<123C127EB4FCA21380A2127F123D1201
A412031300A25A1206120E120C121C5A5A126009177A8715>I<171C177EEE01FEEE07FC
EE1FF0EE7FC0923801FF00ED07FCED1FF0ED7FC04A48C7FCEC07FCEC1FF0EC7FC04948C8
FCEB07FCEB1FF0EB7FC04848C9FCEA07FCEA1FF0EA7FC048CAFCA2EA7FC0EA1FF0EA07FC
EA01FF38007FC0EB1FF0EB07FCEB01FF9038007FC0EC1FF0EC07FCEC01FF9138007FC0ED
1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE01FEEE007E171C2F2E7AA93C>I<1270
12FCB4FCEA7FC0EA1FF0EA07FCEA01FF38007FC0EB1FF0EB07FCEB01FF9038007FC0EC1F
F0EC07FCEC01FF9138007FC0ED1FF0ED07FCED01FF9238007FC0EE1FF0EE07FCEE01FEA2
EE07FCEE1FF0EE7FC0923801FF00ED07FCED1FF0ED7FC04A48C7FCEC07FCEC1FF0EC7FC0
4948C8FCEB07FCEB1FF0EB7FC04848C9FCEA07FCEA1FF0EA7FC048CAFC12FC12702F2E7A
A93C>62 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fd cmsy9 9 20
/Fd 20 107 df<007FB712FCB812FEA26C16FC2F047A943C>0 D<EB1FC0EBFFF8487F00
0713FF390FF07F80391F800FC0393F0007E0003E130348EB01F0A248EB00F8A2481478A5
6C14F8A2007CEB01F0A26CEB03E0003F1307391F800FC0390FF07F806CB51200000113FC
6C5BEB1FC01D1D7CA126>14 D<EB1FC0EBFFF8487F000713FF4814804814C04814E0A248
14F0A2B612F8A96C14F0A26C14E0A26C14C06C14806C1400000113FC6C5BEB1FC01D1D7C
A126>I<007FB812C0B912E0A26C17C0CCFCAC007FB812C0B912E0A26C17C0CCFCAC007F
B812C0B912E0A26C17C033247CA43C>17 D<171C177EEE01FEEE07FCEE1FF0EE7FC09238
01FF00ED07FCED1FF0ED7FC04A48C7FCEC07FCEC1FF0EC7FC04948C8FCEB07FCEB1FF0EB
7FC04848C9FCEA07FCEA1FF0EA7FC048CAFCA2EA7FC0EA1FF0EA07FCEA01FF38007FC0EB
1FF0EB07FCEB01FF9038007FC0EC1FF0EC07FCEC01FF9138007FC0ED1FF0ED07FCED01FF
9238007FC0EE1FF0EE07FCEE01FEEE007E171C1700AC007FB712FCB812FEA26C16FC2F3E
7AB03C>20 D<013F16402601FFE015E04813F8487F4813FF4880D83FC06D1301273E001F
E014C048D907F8130300786D6C13070070D900FFEB0F8000F091387FE07F486EB512006F
5B03075B6F5B03005B0040ED1F8033127C9B3C>24 D<14E080A213015CA213035C130749
5AA249CCFC133E137E5B485A485AEA0FE0003FBA12E0BB12F0A2003F19E0D80FE0CCFCEA
03F06C7E6C7E137E133E7F6D7EA26D7E1303801301A2801300A25C44287CA64D>32
D<187018F0A2841878A2187C183C183E84A2727E727E85727E727E727E197F007FBA12C0
BB12F0A26C19C0CCEA7F0019FC4E5A4E5A4E5A614E5A4EC7FCA2183E183C187C1878A218
F860A2187044287CA64D>I<15F0A214014A5A5D14074A5AA24ACBFC143E5C91B912E049
18F05B010F18E0D91F80CBFC017FCCFC13FCEA07F8EA1FE0EAFF80A2EA1FE0EA07F8C67E
137FEB1F806DB912E0010318F07F6D18E0027CCBFC80806E7EA26E7E1403816E7E1400A2
442A7CA74D>40 D<17F0A283177C173C173E83A2717E717E717E007FB87EB97E846C17FF
CBEA1F80F00FE0F003F0F001FE9538007F80F11FF0A2F17F80953801FE00F003F0F00FE0
F01F80007FB9C7FCB912FC606C5FCAEA03E04D5A4D5A4DC8FCA2173E173C177C5F5FA244
2A7CA74D>I<01061306010F130FB3B3A20040162000F016F000FC150300FF150FD83F8F
EC1FC0D80FEFEC7F00D803FF14FC6C5D6C5D013F14C06D5C6D6C48C7FC903807C03E0103
133CECE07C6D6C5A01005B14F9EC79E0EC3FC0A26E5AA26EC8FCA31406A22C437FB32F>
43 D<91383FFFF849B512FC1307011F14F8D93FE0C7FC01FFC8FCEA01FCEA03F0485A48
5A5B48C9FC5A123E5AA21278A212F8A25AB712F816FCA216F800F0C9FC7EA21278A2127C
A27E123F7E6C7E7F6C7E6C7EEA01FC6CB4FCEB3FE06DB512F8010714FC1301D9003F13F8
262E7AA933>50 D<1630167816F8A2ED01F0A2ED03E0A2ED07C0A2ED0F80A2ED1F00A215
3EA25DA25DA24A5AA24A5AA24A5AA24A5AA24AC7FCA2143EA25CA25CA2495AA2495AA249
5AA2495AA249C8FCA2133EA25BA25BA2485AA2485AA2485AA2485AA248C9FCA2123EA25A
A25AA25A1260254675B500>54 D<0060ED018000F0ED03C06C1507A200781680007C150F
A2003C1600003E5DA26C153EA26C153C6D147CA26C6C5CA200035D90B6FCA26C5DA29038
F000036C6C495AA201785C017C130FA2013C91C7FC013E5BA26D133EA26D133CEC807CA2
01071378ECC0F8A2903803E1F0A201015B14F3A26DB45AA26E5AA36EC8FCA3141E140C2A
3680B32B>56 D<EC0180EC03C0A21407EB0FE790383FFF80EBF83F3801E00FEA03C0D807
8013C0390F001FE0A24814F0001E133E003E14F8143CA248EB7C7CA2147814F8A200FCEB
F07EA21301A214E01303A214C0A21307A21480A2130FA214005BA2131EA2D87C3E137CA2
133C137C007E14FCD83E7813F8A213F8001E14F0381FF001000F14E01403D807E013C000
03EB0780EC0F00EBF83EEBFFFC3807CFE001C0C7FC5BA26CC8FC1F407DB926>59
D<140C141E143FA24A7EA34A7EA2903801F3E0A2903803E1F0A214C001077FA290380F80
7CA249487EA2011E131E013E131FA2496D7EA2496D7EA2491303000181A248486D7EA248
486D7EA2491478000F157CA248C87EA2003E81A2003C81007C1680A248ED07C0A2481503
0060ED01802A307CAD33>94 D<0060ED018000F0ED03C06C1507A2007CED0F80A2003C16
00003E5DA26C153EA26C6C5CA2000715786D14F8A26C6C495AA26C6C495AA200005D6D13
07A2017C495AA26D49C7FCA2011E131E011F133EA26D6C5AA26D6C5AA201035B14E1A290
3801F3E0A26DB45AA26E5AA36EC8FCA2141E140C2A307CAD33>I<EC07E0143FECFE00EB
03F8495A495A5C131F5CB3A5133F91C7FC137E5BEA03F8EA7FE048C8FCEA7FE0EA03F8C6
7E137E7F80131FB3A580130F806D7E6D7EEB00FEEC3FE014071B4B7BB726>102
D<12FCEAFFC0EA07F0EA01FC6C7E137F7F80131FB3A580130F6D7E6D7EEB01FC9038007F
C0EC1FE0EC7FC0903801FC00EB03F0495A495A131F5CB3A5133F91C7FC5B13FE485AEA07
F0EAFFC000FCC8FC1B4B7BB726>I<126012F0B3B3B3B31260044B78B715>106
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fe cmti9 9 68
/Fe 68 123 df<DB07F8133EDB1FFFEBFF80923A7E0783E3C0923AF803C7C1E0912601F0
0F1387DA03E013CFA2DA07C090389F07C09339071F0380040090C7FC4A5A173EA3141F92
C7127E177CA35C143E011FB712F8A3D9007EC700F8C7FC147C16015FA214FC5C16035FA2
13015C16075FA313034A130F5FA313074A131F94C8FCA2130FA24A5B163EA2131F91C712
7E167CA2133E5E0038131C267E3C3F5B15013AFE787F03E000FC017E5B3AF8F03C0780D8
78E0011FC9FC393FC01FFC390F0003F03B4582B42F>11 D<923803FF80031F13F092383F
00F803F8133C4A48133E4A48137E17FE4A5A17FC17384A481300A3141F92C8FCA55C143E
011FB612E0A217C09039007E0007147C160F1780A214FC4A131F1700A301015C4A133EA3
167E0103147C5C1718EEFC1CEEF83C010715385C1778177016F0010F15F04AEBF8E01679
EE3FC0011FEC0F0093C7FC91C9FCA3133EA21238EA7E3C137CEAFE7812FC485AEA79E0EA
3FC0000FCAFC2F4582B42B>I<3803800E390FE03F80001F137FA53807601D00001301EB
E00301C01300A200015BEB80060003130E48485A00061318000E1338485B485B48485A48
485A00C090C7FC191773B327>34 D<D901F015E0D907F8EC01F0D90F1C1403D93E0EEC07
E0D97C0FEC0FC09026780780EB3F8001F801E0EB7F00D801F090387807FF92381FFFFED8
03E0903807F8FC92380001F8D807C04A5A5F4A495A000F010E130F01804A5A4CC7FC021E
137E021C5B01005C4A485A15034A485A9138F00FC04A485A494848C8FC390783803E3903
87007CD801FE13FC3900F801F8903A0003F001E0913907E007F891390FC01E1CED803C4A
48487E4A13F891387E01F002FCEBE006902601F8031307EB03F09139E007C00EEB07C001
0F130FD91F801380EB3F00017E151E49011F131C4914004848153C00031638485A484815
784848157048C75C003EEC0F01484B5A00FC4B5A48DA078FC7FC48EC03FC48EC00F8343C
74B73F>37 D<EA0380EA0FE0121FA5EA0760120013E013C0A2120113801203EA07001206
120E5A5A5A5A5A0B176FB318>39 D<1560EC01E0EC03C0EC0700140E5C143C5C5C495A49
5A13075C49C7FC5B131E5B137C137813F85B12015B12035B1207A25B120FA290C8FC5AA2
121E123EA3123C127CA31278A212F8A35AAF12701278A21238A2123C121CA27EA27E6C7E
12011B4A75B71F>I<14301438A28080A2140F801580A2140315C0A4140115E0A81403A4
15C0A31407A31580140FA315005CA3141E143EA2143C147CA25CA25C13015C13035C1307
5C130F91C7FC131E133E133C5B5B485AA2485A485A48C8FC121E5A12705A5A1B4A7EB71F
>I<EA0380EA0FE0121FA5EA0760120013E013C0A2120113801203EA07001206120E5A5A
5A5A5A0B177A8718>44 D<B51280A46C1300110579911B>I<121C127F12FFA412FE1238
0808778718>I<EC1FC0EC7FF0903801E0F8903807C03CEB0F00011E131E133E013C131F
5B13F85B1201A2485AA20007143F5BA2120F153E49137E121FA348C712FCA4007EEB01F8
A4007CEB03F012FCA2EC07E0A24814C0A2EC0F80A2EC1F00A2141E5C0078137C5C387C01
F0383C03E0381F0F80D80FFEC7FCEA03F8203477B127>48 D<EC01801403A21407140FEC
1F005C14FF5BEB1FFEEB7FBEEB7E7E1320EB007CA214FCA25CA21301A25CA21303A25CA2
1307A25CA2130FA25CA2131FA291C7FCA25BA2133EA2137EA2137C13FCB512FCA3193277
B127>I<EC0FE0EC3FF8ECF03E903803C01F903907800F80EB0F00011EEB07C0131C5BD9
78C013E0EB70E0EBF06013E0120113C0ECE00F000301C013C013801381EC801F01831480
903887003F018E1400D801FC137ED800F05B90380001F84A5A4A5A4A5A4AC7FC147E14F8
EB03E0EB0FC049C8FC133E13784848EB0380485A4913074848140048C75A121E001C141E
003F143E01F85B397DFF80F838781FFF486C5BD8E0035B6D1380D9007EC7FC23347AB127
>I<EC07F0EC3FFCECF81E903803E00F903907800780D90F0013C0011E13035B013814E0
EB7980EB71C00170130701F014C013E0A201E1130FD9E380138090387F001F013C140090
C7123E5D5D4A5AEC1FE0903807FF804AC7FC6D7E90380007C06E7EA26E7EA51403121812
7EA21407485C5A00E0495AA26C495A007049C7FC147E00785B383C01F0381E07E03807FF
80D801FCC8FC233479B127>I<010614C090380FC00F91B51280160015FC4913F015C0D9
1CFEC7FC91C8FC133C1338A313781370A313F0EBE0FE9038E3FF809038EF03C03901FC01
E001F87FEBF000497F485A5BC8FCA41401A4003C130300FC5CA34A5A5A00E0495AA24A5A
4AC7FC6C137E00705B387801F8383E07F0381FFFC06C90C8FCEA03F8223478B127>53
D<EC01F8EC0FFEEC3FFFECFE0F903901F80780903803E00F903807C01F90380F803FD91F
001300133E49130E01FC90C7FC5B1201485AA2485AA2380FC1F8EBC7FF9038CE0780391F
BC03C001F07FEBE001003F8013C01380A2D87F007FA2127E4A5AA25AA214075DA25A4A5A
A25D141F4AC7FC0078133E007C5B5C6C485A381F07E0EBFFC0000790C8FCEA01F8213477
B127>I<D9E0F81338EBE3FC2601EFFE137801FF14F048EC01E09038FE0E03D807F814C0
9039F0060F80390FC0071F90398003FF00391F0001EF001EEB001E003E5C123C485C15F8
485C4813015DC712034A5AA24A5AA2141F92C7FC5C143E147EA25CA2495AA3495AA21307
5CA2130F5CA2131FA25C133FA391C8FCA2131C253476B127>I<EC0FC0EC7FF0ECFFFC90
3803F07E903807C03E49487EEB1F00013E7F017E14805BA2485AA2485A151FA212075BA2
ED3F00A2485A5DA2000714FEA21401140300035CEBE0070001131E3900F039F8EB7FF1EB
0FC190380003F0A24A5AA25D4A5A141F003891C7FC007E133E00FE137E5C48485A48485A
48485A38781F80D87FFFC8FCEA1FFCEA07E0213478B127>57 D<1370EA01FC1203A413F8
EA00E01300B0121C127F5AA45A12380E20779F18>I<161C163CA2167C16FCA215018215
03A2ED077E150F150E151CA21538A2157015F015E0EC01C0A2913803807F82EC0700A214
0E141E141C5CA25CA25C49B6FCA25B913880003F49C7EA1F80A2130E131E131C133C1338
5B13F05B12011203D80FF0EC3FC0D8FFFE903807FFFEA32F367BB539>65
D<0107B612C04915F017FC903A003F8000FE177FEF3F8092C7121FA24A15C0A2147EA214
FE18804A143FA20101ED7F00177E4A5C16010103EC03F04C5A4AEB1FC091B6C7FC495C91
39F0007F804AEB0FC0707E010F6E7E834A1301A2011F81A25CA2133F5F91C71203A2494A
5AA2017E4A5A4C5A01FE4A5A4CC7FC49EB01FE0001EC07FC007FB612F0B712C04BC8FC32
337BB236>I<DB1FF013C09238FFFC010203EBFF03913A0FF00F878091393F8003CF9139
FE0001EF4948EB00FFD903F01500D90FE080495A49488091C8123E137E13FE485A484815
3CA2485AA248481538A2485A94C7FC123F5BA3127F90CBFCA412FEA2EE03C0A25F127E16
0794C7FC5E160E007F151E6C5D5E6C6C147016F06C6C495A6C6CEB07C06C6C49C8FC6C6C
133E6CB413FC90387FFFF0011F13C0D903FEC9FC323775B437>I<0107B612C04915F017
FC903A003F8001FEEE007FEF1F8092C7EA0FC0EF07E05CEF03F0147E170102FE15F8A25C
A21301A25CA2130317035CA2130718F04A1407A2130F18E04A140F18C0011F151F18805C
EF3F00133F177E91C85AA2494A5A4C5A017E4A5A4C5A01FE4A5A047EC7FC49495A0001EC
0FF8007FB612E0B7C8FC15F835337BB23A>I<0107B712F05B18E0903A003F80001F1707
170392C7FC17015C18C0147EA214FEA24A130EA20101EC1E03041C13804A91C7FC163C13
035E9138F001F891B5FC5B5EECE0011500130F5E5C1707011F01015BEEC00E0280141E92
C7121C133F173C91C812381778495DA2017E14014C5A01FE14074C5A49141F00014AB45A
007FB7FCB8FC94C7FC34337CB234>I<0107B712E05B18C0903A003F80003F170F170792
C7FC17035C1880147EA214FEA25C161C0101EC3C07043813004A91C7FCA2010314781670
4A13F0150349B5FCA25EECE003130F6F5A14C0A2011F13035E1480A2013F90C9FCA291CA
FCA25BA2137EA213FEA25B1201387FFFFCB5FCA233337CB232>I<92391FE001809238FF
F8030207EBFE07913A1FF01F0F0091393F80079F9139FE0003DFD901F86DB4FCD907F05C
49481300495A4948147E49C8127C137E13FE485A48481578A2485AA248481570A2485A94
C7FC123F5BA3127F90CBFCA400FE91383FFFFCA25F9238003F8094C7FCA2007E5DA2167E
A2007F15FE7E5E6C6C1301A26C6C495A6D13076C6CEB0F786C6C133E3A00FF01FC309038
7FFFF0011F01C0C8FCD903FEC9FC313775B43B>I<0107B548B512C0495CA2903C003FC0
000FF0004B5CA292C75BA24A141F60147EA202FE143F95C7FC5CA201015D177E5CA20103
15FE5F5C91B6FC5B5F9138E00001A2010F14035F5CA2011F14075F5CA2013F140F5F91C7
FCA249141F5F137EA201FE143F94C8FC5B00015D3B7FFFF01FFFFCB55BA23A337BB239>
I<010FB51280A216009038003FC05DA292C7FCA25CA2147EA214FEA25CA21301A25CA213
03A25CA21307A25CA2130FA25CA2131FA25CA2133FA291C8FCA25BA2137EA213FEA25B12
01B512F8A25C21337BB21E>I<91381FFFFE5C16FC9138003F80A31600A25D157EA315FE
5DA314015DA314035DA314075DA3140F5DA3141F5DA3143F92C7FCA2121C007E5B00FE13
7EA214FE485BEAF80100E05B495A387007E038780FC06C48C8FCEA1FFCEA07F0273579B2
28>I<0107B590380FFFF05B19E09026003FC0903803FE004B14F818E092C7485A4DC7FC
4A141E177C027E5CEE01E002FE495A4C5A4A011FC8FC163E010114785E4A485AED07C001
03495A4B7EECF03F157F903907F1FFE0ECF3E79138E787F0ECEF0790380FFE0302FC7FEC
F80114E0D91FC07F15004A7FA2013F147E167F91C77E835B161F017E81160F13FE835B00
0182267FFFF090B57EB55B95C7FC3C337BB23B>I<0107B512C05BA29026003FC0C7FC5D
A292C8FCA25CA2147EA214FEA25CA21301A25CA21303A25CA21307A25CA2130FA25C17E0
011F140117C05C1603013F1580160791C7FCEE0F005B5E017E143EA201FE5CED01FC4913
030001EC1FF8007FB6FCB7FC5E2B337CB230>I<902607FFC0ED7FFC4917FF81D9003F4B
1300611803023BED077CA2027BED0EFC610273151C1838DAF1F01439F071F014E118E101
01ED01C36102C1EC0383EF070301031607050E5BEC80F8171C0107ED380F6102001470A2
49EDE01FDC01C090C7FC130EEE0380011E017C5C933807003E011C140EA2013C4A137E18
7C01385C5E017816FC6F485B1370ED3FC001F0EC80016000011500D807F81503277FFF80
3E90B512C0B5EB3C01151C46337BB245>I<902607FF8090383FFFC0496D5BA2D9001F91
3803F8004A6C6D5A6060EC3BF0027B140360EC71F8A202F11407DAF0FC91C7FC14E0A201
01017E5B170E14C0810103151EEE801CEC801FA20107ECC03C030F1338140016E0490107
13781770010E14F01503011E15F0705A011C1301A2013C14FD03005B133816FF0178147F
5F0170143FA213F070C8FC1201EA07F8267FFF807FB5140EA23A337BB239>I<ED1FE091
3801FFFC913807E03F91391F800FC091393E0003E002F8EB01F0495A4948EB00F8494814
FC4948147C49C8127E133E017E153E49153F485AA2485A12075B120F5B121F177F5B123F
A348C912FEA4EE01FC12FEEE03F8A217F0160717E0160F007E16C0EE1F80A2EE3F006C15
7E5E5E6C6C495A000F4A5A6D495A0007EC1F806C6C013EC7FCD801F813FC39007E07F090
383FFF80D907FCC8FC303775B43B>I<0107B612C04915F883903A003F8001FEEE003FEF
1F8092C713C0170F5C18E0147EA214FEEF1FC05CA201011680173F4A1500177E010315FE
5F4AEB03F8EE07E00107EC3FC091B6C7FC16F802E0C9FC130FA25CA2131FA25CA2133FA2
91CAFCA25BA2137EA213FEA25B1201387FFFF0B5FCA233337CB234>I<ED1FE0913801FF
FC913807E03F91391F800FC091393E0007E002F8EB03F0494813014948EB00F8494814FC
4948147C49C8127E133E137E49153F12015B485A12075B120FA2485A177FA2485AA348C9
12FEA4007EED01FC12FE17F8160317F0160717E0160F007E16C0EE1F80A2023EEB3F0000
3E9038FF807E263F01C1137C90390380C0F8001F903800C1F0D80F87EBC3E001C6EBE7C0
0007ECFF80D803E649C7FCD801FE5B3B007F07F0018090383FFFE0D907FC130390C71400
5E1401160EEDF01EEDF87EEDFFFC5EA26E5B5E6F5A031FC7FC304475B43B>I<0107B512
FE49ECFFC017F0903A003F8007F8EE01FCEE007E92C7127F835C1880147EA214FEEF7F00
5CA2010115FE5F4A13015F01034A5AEE0FC04A495A04FEC7FC49B512F016C09138E003E0
ED01F8010F6D7E167C4A137EA2131FA25CA2013F14FEA291C7FCA24913015E137EEF01C0
01FE150318805B00011607277FFFF0001400B5ECFE0EEE7E1CC9EA1FF8EE07E032357BB2
38>I<913901FC018091380FFF03023F13C791387E07EF903A01F801FF0049487E4A7F49
5A4948133E131F91C7FC5B013E143CA3137E1638A293C7FC137FA26D7E14E014FE90381F
FFC06D13F86D7F01017F6D6C7E020F7F1400153F6F7E150FA4120EA2001E5D121CA2151F
003C92C7FCA2003E143E5D127E007F5C6D485A9038C007E039F3F80FC000F0B5C8FC38E0
3FFC38C00FF029377AB42B>I<0003B812C05A1880903AF800FC003F260FC001141F0180
150F01005B001EEE07001403121C003C4A5BA200380107140E127800705CA2020F141E00
F0161CC74990C7FCA2141FA25DA2143FA292C9FCA25CA2147EA214FEA25CA21301A25CA2
1303A25CA21307A25C497E001FB512F05AA2323374B237>I<3B3FFFF801FFFE485CA2D8
01FEC7EA1FC049EC0F80170049140EA2161E120349141CA2163C1207491438A21678120F
491470A216F0121F495CA21501123F90C75BA215035A007E5DA2150712FE4892C7FCA25D
150E48141E151C153C153815786C5C5D007C1301007E495A003EEB0F806C011EC8FC380F
C0FC6CB45A000113E06C6CC9FC2F3570B239>I<B500C090383FFF80A3D807F8C73807F8
0049EC03E05F00034B5A94C7FC5E160E5EA25E167816705E7F00014A5A15035E4BC8FCA2
150E151E151C5D7F5D000014F05D4A5AA24A5AA24AC9FC140EA26D5A137E5C147814705C
A2EB7FC0A25C91CAFCA2133EA2133C1338313570B239>I<B53CC03FFFF003FFF8601480
280FF00001FCC7EA7F806C484AEC3E00193CA219386115036115074E5A030F140361031D
4AC7FCA2DB38FC130EA203705C15F06C6C01E05C140103C05CDA038014F060DA07001301
60020E4A5AA24A4AC8FCA24A140E147802705C5C5FD9F1C014781770D9F3805CA201F7C7
EA7FC0A201FE5DA26C4892C9FCA249147E5B167C5B1678491470453570B24D>I<013013
C0EBF0033901C007003803800E48485A00061318000E1338485B00181360003813E00030
5BEA700100605BA2EAE00300DE137800FF13FCA500FE5B383800E01A176CB327>92
D<EB03F0EB0FF890383E1C6090387C0FF0EBF807EA01F0EA03E00007EB03E0EA0FC0A238
1F800715C0EA3F00A2140F481480127EA2141F00FE14005A1506EC3F07EC3E0F150E147E
007C141EECFE1CEB01FCD83C03133C393E07BE38391F0E1E783907FC0FF03901F003C020
2278A027>97 D<137EEA0FFE121F5B1200A35BA21201A25BA21203A25BA21207A2EBC3E0
EBCFF8380FDC3EEBF81F497E01E01380EA1FC0138015C013005AA2123EA2007E131F1580
127CA2143F00FC14005AA2147EA25CA2387801F85C495A6C485A495A6C48C7FCEA0FFCEA
03F01A3578B323>I<14FCEB07FF90381F078090383E03C0EBFC013801F8033803F00738
07E00F13C0120F391F80070091C7FC48C8FCA35A127EA312FE5AA4007C14C0EC01E0A2EC
03C06CEB0F80EC1F006C137C380F81F03803FFC0C648C7FC1B2278A023>I<ED0FC0EC03
FFA21680EC001FA31600A25DA2153EA2157EA2157CA215FCA2903803F0F8EB0FF8EB3E1D
EB7C0F496C5AEA01F0EA03E000071303D80FC05BA2381F8007A2D83F005BA2140F5A007E
5CA2141F12FE4891C7FC1506EC3F075DEC3E0E147E007C141EECFE1CEB01FCD83C03133C
393E07BE38391F0E1E783907FC0FF03901F003C0223578B327>I<EB03F8EB0FFEEB3E0F
9038F807803801F003EA03E0EA07C0120FEA1F801407D83F0013005C007E133EEB03F838
7FFFE04848C7FC00FCC8FCA45AA4EC0180EC03C0A2007CEB0780EC1F00003C133E6C13F8
380F03E03807FF80D801FCC7FC1A2277A023>I<151FED7FC0EDF0E0020113F0EC03E3A2
EC07C316E0EDC1C091380FC0005DA4141F92C7FCA45C143E90381FFFFEA3D9007EC7FC14
7CA414FC5CA513015CA413035CA413075CA3130FA25CA3131F91C8FCA35B133E1238EA7E
3CA2EAFE7812FC485AEA78E0EA3FC0000FC9FC244582B418>I<143FECFF80903803E1E6
903807C0FF90380F807FEB1F00133E017E133F49133EA24848137EA24848137CA215FC12
074913F8A21401A2D80FC013F0A21403120715E01407140F141F3903E03FC00001137FEB
F0FF38007FCF90381F0F801300141FA21500A25C143E1238007E137E5C00FE5B48485A38
7803E0387C0F80D81FFFC7FCEA07F820317CA023>I<EB0FC0EA03FFA25CEA001FA391C8
FCA25BA2133EA2137EA2137CA213FCA29038F83F80ECFFE03901FBE0F09038FF80F8EC00
7849137C485A5B5BA2484813FC5D5BA2000F13015D1380A2001F13035DEB0007EDC0C048
ECC1E0020F13C0003E1481A2007E1483ED0380007C1407160000FC140E151E48EB07F800
70EB01F023357BB327>I<EB0180EB07E0A2130FEB07C0EB038090C7FCABEA01F0EA03FC
EA0F1E120E121C123C1238EA783E1270A2137EEAF07CEA60FCC65AA212015BA212035BA2
000713C0EBC1E0000F13C01381A21383EB038013071400130E131EEA07F8EA01F013337A
B118>I<EB0FC0EA01FF5A5CEA001FA391C7FCA25BA2133EA2137EA2137CA213FCA24913
78EC01FE0001EB078FEC0E0F9038F01C3F143800031370ECE03E9038E1C01C9038E38000
D807E7C7FC13EE5B13F8120F13FFEB9FC0EB83F0EA1F81EB80F81300150C48141E151C12
3EA2007E143C1538127C157800FCEB787015E048EB3FC00070EB0F8020357BB323>107
D<133FEA07FF5A13FEEA007EA3137CA213FCA213F8A21201A213F0A21203A213E0A21207
A213C0A2120FA21380A2121FA21300A25AA2123EA2127EA2127C1318EAFC1C133CEAF838
A21378137012F013F0EAF8E01279EA3FC0EA0F00103579B314>I<2703C003F8137F3C0F
F00FFE01FFC03C1E783C1F07C1E03C1C7CF00F8F01F03B3C3DE0079E0026383FC001FC7F
D97F805B007001005B5E137ED8F0FC90380FC00100E05FD860F8148012000001021F1303
60491400A200034A13076049013E130FF081800007027EEC83C0051F138049017C1403A2
000F02FC1407053E130049495CEF1E0E001F01015D183C010049EB0FF0000E6D48EB03E0
3A227AA03F>I<3903C007F0390FF01FFC391E787C1E391C7CF01F393C3DE00F26383FC0
1380EB7F8000781300EA707EA2D8F0FC131F00E01500EA60F8120000015C153E5BA20003
147E157C4913FCEDF8180007153C0201133801C013F0A2000F1578EDE070018014F016E0
001FECE1C015E390C7EAFF00000E143E26227AA02B>I<14FCEB07FF90381F07C090383E
03E09038FC01F0EA01F83903F000F8485A5B120F484813FCA248C7FCA214014814F8127E
A2140300FE14F05AA2EC07E0A2007CEB0FC01580141FEC3F006C137E5C381F01F0380F83
E03803FF80D800FCC7FC1E2278A027>I<011E137C90387F81FF9039F3C387C09039E3EF
03E03901E1FE01D9C1FC13F0EBC3F8000313F0018314F814E0EA07871307000313C01200
010F130316F01480A2011F130716E01400A249EB0FC0A2013EEB1F80A2017EEB3F00017F
133E5D5D9038FF81F09038FDC3E09038F8FF80027EC7FC000190C8FCA25BA21203A25BA2
1207A25BB5FCA325307FA027>I<903803F01890380FF83890383E1C7890387C0EF89038
F807F0EA01F0EA03E000071303D80FC013E0A2EA1F801407D83F0013C0A348130F007E14
80A300FE131F481400A35C143E147E127C14FE495AEA3C03EA3E07EA1F0E3807FCF8EA01
F0C7FC13015CA313035CA21307A25C48B5FCA25C1D3078A023>I<3903C00FC0390FF03F
F0391E78F078391C7DE03C393C3FC0FC00381380EB7F00007814F8D8707E13701500EAF0
FC12E0EA60F812001201A25BA21203A25BA21207A25BA2120FA25BA2121FA290C8FC120E
1E227AA020>I<EB03F0EB1FFCEB3C1EEB780FEBF007EA01E0140F0003131F13C0A2EBE0
0414007FEBFF8014E06C13F06C13F8EB7FFC1307EB00FE147E143E123800FC133CA3147C
00F013784813F0EAF001387803E0383C0F80381FFE00EA03F818227AA01F>I<1303EB0F
80A3131FA21400A25BA2133EA2137EA2137C387FFFF8A2B5FC3800F800A21201A25BA212
03A25BA21207A25BA2120FA25B1460001F13F014E01300130114C01303001E1380EB0700
5BEA0F1EEA07F8EA01E015307AAE19>I<EA01F0D803FC1307D80F1E5B000E5C121C123C
00385CD8783E133E1270A2017E137ED8F07C137CEA60FCC65A15FC00015C5BA214010003
5C13E0166002031370EDE0F0D807C014E0A20003EB07E116C09038E00FC1EC1FC3000190
383FE3809038F071E73A007FE0FF0090381F803C24227AA029>I<01F01338D803FC13FC
EA0F1E120E121C123C0038147CEA783E0070143CA2137ED8F07C1338EA60FCC65A157800
0114705BA215F0000314E05BA2EC01C0A2EBC003158014071500EBE00EA26C6C5A3800F8
78EB7FE0EB1F801E227AA023>I<D801F01538D803FC010E13FCD80F1E131E000E143E12
1C123C0038027E137CD8783E137C0070163CA2017E13FCD8F07C491338EA60FCC65A0201
147800014A137013F0A2020314F0000316E001E05BA2160117C001C013C00207EB0380A2
9039E00FE0071700021F130E3A01F03DF01E3A00F878F83C90393FF03FF090390FC00FC0
2E227AA033>I<011F137C90387FC1FF3A01E1E787803A03C0F703C0903880FE0FEA0700
4813FC000E1580001E9038F80700001C91C7FC1301003C5B1218120013035CA31307A25C
1506010F130F150E14800038141ED87C1F131C00FC143C1538013F5B39F07FC0E03970F3
C3C0393FE1FF80260F807EC7FC22227CA023>I<13F0D803FC1307D80F1E130F000E141F
121C123C0038143FD8783E133E1270A2017E137ED8F07C137CEA60FCC65A15FC000114F8
5BA21401000314F013E0A2140315E0EA07C0A20003130715C0EBE00F141F0001133F9038
F07F8038007FEFEB1F8FEB001F1500A25C003E133E007E137E147C5C007C5BEA7001495A
38380780D83C1FC7FCEA0FFCEA07F020317AA025>I<903807801C90381FE03C90383FF0
38017F13789038FFF8F03901F07CE0EBE01F3903C003C09038800780EC0F00C7121E141C
143C5C5C495AEB07C0495A011EC7FC5B5B4913704913F0000114E0485A38078001390FC0
03C0381FF80790383E0F80393C1FFF00127838700FFE38F007F838E001E01E227CA01F>
I E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Ff cmr9 9 89
/Ff 89 128 df<91393FE00FE0903A01FFF83FF8903A07E01EF83C903A1F800FF07E903A
3F001FE0FE017E133F4914C0485A1738484890381F8000ACB812C0A33B03F0001F8000B3
A7486C497EB50083B5FCA32F357FB42D>11 D<EC1FE0ECFFFC903803F01E90390FC00780
EB1F8090393F000FC0017E131F5BA2485AED0F8092C7FCA9ED0FC0B7FCA33901F8001F15
0FB3A6486CEB1FE0267FFFC1B5FCA328357FB42B>I<EC1FF891B512C0903803F00F9038
0FC01FEB1F80EB3F00137E5B150F485AACB7FCA33901F8000FB3A7486CEB1FE0267FFFE3
B5FCA328357FB42B>I<DA1FE013FF9126FFFC0713E0903B03F01E1F80F0903B0FC0077E
003CD91F805B90273F001FF8137E017E4A13FE495CA248485C030F147C95C7FCA9187EB9
12FEA33B01F8000FC000187EB3A6486C496C13FF297FFFC1FFFE0F13F8A33D357FB440>
I<123C127E12FFA8127EAB123E123CAB1218A61200A7123C127E12FFA4127E123C08367A
B515>33 D<003C13F0387E01F838FF03FCA2EB83FEA2EA7F81383D80F600011306A40003
130EEB000CA248131C00061318000E1338000C1330001C13704813E0387001C000601380
17177EB326>I<1307A3EB1FE0EBFFFC00037F3907E71F80390F8703C0391E0701E0003C
1300157000781430153800F014F814011403A312F8EC01F000FC90C7FCA2127EEA7F87EA
3FE713FF6C13E06C13F86C13FE6C7FC61480013F13C0010713E0143FEC0FF014071403EC
01F81400127C12FE1578A312FC12F800E014F012601270EC01E00038EB03C0001C130700
1FEB0F80390FC73F003803FFFCC613F0EB3FC00107C7FCA31D3C7CB726>36
D<123C127EB4FCA21380A2127F123D1201A412031300A25A1206120E120C121C5A5A1260
09177AB315>39 D<14C01301EB0380EB0F00130E5B133C5B5BA2485A485AA212075B120F
90C7FC5AA2121E123EA3123C127CA55AB0127CA5123C123EA3121E121FA27E7F12077F12
03A26C7E6C7EA213787F131C7F130FEB0380EB01C01300124A79B71E>I<12C07E127012
3C121C7E120F6C7E6C7EA26C7E6C7EA27F1378137C133C133EA2131E131FA37F1480A5EB
07C0B0EB0F80A514005BA3131E133EA2133C137C137813F85BA2485A485AA2485A48C7FC
120E5A123C12705A5A124A7CB71E>I<156015F0B3A4007FB812C0B912E0A26C17C0C800
F0C8FCB3A4156033327CAB3C>43 D<123C127EB4FCA21380A2127F123D1201A412031300
A25A1206120E120C121C5A5A126009177A8715>I<B512F0A514057F921A>I<123C127E12
FFA4127E123C08087A8715>I<1530157815F8A215F01401A215E01403A215C01407A215
80140FA215005CA2143EA2143C147CA2147814F8A25C1301A25C1303A25C1307A2495AA2
91C7FC5BA2131E133EA2133C137CA2137813F8A25B1201A25B1203A2485AA25B120FA290
C8FC5AA2121E123EA2123C127CA2127812F8A25A12601D4B7CB726>I<EB0FE0EB7FFCEB
F83E3903E00F803907C007C0EB8003000F14E0391F0001F0A24814F8A2003E1300007E14
FCA500FE14FEB2007E14FCA56CEB01F8A36C14F0A2390F8003E03907C007C0A23903E00F
803900F83E00EB7FFCEB0FE01F347DB126>I<13075B5B137FEA07FFB5FC13BFEAF83F12
00B3B3A2497E007FB51280A319327AB126>I<EB3FC0EBFFF0000313FC380F80FF391E00
7F80001CEB3FC048EB1FE048130F15F00060130712FC6C14F87E1403A3007E1307123CC7
FC15F0A2140F15E0EC1FC0A2EC3F801500147E5C495A5C495A495A495A49C7FC133E133C
4913185B485A48481330485A48C7FC001C1470001FB512F05A5AB612E0A31D327CB126>
I<EB1FE0EBFFFC4813FF3907E03F80390F001FC0001EEB0FE0001CEB07F0123F018013F8
140313C01380A2381F0007C7FC15F0A2EC0FE015C0141FEC3F80EC7E00EB01F8EB7FE014
FCEB003FEC1FC0EC0FE0EC07F015F8140315FC140115FEA3127EB4FCA415FC4813031278
0070EB07F86C14F0003C130F001FEB1FE0390FE03F800003B51200C613FCEB1FE01F347D
B126>I<EC01C0A214031407A2140F141FA2143F147F146F14CF1301EB038F140F130713
0E130C131C13381330137013E013C0EA0180120313001206120E120C5A123812305A12E0
B71280A3C7380FC000A94A7E0107B51280A321337EB226>I<000C14C0380FC00F90B512
8015005C5C14F014C0D80C18C7FC90C8FCA9EB0FC0EB7FF8EBF07C380FC03F9038001F80
EC0FC0120E000CEB07E0A2C713F01403A215F8A41218127E12FEA315F0140712F8006014
E01270EC0FC06C131F003C14806CEB7F00380F80FE3807FFF8000113E038003F801D347C
B126>I<14FE903807FF80011F13E090383F00F0017C13703901F801F8EBF003EA03E012
07EA0FC0EC01F04848C7FCA248C8FCA35A127EEB07F0EB1FFC38FE381F9038700F809038
E007C039FFC003E0018013F0EC01F8130015FC1400A24814FEA5127EA4127F6C14FCA26C
1301018013F8000F14F0EBC0030007EB07E03903E00FC03901F81F806CB51200EB3FFCEB
0FE01F347DB126>I<1230123C003FB6FCA34814FEA215FC0070C7123800601430157015
E04814C01401EC0380C7EA07001406140E5C141814385CA25CA2495A1303A3495AA2130F
A3131F91C7FCA25BA55BA9131C20347CB126>I<EB0FE0EB7FFC90B5FC3903F01F803907
C007C0390F0003E0000EEB01F0001E1300001C14F8003C1478A3123EA2003F14F86D13F0
EBC001D81FF013E09038F803C0390FFE07803907FF0F006C13DE6C13F87EEB3FFE8001F7
13C0D803E313E0D8078013F0390F007FF8001E131F003EEB07FC003C1303481301EC007E
12F848143EA2151EA37E153C1278007C14787E6C14F0390F8003E03907F01FC00001B512
0038007FFCEB1FE01F347DB126>I<EB0FE0EB7FF8EBFFFE3803F83F3907E00F80390FC0
07C0D81F8013E0EC03F0EA3F0048EB01F8127EA200FE14FC1400A415FEA5007E1301A212
7F7E1403EA1F80000F13073807C00E3803E01C3801F03838007FF090381FC0FC90C7FC14
01A215F8A215F01403001F14E0383F800715C0140FEC1F809038003F00001C137E381F01
FC380FFFF0000313C0C690C7FC1F347DB126>I<123C127E12FFA4127E123C1200B0123C
127E12FFA4127E123C08207A9F15>I<123C127E12FFA4127E123C1200B0123C127E12FE
12FFA3127F123F1203A412071206A3120E120C121C1238123012701260082F7A9F15>I<
007FB812C0B912E0A26C17C0CCFCAC007FB812C0B912E0A26C17C033147C9C3C>61
D<EBFFC0000313F8380F00FE001C133F48EB1F804814C0140F00FC14E07EA4127CC7EA1F
C0A2EC3F80EC7F0014FE14F8495A495A5C495AA249C7FC130EA2130C131CA21318A890C8
FCA7133C137E13FFA4137E133C1B357CB424>63 D<EC07FC91387FFFC0903901F803F090
390780003C011EC7120F0138EC0380496E7E496E7E4848157048488127070003F87F000E
D91FFE7F000C90397E078006001C9039F801C0073B1801F000E003D83803027013802630
07E0EB3F014A1481D8700F021F13C026601F801480A200E017E0D8C03F166091C7FCA880
EAE01F1260A226700FC015E0D83007023F13C080263803F0137FD81801ECFF813C1C00F8
01CFC180000C90397E0787C3000E903A1FFE03FF006C903903F800FC6C6CCAFC6C7E6C7E
0170ED03E06D150F011EED7F80D90780903803FC00D901F8EB7FE09027007FFFFEC7FC02
07138033367CB43C>I<15E0A34A7EA24A7EA34A7EA3EC0DFE140CA2EC187FA34A6C7EA2
02707FEC601FA202E07FECC00FA2D901807F1507A249486C7EA301066D7EA2010E80010F
B5FCA249800118C77EA24981163FA2496E7EA3496E7EA20001821607487ED81FF04A7ED8
FFFE49B512E0A333367DB53A>I<B7FC16E016F83A03FC0003FE0001EC00FFEE7F80EE3F
C0161F17E0160F17F0A617E0161F17C0EE3F80EE7F0016FEED03FC90B612F05E9039FC00
07FCED00FEEE3F80EE1FC0EE0FE017F0160717F8160317FCA617F81607A2EE0FF0EE1FE0
163FEE7FC00003913803FF00B75A16F816C02E337DB236>I<DA03FE130C91393FFF801C
91B512E0903A03FE01F83C903A0FF0003C7CD91FC0EB0EFCD97F80130701FEC712034848
1401000315005B4848157C485A173C485A171C123F5B007F160CA390C9FC481600AB7E6D
150CA3123F7F001F161C17186C7E17386C6C15306C6C15706D15E012016C6CEC01C0D97F
80EB0380D91FC0EB0F00D90FF0131ED903FE13FC0100B512F0023F13C0DA03FEC7FC2E37
7CB437>I<B77E16F016FE3A01FE0001FF00009138003FC0EE0FE0707E707E707E707E17
7E177FEF3F80A2EF1FC0A3EF0FE0A418F0AA18E0A3171F18C0A21880173F18005F17FE5F
4C5AEE07F04C5AEE3FC000014AB45AB748C7FC16F8168034337EB23B>I<B812C0A3D803
FCC7127F0001150FEE03E01601A21600A21760A403061330A41700150EA2151E157E90B5
12FEA39038FC007E151E150EA21506170CA3171892C7FCA41738A21770A217F016011603
16070003157FB812E0A32E337DB234>I<B81280A3D803FCC7FC0001151FEE07C01603A2
1601A21600A41760150CA31700A2151CA2153C15FC90B5FCA3EBFC00153C151CA2150CA5
92C8FCAB487EB512FEA32B337DB232>I<DA03FE130C91393FFF801C91B512E0903A03FE
01F83C903A0FF0003C7CD91FC0EB0EFCD97F80130701FEC7120348481401000315005B48
48157C485A173C485A171C123F5B007F160CA390C9FC4893C7FCAA0303B512E07E7F9239
0003FE00705A123F7F121FA26C7E7F12076C7E7F6C6C14036C7E6D6C1307D91FC0EB0E7C
D90FF0EB1C3CD903FEEBF81C0100B5EAF00C023F01C0C7FCDA03FEC8FC33377CB43C>I<
B5D8FE03B512F8A3000190C73807FC006C486E5AB390B7FCA349C71203B3A3486C4A7EB5
D8FE03B512F8A335337EB23A>I<B512FEA3000113006C5AB3B3A7487EB512FEA317337E
B21C>I<017FB5FCA39038003FE0EC1FC0B3B1127EB4FCA4EC3F805A0060140000705B6C
13FE6C485A380F03F03803FFC0C690C7FC20357DB227>I<B500FE903807FFF8A3000190
C7000113006C48EC00FC17F04C5A4C5A4CC7FC160E5E5E5E5E4B5A4B5A4BC8FC150E5D5D
15F84A7E14034A7EEC0EFF5C4A6C7E4A6C7EECE01FD9FFC07F4A6C7E4A6C7E5B6F7E6F7E
A26F7E707EA2707E707E160F83707E707EA283486C913807FF80B500FE013F13FCA33633
7EB23C>I<B512FEA3D803FEC9FC6C5AB3A9EE0180A416031700A45EA25E5E5E5E16FE00
031407B7FCA329337DB230>I<D8FFFC923801FFF86D5DA20003EFFE00D801BFED06FCA3
D99F80140CA2D98FC01418A3D987E01430A2D983F01460A3D981F814C0A3D980FCEB0180
A2027EEB0300A36E1306A26E6C5AA36E6C5AA36E6C5AA26E6C5AA36E6C5AA3913800FD80
A2037FC7FCA3486C133ED80FF04B7EB5011C90387FFFF8A33D337CB246>I<D8FFFE9138
1FFFF87F80C6030013006E143CD9DFE01418EBCFF0A2EBC7F8EBC3FCA2EBC1FEEBC0FF6E
7EA26E7E6E7EA26E7E6E7E6E7EA26E7E6E7EA2ED7F80ED3FC0ED1FE0A2ED0FF0ED07F8A2
ED03FCED01FEED00FFA2EE7F98EE3FD8A2EE1FF8160F1607A216031601A2486C1400D807
F81578B500C01438A2171835337EB23A>I<EC07FC91387FFFC0903901FC07F0903907E0
00FCD90F80133E013FC76C7E017E6E7E496E7E48486E7E48486E7EA248486E7E000F8249
157E001F167FA24848ED3F80A2007F17C0A290C9121FA24817E0AB6C17C06D153FA3003F
17806D157FA2001F17006D5D000F5E6C6C4A5AA26C6C4A5A00015E6C6C4A5A017E4A5A6D
4A5AD91FC0017FC7FCD907E013FC903901FC07F09039007FFFC0DA07FCC8FC33377CB43C
>I<B612FEEDFFC016F03A03FC0007FC0001EC00FE167FEE3F80EE1FC017E0160FA217F0
A617E0A2EE1FC0A2EE3F80EE7F0016FEED07F890B65A168001FCC9FCB3A2487EB512F8A3
2C337DB234>I<EC07FC91387FFFC0903901FC07F0903907E000FC4948137E013FC7EA1F
80017E6E7E496E7E48486E7E00038249140148486E7E000F8249157E001F167FA24848ED
3F80A2007F17C0A390C9121F4817E0AB6C17C0A26D153FA2003F1780A26D157F001F1700
A2270FE001F013FE0007D907FC5B9039F00E0E013B03F80C0703F8000190391C0383F03B
00FC180187E0017EECCFC0013FECDF8090271F9C00FFC7FCD907EC13FC902701FE07F013
609038007FFF913807FC7091C7007813E0A2EE7C01EE7E0393387F07C0EE3FFFA2188082
1800705A705AEE01F033447CB43C>I<B612FCEDFF8016F03A01FE0007FC0000EC01FEED
007F707E707E83160F83A65FA24C5AA24C5A047EC7FC4B5AED0FF090B612C093C8FC9039
FE001FC0ED07F06F7E6F7E150082167E167FA583A5180C17C0A2043F131C486C1618B500
FEEB1FE0040F1338933807F070C93801FFE09338003F8036357EB239>I<90381FE00390
387FFC0748B5FC3907F01FCF390F8003FF48C7FC003E80814880A200788000F880A46C80
A27E92C7FC127F13C0EA3FF013FF6C13F06C13FF6C14C06C14F0C680013F7F01037F9038
003FFF140302001380157F153FED1FC0150F12C0A21507A37EA26CEC0F80A26C15006C5C
6C143E6C147E01C05B39F1FC03F800E0B512E0011F138026C003FEC7FC22377CB42B>I<
007FB712FEA390398007F001D87C00EC003E0078161E0070160EA20060160600E01607A3
481603A6C71500B3AB4A7E011FB512FCA330337DB237>I<B500FE90381FFFF8A3000190
C813006C48153C1718B3AF1738017F1530A217706D6C1460011F15E06E495A010F14036D
6C495A6D6C49C7FCD901FC131E6DB413FC91383FFFF0020F13C0020190C8FC35357EB23A
>I<B500F0903803FFF8A3D807FEC8EA7FC06C48ED1F000001161E6D151C00001618A26D
15386D1530A26D6C5CA26E14E0011F5DA26D6C495AA28001074AC7FCA26D6C1306A28001
015CA26E131C01001418806E5BA2ED8070023F1360A26E6C5AA215E1020F5BA2DA07F3C8
FCA215FBEC03FEA36E5AA26E5AA31570A235357EB23A>I<B5D8F007B539800FFFF0A300
0390C7273FF000011300D801FC6E48EB007C1A386D140F00001930836D020715706D1860
A26E496C14E0013F60A26ED919FC1301011F60A26ED930FE1303010F95C7FCA26ED9607F
5B01071706A26E9039C03F800E0103170CA2913BFC01801FC01C01011718A2913BFE0300
0FE03801001730A2DAFF06EB07F0027F5EA2038CEB03F8023F5EA203D8EB01FC021FEDFD
80A203F0EB00FF020F93C8FCA24B800207157EA24B143E0203153CA24B141C020115184C
357FB24F>I<B500F8ECFFFEA300030180EC3FE06C90C8EA1F806CEE0E006D6C5C6D6C14
1817386D6C14305F6D6C14E06D6C5C16016D6C5C6D6C49C7FC5E6D6C13065E91387F801C
91383FC018163891381FE0306E6C5A16E06E6C5AEDF980EC03FF6E90C8FC5D1400B14A7E
91B512FCA337337FB23A>89 D<003FB612FCA39039F80007F813C090C7EA0FF0003EEC1F
E0123C0038EC3FC00078EC7F801270EDFF004A5AA20060495AA24A5A4A5AC7FC4A5A4A5A
A24A5A4AC7FCA2495A495AA2495A495AA24948130C495AA2495A49C7FCA24848141CA248
5A485A1638485A4848147816F84848130148481307153FB7FCA326337CB22F>I<EAFFF0
A4EAF000B3B3B3ADEAFFF0A40C4B79B715>I<0003130C48131C000E1338481370001813
60003813E0003013C0EA700100601380A2EAE00300C01300A400DE137800FF13FCEB83FE
A2EA7F81A2383F00FC001E1378171774B326>I<EAFFF0A41200B3B3B3AD12FFA40C4B7F
B715>I<1320137013F8487EEA03DEEA078F380F0780381E03C0383C01E0387800F000E0
133800401310150C78B326>I<12035A120E5A12181238123012701260A212E05AA412DE
B4FC1380A2127FA2EA3F00121E09177BB315>96 D<EB7F803803FFF0380F80FC381C003E
003F133F6D6C7E6E7EA26E7EEA1F00C7FCA4EB01FF131FEBFF873803FC07EA0FF0EA1FC0
EA3F80127F13004815C05AA3140FA26C131F6C133B3A3F8071F180391FC1E1FF2607FFC0
13003900FE003C22237DA126>I<EA03F012FFA312071203AEEC3F80ECFFE09038F3C0F8
9038F7007E01FE7F49EB1F8049EB0FC05BED07E016F0A2150316F8AA16F0150716E0A2ED
0FC07F6DEB1F8001ECEB3F0001CF137C90388381F8903801FFE0C76CC7FC25357EB32B>
I<EB07F8EB3FFF9038FC07C03901F000E03903E003F03807C007120FEA1F80123F903800
03E04890C7FCA2127E12FEAA127FA26C14187F001F14386D1330000F14706C6C13E03903
F001C03900FC0F8090383FFE00EB07F01D237EA122>I<153FEC0FFFA3EC007F81AEEB07
F0EB3FFCEBFC0F3901F003BF3907E001FF48487E48487F8148C7FCA25A127E12FEAA127E
127FA27E6C6C5BA26C6C5B6C6C4813803A03F007BFFC3900F81E3FEB3FFCD90FE0130026
357DB32B>I<EB0FE0EB7FFCEBF83F3903F00F80D807E013C0390FC007E0381F800315F0
EA3F0014014814F8127EA212FEA2B6FCA248C8FCA5127E127FA26C1418A26C6C1338000F
14306D13706C6C13E03901F003C03900FC0F00EB3FFEEB07F01D237EA122>I<EB01FCEB
07FF90381F078090383E0FC0EB7C1F13FCEA01F8A20003EB070049C7FCACB512F0A3D803
F0C7FCB3A7487E387FFFE0A31A357FB417>I<151F90391FC07F809039FFF8E3C03901F0
7FC73907E03F033A0FC01F83809039800F8000001F80EB00074880A66C5CEB800F000F5C
EBC01F6C6C48C7FCEBF07C380EFFF8380C1FC0001CC9FCA3121EA2121F380FFFFEECFFC0
6C14F06C14FC4880381F0001003EEB007F4880ED1F8048140FA56C141F007C15006C143E
6C5C390FC001F83903F007E0C6B51280D91FFCC7FC22337EA126>I<EA03F012FFA31207
1203AEEC1FC0EC7FF09038F1E0FC9038F3807C9038F7007E13FE497FA25BA25BB3486CEB
7F80B538C7FFFCA326347EB32B>I<EA0780EA0FC0EA1FE0A4EA0FC0EA0780C7FCAAEA07
E012FFA3120F1207B3A6EA0FF0B5FCA310337EB215>I<EB03C0EB07E0EB0FF0A4EB07E0
EB03C090C7FCAAEB03F013FFA313071303B3B01238127C00FE13E0130714C0130F007C13
8038381F00EA1FFCEA07F0144384B217>I<EA03F012FFA312071203AF913803FFE0A36E
1300EC00F8EC01E05D4A5A020FC7FC141C5C5C14F0EBF3F8EBF7FC13FEEBFC7EEBF87F49
6C7E141F6E7E8114076E7E8114016E7E81486CEBFF80B500C313F0A324347EB329>I<EA
07E012FFA3120F1207B3B3A7EA0FF0B5FCA310347EB315>I<2703F01FE013FF00FF9026
7FF80313C0903BF1E07C0F03E0903BF3803E1C01F02807F7003F387FD803FE1470496D48
6C7EA2495CA2495CB3486C496C487EB53BC7FFFE3FFFF0A33C217EA041>I<3903F01FC0
00FFEB7FF09038F1E0FC9038F3807C3907F7007EEA03FE497FA25BA25BB3486CEB7F80B5
38C7FFFCA326217EA02B>I<EB07F0EB3FFE9038FC1F803901F007C03903C001E0000780
48486C7E48C7127CA248147E003E143E007E143FA300FE1580A8007E1500A36C147EA26C
147C6D13FC6C6C485A00075C3903F007E03900FC1F80D93FFEC7FCEB07F021237EA126>
I<3903F03F8000FFEBFFE09038F3C0F89038F7007ED807FE7F6C48EB1F804914C049130F
16E0ED07F0A3ED03F8A9150716F0A216E0150F16C06D131F6DEB3F80160001FF13FC9038
F381F89038F1FFE0D9F07FC7FC91C8FCAA487EB512C0A325307EA02B>I<903807F00390
383FFC07EBFC0F3901F8038F3807E001000F14DF48486CB4FC497F123F90C77E5AA25A5A
A9127FA36C6C5B121F6D5B000F5B3907E003BF3903F0073F3800F81EEB3FF8EB0FE090C7
FCAAED7F8091380FFFFCA326307DA029>I<3803E07C38FFE1FF9038E38F809038E71FC0
EA07EEEA03ECA29038FC0F8049C7FCA35BB2487EB512E0A31A217FA01E>I<EBFF060007
13CE381F00FE003C133E48131E140E5A1406A27EA200FE90C7FC6C7EEA7FFC383FFFC014
F0000F7F6C7FC67FEB0FFF1300EC3F8000C0131F140F6C1307A37E15006C5B6C130E6C5B
38F7807838E1FFE038C07F8019237EA11E>I<1330A51370A313F0A21201A21203120738
1FFFFEB5FCA23803F000AF1403A814073801F806A23800FC0EEB7E1CEB1FF8EB07E0182F
7FAD1E>I<D803F0133F00FFEB0FFFA30007EB007F000380B35DA35D12016D4813800000
903803BFFC90387E073FEB1FFED907F8130026227EA02B>I<B5EBFFF0A3D80FF0EB3F80
0007EC1F000003140E150C6D131C00011418A26C6C5BA26D1370017E1360137F6D5BA290
381F8180A214C3010F90C7FCA2EB07E6A214FE6D5AA26D5AA36D5AA2146024217E9F29>
I<B53A1FFF81FFF0A33C07F801FC003F8001F049EB1E0000030100141C816C6C017C1318
A26D017E1338000002FE1330A290267E01FF5B159F168090263F030F5BA216C0903A1F86
07C180A202C613E390260FCC0390C7FCA2D907FC13F6ECF80116FE6D486C5AA36D481378
A36D48133034217F9F37>I<B53801FFF8A32603FE0013806C48EB7C0000001478017E13
70017F5B90383F81C090381F8380D90FC3C7FCEB07E614FE6D5A6D5A6D7E80805B903803
9F809038071FC09038060FE0EB0C0790381C03F0496C7E01707FEBF000000180000FECFF
8026FFFC0313FCA326207F9F29>I<3A7FFF807FF8A33A07F8001FC00003EC0F800001EC
070015066C6C5BA26D131C017E1318A26D5BA2EC8070011F1360ECC0E0010F5BA2903807
E180A214F3010390C7FC14FBEB01FEA26D5AA31478A21430A25CA214E05CA2495A1278D8
FC03C8FCA21306130EEA701CEA7838EA1FF0EA0FC025307F9F29>I<003FB512F0A2EB00
0F003C14E00038EB1FC00030EB3F800070137F1500006013FE495A13035CC6485A495AA2
495A495A49C7FC153013FE485A12035B48481370485A001F14604913E0485A387F000348
130F90B5FCA21C207E9F22>I<B712F8A22502809426>I<BC12F0A24C0280944D>I<001C
1370387F01FC00FF13FEA4007F13FC381C0070170879B226>127
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fg cmss9 9 10
/Fg 10 120 df<EC0FFC91B512C0010314F0010F14FC5B90383FF80790397FC000F849C7
1278484814184848140848481400485A5B121F5B485AA348C9FCA412FEAA127FA46C7EA3
6C7E7F120F7F6C7E6C6C14026C6C14066C6C141ED97FC0137E90393FF803FE6DB5FC6D14
FC010314F0010014C091380FFE0027367BB431>67 D<EC0FF091B5FC010314C0010F14F0
498090393FF00FFC90397FC003FE49C77E4848EC7F804848EC3FC04848EC1FE049140F48
48EC07F0A24848EC03F8A24848EC01FCA248C912FEA400FE167FAC007F16FEA46C6CEC01
FCEC07F001C0EBF803001FD903FC13F8D9E0011307000FD900FE13F06C6C9038FF0FE06D
EB7F9F6C6C90383FBFC06C6CECFF806C6C6D130090397FC00FFED93FF05B6DB55A6D8001
0380130091381FF8FF91C7EA7F80EE3FC017E0161FEE0FF0EE07F817FC303F7CB539>81
D<EB0FF8EB3FFF90B512E04814F05A3807F807390FE001E0391FC0006049130048C8FCA2
127EA35AA9127EA36C14106D1330001F14F0380FE001EBF80F6CB5FC6C14E0C614809038
7FFE00EB0FF01C247DA222>99 D<EB1FC0EB7FF848487E487F487F390FF07F80381FC01F
90388007C0EA3F00EC03E0007E1301A2127C00FCEB00F0B6FCA500F8C8FCA27EA2127C12
7EA27E6D13106C6C1370390FE001F0EBF80F6CB5FC6C14E0C6148090387FFE00EB0FF01C
247DA222>101 D<12FCB2EB07F0EB3FFE497E90B51280B6FC9038E07FC0EB801F903800
0FE0A2481307A35AB3A41B347AB328>104 D<12FEA71200AC127EB3AF07347BB313>I<12
FCB3EC0FF0EC1FE0EC3FC0EC7F80ECFF00495A495A495A495A495A495A495A49C7FC12FD
B57EA280EBE7E013C7EB83F0EB01F800FE7FEAFC00147E801580141FEC0FC0EC07E0A2EC
03F0EC01F815FC1E347AB326>107 D<EB03F838FC1FFEEB7FFF00FDB51280B612C09038
E07FE0EB801F9038000FF048130748EB03F8A2140115FC1400A8140115F8A2140315F06C
13076CEB0FE0EB801F9038E07FC090B5128000FD140000FC5BEB3FFCEB07E090C8FCAE1E
317AA128>112 D<00FCEB07E0B3A7140F141F6C133F6C13FF6CB5FC14F76C13E76C1307
D807F8C7FC1B227AA028>117 D<00FCD907F0EB1F807E007E010FEC3F008115786C011F
143E177EEC1E7C261F803E147C033C13FC153E000F013C5CD9C07C1301151E151F2607E0
785C02F81303ED0F8300035EEBF0F001F114870001913807C7C014E0A201FBEB03CF0000
5E02C013EF1501017B92C7FCD97F8013FFA2013F6D5A91C7FC31217FA034>119
D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fh cmbx9 9 55
/Fh 55 122 df<EC07FF91B512E001078090391FFC01FC90383FE0009039FFC001FE48EB
80031400484A7E496D5AA36F5AED007093C7FCA4ED3FFFB8FCA43903FE0001B3A7277FFF
F03F13F8A42D347FB331>12 D<B512FCA816087F931D>45 D<1507ED0F80A2151F1600A2
5D153E157E157CA215FC5D14015DA214035D14075DA2140F5D141F92C7FCA25C143E147E
147CA214FC5C13015CA213035C13075CA2130F5C131F91C8FCA25B133E137E137CA213FC
5B12015BA212035B12075BA2120F5B121F90C9FCA25A123E127E127CA212FC5AA2127021
4B7BB72C>47 D<EB03FE90383FFFE090B512F848EB07FC3903FC01FE48486C7E4848EB7F
8049133F001F15C0A2003F15E049131F007F15F0A500FF15F8B1007F15F0A4003F15E06D
133FA2001F15C0A26C6CEB7F806C6CEBFF006C6C485A3901FF07FC6CEBFFF8013F13E0D9
03FEC7FC25327DB02C>I<147814F81303131FEA03FFB5FCA3EAFC1F1200B3B2007FB512
FEA41F317AB02C>I<EB1FFC90B57E000314E0000F14F8391FE03FFC393F800FFF48487E
6D6C1380D8FFC014C06D7E16E080A36C5A6C5A6CC7FCC8FC16C05C16805C16004A5A4A5A
5D4A5AEC3FC04A5A02FEC7FC495A495A903907E001E0EB0FC0EB1F8090383E00034914C0
5B4848130748B6FC5A5A5A5A5AB71280A423317CB02C>I<EB0FFC90387FFF8048B512F0
3903F01FF83907C00FFE380F8007486C6C7E01F01480123F13F8A5D81FF014006C485AD8
03805BC7FC4A5A4A5A4A5AECFFC0013F90C7FC14FCECFFC09038001FF0EC0FFC6E7E6E7E
16806E13C0A2000F15E0EA3FC0EA7FE0EAFFF0A416C0A2495AD87FC0148049481300003F
5B391FF01FFE6CB512F8000314E0C61480D91FFCC7FC23327CB02C>I<151F5D5DA25D5C
5C5C5CA25C143D147D14F9EB01F114E1EB03C1EB0781130FEB1F01133E133C137813F012
01EA03E0EA07C01380EA0F00121E123E5A5AB712FEA4C700031300A80103B512FEA42731
7EB02C>I<000C140ED80FE013FE90B5FC5D5D5D5D5D92C7FC14FC14F091C8FC1380A6EB
87FE9038BFFFC090B512F09038FC0FF89038E003FE01C07F497E01001480000E6D13C0C8
FCA216E0A3121FEA7F807F487EA316C05B5CD87F801480D87C0014006C5B393F8007FE39
1FE01FFC0007B512F06C14C0C691C7FCEB1FF823327CB02C>I<EC7FC0903803FFF0010F
13FC90383FE07E90387F801F4848485A4848EBFF8048485A13F8120FEA1FF0A2123F6E13
004848133C92C7FCA2142039FFE1FF8001E713E001EF13F89038FE03FC496C7E01F87F6E
13805B16C0A24914E0A5127FA5123F16C0121F6D1480000F5B01F814006C6C485A6C6C48
5A6CB55A6C6C5B011F13C0D907FEC7FC23327CB02C>I<123C123F90B612F8A44815F016
E016C0168016005D007CC7127E00785C4A5A00F8495A48495A4A5A4A5AC7FC4AC7FC147E
14FE5C13015C1303A2495AA2130FA2131FA25C133FA4137FA96D5AA2010FC8FC25337BB1
2C>I<EB07FE90383FFFC090B512F03903F807FC3907C000FE4848137F8148C71380151F
5A7FA27F7F01F8133F01FE14006D6C5A6CEBE0FEECF1FC6CEBFFF815E06C5C6C14F06C80
6C6C7F48B57E4880D80FF31480D81FE014C0383FC03FEB800F48486C13E0140148EB007F
48143F151FA2150FA216C07E6C141F6D14806C6C133F6DEB7F00391FF803FE0007B512F8
6C5CC66C13C0D90FFCC7FC23327CB02C>I<EB07FC90383FFF8090B512E03903FE0FF039
07F807F848486C7E001F6D7E003F80497E007F1580A212FF16C0A416E0A55C127FA2123F
5CEA1FF0000F5B6C6C5A3803FFFEC65BD93FF013C0EB00805CA2EA0780261FE0011380EA
3FF01600A24A5AA24A5A49485A391F801FF09038C07FE06CB512806C91C7FC000113FC38
003FC023327CB02C>I<120FEA3FC0EA7FE0EAFFF0A6EA7FE0EA3FC0EA0F00C7FCA9120F
EA3FC0EA7FE0EAFFF0A6EA7FE0EA3FC0EA0F000C217AA019>I<ED1F80A24B7EA24B7EA3
4B7EA24A7FA34A7FA24A7F15CFA2020F7F1587021F801503023F80EC3E01A2027E80EC7C
0002FC804A137FA20101814A133F0103814A131FA249B67EA24981A290271F8000077F91
C77EA24982013E80017E82017C80A201FC8249157FB500F0013FB512F0A43C347DB343>
65 D<B712FEEEFFC017F817FEC69039C0001FFF04071380040113C0A27013E0A2EF7FF0
A6EFFFE0A24C13C0A24C138093380FFE00EE3FFC91B612F017C017F89139C00007FE9338
03FF80040013C018E0EF7FF018F8173FA218FCA618F8A2177FEFFFF04C13E05E040F13C0
B912005F17F0178036337DB23F>I<DBFFE01338021F01FE137891B6EA80F8010315E101
0F9038E00FF7903A1FFE0001FFD97FF8EB007FD9FFE0143F4849141F4849140F4890C812
07485A1703485A1701123F5B007F1600A349160012FFAB127F7F1878A2123F7F001F17F8
18F06C7E6D15016CEE03E06C7F6C6DEC07C06C6DEC0F80D97FF8EC3F00D91FFE14FE903A
0FFFE007FC010390B512F0010015C0021F49C7FC020013F035357BB340>I<B712FCEEFF
C017F817FEC69039E0003FFF040313C004007F717EEF1FF8717E841707848319808319C0
A419E0AB19C0A419805FA219004D5A170F604D5A4D5AEFFFE004035B041F5BB848C7FC17
F817C004FCC8FC3B337DB244>I<B812FEA4C69038E0000FEE01FF82838383A283A3DB01
E013801707A4030390C7FCA21507151F91B5FCA4ECE01F1507150318F01501A2EF01E0A3
92C7FCA21703A2EF07C0A2170F171F173F17FF1607B91280A434337DB23A>I<B812FCA4
C69038E0001FEE03FE16011600177E173EA2171EA3923803C01F170FA403071300A2150F
153F91B5FCA4ECE03F150F1507A21503A592C8FCABB612F8A430337DB238>I<912601FF
E01370021F01FC13F091B61201010315C3010F9038C00FFF90393FFE0003D97FF81300D9
FFE0147F4849143F4849141F4890C8120F485A1707485A1703485AA2007F1601A25B94C8
FC12FFA90303B612C0A2127F7F92C7387FF000A2123FA26C7EA26C7EA26C7E6C7F6C7F6C
6D14FFEB7FF8D93FFE130390390FFFE00F010390B512E301001580021F9038FE00300201
01F090C7FC3A357BB345>I<B612E0A4C6EBE000B3B3A7B612E0A41B337DB221>73
D<B612F8A4C601E0C8FCB3A81778A417F817F0A31601A21603A21607160F161F167F9238
03FFE0B8FCA42D337DB235>76 D<B500E093387FFFF86E93B5FCA26E5DC6F1F800D9F7FC
ED03DFA3D9F3FEED079FA2D9F1FFED0F1FA201F06D141EA26E6C143CA26E6C1478A26E6C
14F0A36E6CEB01E0A26E6CEB03C0A26E6CEB0780A26E6CEB0F00A26EEB801EA26F6C5AA3
6F6C5AA26F6C5AA292380FF9E0A26FB45AA26F5BA26F90C7FCA3B526F000FE011FB512F8
A2167C16384D337DB254>I<913803FF80027F13FC49B6FC0107010113C0903A1FF8003F
F0D93FE0EB0FF8D9FFC0EB07FE48496D7E4890C76C13804980000717C04848ED7FE0A248
48ED3FF0A2003F17F8A2007F17FC49151FA300FF17FEAB007F17FCA26D153FA2003F17F8
A36C6CED7FF0A26C6CEDFFE0000717C06D5C6C17806C6D4913006C6D495AD97FF0EB1FFC
D91FF8EB3FF0903A07FF01FFC0010190B5C7FC6D6C13FC020713C037357BB342>79
D<B712F8EEFF8017E017F8C69039E0007FFCEE0FFE707E701380A27013C0A218E0A718C0
A24C1380A24C13004C5AEE7FFC91B612F017C04CC7FC02E0C9FCB3B612E0A433337DB23C
>I<913803FF80027F13FC49B6FC0107010113C0903A1FF8003FF0D93FE0EB0FF8D9FFC0
EB07FE48496D7E4890C76C1380A248486E13C04848ED7FE0A2001F17F049153F003F17F8
A2007F17FC49151FA300FF17FEAB007F17FCA36D153F003F17F8A36C6CED7FF015FE000F
496C14E06C6C48903880FFC091380783C02803FF0F01E113806C90268E00F313006C01CE
EB7FFED97FEE5CD91FFF14F00107903881FFC0010190B5EA00046D6C150E0207148091C7
381FC01EEFE07EEFFFFEA218FC82A37013F818F0827013E07013C0EF3F0037437BB342>
I<B712E016FEEEFFC017F0C6D9E00013FCEE1FFEEE07FF707FA2707FA284A660A24C5B95
C7FC4C5AEE1FFCEEFFF891B612C094C8FC83DAE0037F03007FEE3FF083707EA2707EA583
A4193CA2188082F0C07CB6D8E003147870EBE1F070EBFFE0053F13C0CA000313803E347D
B242>I<D90FFC137090397FFF80F048B512E1000714FB390FF803FF391FE0007F484813
3F49130F007F140790C7FC1503481401A36D1300A27F6D140013F8387FFFC014FCECFFE0
6C14F86C14FE816C1580000315C06C15E06C6C14F0131F010014F8140F9138007FFC153F
151F150F00F01407A21503A27EA216F86C14076C15F07E6DEB0FE001E0131F01FEEB7FC0
00FDB61200D8F87F5BD8F01F13F8D8E00113C026357BB331>I<003FB812F8A4D9F003EB
801FD87F80ED03FC01001501007E1600007C177CA20078173CA400F8173E48171EA4C716
00B3A9011FB612F0A437327DB13E>I<B600E090B512F8A4C601E0C8EAF800B3B0017F15
016E5DA2013F4B5A6E1407011F5E6D6C140F6D6CEC3F806D6C6C01FFC7FC6D9038F007FE
6D6CB512F8021F5C020714C09126007FFCC8FC3D347DB244>I<B66CB639800FFFFCA400
019026C0000101C0C7EA1F001B1E6E6F143E6C6F163CA26E6E6C147C017F19786E4A6C14
F8013F61A26E496D1301011F616E497F010F03CF4A5AA26E01076D13076D03875DA29226
800F03EB800F6D96C7FCDBC01F6E5A6DDA1E01141EA2DBE03EECE03E6DDA3C00143CDBF0
7C14F0027F0178017F5BA2DBF8F8ECF8F8023F49013F5BA2DBFDE0EB1FFD021F5F03FF15
FF6E496D5BA36E496D5BA26E90C76C90C8FCA36E486E5AA24B140002005EA20378157856
347EB25B>87 D<EB7FFE0003B512E04814F8390FF00FFC391FF803FF806E138016C0157F
6C5A6C5AEA0180C8FCEC7FFF010FB5FC90B6FC0003EBF07F000F1300EA1FF8485A485A48
5A5BA315FF7F007F5B6D4813E03A3FF80FBFFF000FB5121F0003EBFC0F39007FE0072821
7EA02B>97 D<EA01FC12FFA4120F1207ADEC07FC91387FFF8001FDB512E09039FFF00FF8
9138C007FC91380003FE496D7E496D1380A217C0167FA217E0A917C0A216FF1780A26D49
13006D495A9138C007FC9039F3F01FF801E1B512E0D9C07F13809026800FF8C7FC2B347E
B331>I<903807FF80013F13F090B512FC3903FE01FE4848487EEA0FF8EA1FF0EA3FE0A2
007F6D5A496C5A153000FF91C7FCA9127F7FA2003FEC07807F6C6C130F000FEC1F00D807
FE133E3903FF80FCC6EBFFF8013F13E0010790C7FC21217DA027>I<ED01FC15FFA4150F
1507ADEB07FE90383FFFC790B512F70003EB01FF3907FC003F4848131F4848130F484813
07A2127F5BA212FFA9127FA27F123F150F6C6C131F6C6C133F6C6C497E2603FE03B512E0
C6B512E7013F1387903807FC072B347DB331>I<903803FF80013F13F090B512FC48EB03
FE3907FC007F4848EB3F804848EB1FC05B003FEC0FE0127F5B16F012FF150790B6FCA301
C0C8FCA4127F7F123F16F06C7E000F14016C6CEB03E0D803FEEB0FC03A01FF807F806C6C
B51200011F13FC010313E024217EA029>I<EC3FE0903803FFF8010F13FC90383FF1FE90
387FC3FFEBFF83481303A2EA03FEEC01FEA2EC00781500A7B512FEA4D803FEC7FCB3A738
7FFFF8A420347EB31B>I<16F890390FFC07FE90387FFF9F48B6127F3907FC0FFC380FF0
03001F14FED9E001133E003FECFF1C1600A6001F5CEBF003000F5C3907FC0FF890B512E0
486C1380D90FFCC7FC48C9FCA37F7F90B512F015FE6CECFF8016E06C15F06C15F84815FC
121F393F80001F48C7EA03FE481401481400A46C14016C6CEB03FC6C6CEB07F86C6CEB0F
F0D80FFCEB7FE00003B61280C6ECFE00010F13E028327EA12C>I<EA01FC12FFA4120F12
07ADEC03FF020F13C0023F13F09138FC0FF89039FDE007FCEBFFC04A6C7E1400A25BA25B
B2B539E07FFFF0A42C347DB331>I<EA03F0487E487E487EA66C5A6C5A6C5AC8FCA8EA01
FC12FFA4120F1207B3A5B512C0A412357DB418>I<EA01FC12FFA4120F1207ADED7FFFA4
ED1FC04B5A037EC7FC5DEC03F8EC07E04A5AEC3F804AC8FC4A7E90B5FC8181ECBFF0EC3F
F89038FC1FFCEBF80F6E7E6E7E6E7F82806F7E6F7E6F7EB539C07FFFC0A42A347DB32F>
107 D<EA01FC12FFA4120F1207B3B3A6B512E0A413347DB318>I<2703F803FEEB03FE00
FF903B1FFFC01FFFC0027FD9E07F7F913BF81FF0F81FF0903CF9E00FF9E00FF8260FFBC0
EBFBC06CB4486CB4486C7E02001400495CA3495CB2B500E0B500E0B512E0A443217CA04A
>I<3901F803FF00FF010F13C0023F13F09138FC0FF89039F9E007FC380FFBC06CB4486C
7E1400A25BA25BB2B539E07FFFF0A42C217DA031>I<903803FF80011F13F090B512FE48
EB01FF3A07FC007FC0D80FF0EB1FE0001F15F049130F003F15F8491307007F15FCA300FF
15FEA8007F15FCA26D130F003F15F8001F15F06D131F6C6CEB3FE06C6CEB7FC03A01FF01
FF006CEBFFFE013F13F80103138027217EA02C>I<3901FC07FC00FF90387FFF8001FDB5
12E09039FFF01FF89138C007FC000F90380003FE6C4880496D1380A26F13C0A3EE7FE0A9
EEFFC0A34B1380A26D4913006D495A9138C00FFC9138F03FF801FDB512E0D9FC7F1380DA
0FF8C7FC91C9FCABB512E0A42B307EA031>I<3901F81F8000FFEB7FF0ECFFF89038F9E3
FC9038FBC7FE380FFF876C1307A213FEEC03FCEC01F8EC0060491300B1B512F0A41F217E
A024>114 D<9038FFE1C0000713FF5A383F803F387E000F14075A14037EA26C6CC7FC13
FCEBFFE06C13FC806CEBFF80000F14C06C14E0C6FC010F13F0EB007F140F00F013071403
7EA26C14E06C13076CEB0FC09038C01F8090B5120000F913FC38E03FE01C217DA023>I<
133CA5137CA313FCA21201A212031207001FB51280B6FCA3D807FCC7FCB0EC03C0A79038
FE078012033901FF0F006C13FEEB3FFCEB0FF01A2F7EAE22>I<D801FC14FE00FF147FA4
000F140700071403B21507A2150F151F6C6C497E6C6C01FB13F06CEBFFF3013F13C39038
07FE032C217DA031>I<B539C007FFC0A4D807FEC7EAF80000035D6D13016C5D14806C4A
5AA2ECC007017F5CECE00F013F91C7FC6E5A011F131EECF83E010F133CECFC7C01071378
ECFEF801035B14FF6D5BA26D5BA26E5AA26EC8FCA2141E2A217EA02F>I<B53B83FFFC03
FFE0A43D07FC001FE0003E00183C6D167C00036F1378033F14F86C6C6E5B157F9139807B
FC016C5FDAC0FB1303017FD9F1FE5B14C19139E1E0FF07013F5E9139F3C07F0F011F038F
C7FC14F7903A0FFF803FDEA29238001FFE6D5DA26D486D5AA24A130701015DA26D486D5A
4A13013B217EA040>I<B539C03FFF80A400039039000FC0006C01805B6C4AC7FC90387F
C03E6D6C5A6E5A90381FF9F0EB0FFF6D5B6D5B6D5B7F816E7E4A7E497FEB03EF903807C7
FC90380FC3FE90381F83FFD93F017FD97E007F496D7E496D7E4848131FD8FFFE90387FFF
C0A42A217EA02F>I<B539C007FFC0A4D807FEC7EAF80000035D6D13016C5D14806C4A5A
A2ECC007017F5CECE00F013F91C7FC6E5A011F131EECF83E010F133CECFC7C01071378EC
FEF801035B14FF6D5BA26D5BA26E5AA26EC8FCA2141EA25CA2147C003E1378007F13F848
6C5A1381EB83E0EB87C0495AD87F3FC9FCEA3FFEEA1FF8EA07E02A307EA02F>I
E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fi cmr10 10.95 27
/Fi 27 122 df<121EEA7F8012FF13C0A213E0A3127FEA1E601200A413E013C0A3120113
80120313005A120E5A1218123812300B1C798919>44 D<DB3FF01306912603FFFE130E02
0F9038FF801E913A3FF007E03E9139FF8000F8D903FEC7EA7C7ED907F8EC1EFE4948140F
D93FE0140749481403495A91C812014848150012034848167E5B000F173EA24848161EA2
123F5B180E127FA349160012FFAC127F7F180EA2123FA27F001F171E181C6C7EA2000717
3C6D16386C6C1678000117706C6C16F06EEC01E06D6C15C06D6C1403D90FF0EC07806D6C
EC1F00D903FE143E902600FF8013F891393FF007F0020FB512C0020391C7FC9138003FF0
37427BBF42>67 D<B712FCEEFF8017E000019039C0001FF86C6C48EB03FEEE00FF717E71
7EEF0FE084717E717E170184717EA21980187F19C0A3F03FE0A519F0AB19E0A5F07FC0A2
1980A218FF19004D5AA24D5A6017074D5A4D5AEF7FC04DC7FCEE03FE48486CEB1FF8B85A
178004FCC8FC3C3E7DBD45>I<B6D8C01FB512F8A3000101E0C7383FFC0026007F80EC0F
F0B3A691B7FCA30280C7120FB3A92601FFE0EC3FFCB6D8C01FB512F8A33D3E7DBD44>72
D<011FB512FCA3D9000713006E5A1401B3B3A6123FEA7F80EAFFC0A44A5A1380D87F005B
007C130700385C003C495A6C495A6C495A2603E07EC7FC3800FFF8EB3FC026407CBD2F>
74 D<B600C090387FFFFCA3000101E0C7000F138026007F80913807FE0018F818E0604D
5A4DC7FC173E5F5F4C5A4C5A4C5A4C5A4CC8FC163E5E5E4B5A4B5AED07804B7E151F4B7E
4B7E15FF913881EFF8913883C7FCEC878791388F03FE91389E01FF14BCDAF8007F4A6D7E
5C4A6D7E4A6D7EA2707E707EA2707E707EA2707F717E84173F717E717EA2717E84841980
2601FFE04A13C0B600C090B6FCA3403E7DBD47>I<D907FC131890391FFF8038017FEBE0
783901FC03F83A03F0007CF8D807C0133F4848130F001F140748C7FC003E1403007E1401
A2007C140012FC1678A46C1538A27EA26C6C14007F7FEA3FF8EBFF806C13F86CEBFF806C
14F06C14FC6C14FF6C15C0013F14E0010714F0EB007F020713F89138007FFC150FED07FE
15031501ED00FFA200E0157FA3163FA27EA3163E7E167E6C157C6C15FC6C15F86D13016D
EB03F06DEB07E0D8F9FCEB0FC03AF07F803F8090391FFFFE00D8E00713F839C0007FC028
427BBF33>83 D<003FB91280A3903AF0007FE001018090393FC0003F48C7ED1FC0007E17
07127C00781703A300701701A548EF00E0A5C81600B3B14B7E4B7E0107B612FEA33B3D7D
BC42>I<B600C090B512F8A3000101E0C70007130026007F80EC01FC715A1870B3B3A401
3F16F06E5DA21701011F5E80010F15036E4A5A010793C7FC6D6C5C6D6C141E6D6C5C027F
14F86E6C485A91390FF00FE00203B51280020049C8FCED1FF03D407DBD44>I<EB0FF8EB
FFFE3903F01F8039078007E0000F6D7E9038E001F8D81FF07F6E7EA3157F6C5AEA0380C8
FCA4EC1FFF0103B5FC90381FF87FEB7F803801FC00EA07F8EA0FE0485A485AA248C7FCEE
038012FEA315FFA3007F5BEC03BF3B3F80071F8700261FC00E13CF3A07F03C0FFE3A01FF
F807FC3A003FC001F0292A7DA82D>97 D<49B4FC010F13E090383F00F8017C131E484813
1F4848137F0007ECFF80485A5B121FA24848EB7F00151C007F91C7FCA290C9FC5AAB6C7E
A3003FEC01C07F001F140316806C6C13076C6C14000003140E6C6C131E6C6C137890383F
01F090380FFFC0D901FEC7FC222A7DA828>99 D<EB01FE90380FFFC090383F03F09038FC
01F848486C7E4848137E48487F000F158049131F001F15C04848130FA2127F16E090C7FC
A25AA290B6FCA290C9FCA67EA27F123F16E06C7E1501000F15C06C6C13036DEB07806C6C
1400C66C131E017E5B90381F80F8903807FFE0010090C7FC232A7EA828>101
D<EC1FC0EC7FF8903801F83C903807E07E90380FC0FFEB1FC1EB3F811401137FEC00FE01
FE137C1500AEB6FCA3C648C7FCB3AE487E007F13FFA320407EBF1C>I<167C903903F801
FF903A1FFF078F8090397E0FDE1F9038F803F83803F001A23B07E000FC0600000F6EC7FC
49137E001F147FA8000F147E6D13FE00075C6C6C485AA23901F803E03903FE0FC026071F
FFC8FCEB03F80006CAFC120EA3120FA27F7F6CB512E015FE6C6E7E6C15E06C810003813A
0FC0001FFC48C7EA01FE003E140048157E825A82A46C5D007C153E007E157E6C5D6C6C49
5A6C6C495AD803F0EB0FC0D800FE017FC7FC90383FFFFC010313C0293D7EA82D>I<EA01
FC12FFA3120712031201B1EC01FE913807FFC091381E07E091387803F09138E001F8D9FD
C07F148001FF6D7E91C7FCA25BA25BB3A6486C497EB5D8F87F13FCA32E3F7DBE33>I<EA
01E0EA07F8A2487EA46C5AA2EA01E0C8FCACEA01FC127FA3120712031201B3AC487EB512
F0A3143E7DBD1A>I<EA01FC12FFA3120712031201B3B3B1487EB512F8A3153F7DBE1A>
108 D<2701F801FE14FF00FF902707FFC00313E0913B1E07E00F03F0913B7803F03C01F8
0007903BE001F87000FC2603F9C06D487F000101805C01FBD900FF147F91C75B13FF4992
C7FCA2495CB3A6486C496CECFF80B5D8F87FD9FC3F13FEA347287DA74C>I<3901F801FE
00FF903807FFC091381E07E091387803F000079038E001F82603F9C07F0001138001FB6D
7E91C7FC13FF5BA25BB3A6486C497EB5D8F87F13FCA32E287DA733>I<14FF010713E090
381F81F890387E007E01F8131F4848EB0F804848EB07C04848EB03E0000F15F04848EB01
F8A2003F15FCA248C812FEA44815FFA96C15FEA36C6CEB01FCA3001F15F86C6CEB03F0A2
6C6CEB07E06C6CEB0FC06C6CEB1F80D8007EEB7E0090383F81FC90380FFFF0010090C7FC
282A7EA82D>I<3901FC03FC00FF90381FFF8091387C0FE09039FDE003F03A07FFC001FC
6C496C7E6C90C7127F49EC3F805BEE1FC017E0A2EE0FF0A3EE07F8AAEE0FF0A4EE1FE0A2
EE3FC06D1580EE7F007F6E13FE9138C001F89039FDE007F09039FC780FC0DA3FFFC7FCEC
07F891C9FCAD487EB512F8A32D3A7EA733>I<3901F807E000FFEB1FF8EC787CECE1FE38
07F9C100031381EA01FB1401EC00FC01FF1330491300A35BB3A5487EB512FEA31F287EA7
24>114 D<90383FC0603901FFF8E03807C03F381F000F003E1307003C1303127C007813
0112F81400A27E7E7E6D1300EA7FF8EBFFC06C13F86C13FE6C7F6C1480000114C0D8003F
13E0010313F0EB001FEC0FF800E01303A214017E1400A27E15F07E14016C14E06CEB03C0
903880078039F3E01F0038E0FFFC38C01FE01D2A7DA824>I<131CA6133CA4137CA213FC
A2120112031207001FB512C0B6FCA2D801FCC7FCB3A215E0A912009038FE01C0A2EB7F03
013F138090381F8700EB07FEEB01F81B397EB723>I<D801FC14FE00FF147FA300071403
0003140100011400B3A51501A31503120015076DEB06FF017E010E13806D4913FC90381F
C078903807FFE00100903880FE002E297DA733>I<B539E00FFFE0A32707FE000313006C
48EB00FC5E00015D7F00005DA26D13016D5CA26D6C485AA2ECC007011F91C7FCA290380F
E00EA2ECF01E0107131CA26D6C5AA2ECFC7801011370A2ECFEF001005BA2EC7FC0A36E5A
A26EC8FCA3140E2B287EA630>I<B539E00FFFE0A32707FE000313006C48EB01FC6F5A00
015D7F00005DA2017F495AA2EC8003013F5CA26D6C48C7FCA26E5A010F130EA26D6C5AA2
ECF83C01031338A26D6C5AA2ECFEF001005BA2EC7FC0A36E5AA36EC8FCA2140EA2141E14
1C143C1438A2147800181370127EB45BA2495AA248485AD87E07C9FCEA780EEA3C3CEA1F
F8EA07E02B3A7EA630>121 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fj cmss12 14.4 8
/Fj 8 118 df<923801FFF8031FEBFFE0037F14FC0203B712804A16E0141F5C91B812C0
49EC001F4901F813014901E0EB003F490180140F4990C81203D93FFCED0180494892C7FC
5C495A485B5C5A4890CBFC5B120F5BA2485AA2123F5BA3485AA5485AAD6C7EA56C7EA37F
121FA26C7EA27F12077F6C7F7E806C7F6D6C16206E16606D6CED01E06DB415036D6D1407
6D01E0EC1FF06D01F814FF6D01FF13076D91B6FC023F16E06E1680020716006E15FCDA00
7F14F0031F1480030101F8C7FC3C5578D34B>67 D<923801FFC0031F13FC92B67E020315
E0020F15F84A81027F15FF91B5C66C7F4901F8010F7F4901E001037F49018001007F4990
C86C7ED91FFCED1FFC49486F7E49486F7E4A8149486F7F48854A814890CA6C7EA2484871
7EA24848717EA24848717EA34848717EA34848717EA54848711380AF6C6C4D1300A56C6C
4D5AA46C6C4D5AA26C6CDAFFC0495A836D027F143F00076F6C5C6D6F137F6C6F6C5C6C6D
010F4A5A6E6E5A6CDB07FF5C6E6D5B6D6C038790C7FC6D6C6DEBCFFE6D6C6DEBFFFC6D6C
5E6D6C6C6D5B6D01E06D5B6D01F86D5B6D01FF017F5B6E90B6C8FC141F80020382020082
031F01FD7F030113C092C86C7E85183F727E85727E8486727F8486727F737E49647AD456
>81 D<EC0FFF027F13F049B512FC010714FF4915C0013F15E05B9038FFF801489039E000
3FC0480180130F91C71203484814014848EC0040491500485AA2485AA3485AA4485AAB6C
7EA46C7EA26C7EA26D15206C6C15600007ED01E001FF14036C6DEB0FF06C01E0133F6C90
38F803FF6DB6FC6D15E06D15800107ECFE00010114F86D6C13E0DA0FFEC7FC2C387CB634
>99 D<EC1FF0ECFFFE01036D7E010F14E04980017F8090B67E489038F01FFEECC0074890
380001FF48487F4848EC7F8049143F484815C0161F485AEE0FE05B127F49140717F090B7
FCB8FCA690CAFCA47FA2127FA27FA2123F7F121F7F6C6C15406D15C00007150101FF1407
6C6DEB1FE06C01E0137F6C9038F803FF6DB6FC6D15C06D150001075C010114F86D6C13C0
DA0FFCC7FC2C387CB634>101 D<B47EB3ABEC07FC91387FFF800181B512E0018380018F
80019F8013BF9039FFC07FFE9038FE000F496D7E497F497F17805B815BA45BB3B1295377
D23C>104 D<EAFFC0AAC7FCB3EA7FC0B3B3B10A5278D11C>I<B47EB3AC923801FFE04B13
C04B138017004B5A4B5A4B5A4B5A4B5A4A5B4A5B4A90C7FC4A5A4A5A4A5A4A5A4A5A0181
5B01835B018790C8FCEB8FFEEB9FFF13BF90B57E81A2ECBFE081EC1FF8EBFE0F01FC7F49
6C7EEBF00301E07F496C7F497E90C77F6F7E153F826F7E150F826F7E1503826F13808117
C0EE7FE0163F17F0EE1FF82D5377D239>107 D<B46CECFF80B3B3A35DA25DA25D6D5B00
7F5C6D137FD9FC01B5FC6CB55A6C5C6C14F06C14C06C49C6FC26007FE090C7FC293677B4
3C>117 D E
%EndDVIPSBitmapFont
%DVIPSBitmapFont: Fk cmr12 14.4 15
/Fk 15 120 df<DC1FFC14034BB500C01307030F02F0130F037F14FC912801FFF800FF13
1F02070180EB1FC04A48C73807E03FDA3FF8913801F07FDA7FE0EC00F8902601FF80ED3C
FF4990C97E494882494882495A4948824948825C01FF834849177F91CBFC48193F485AA2
4848181FA2121F49180FA2123FA2491807127FA31A005B12FFAE127F7FA31A07123F7FA2
121FA26D180F000F190EA26C7E1A1E6C6C181C6C193C806C6D1778137F6E17F06D6CEE01
E06D7E6D6CEE03C06D6CEE07806D6CEE0F006D6D151E9026007FE0157CDA3FF85DDA0FFE
EC03F06E6C6CEB0FE0020101F8EBFF806E6CB548C7FC030F14F8030114E09226001FFEC8
FC48567AD355>67 D<B500FC95B512FCA36E5FD8007FF2F800D93DFF943803BFF0011D62
A2011C6DEE073FA36E6C160EA36E6C161CA26E6C1638A36E6C1670A36E6C16E0A36E6CED
01C0A26E6CED0380A36E6DEC0700A36F6C140EA36F6C5CA26F6C5CA36F6C5CA36F6C5CA2
6F6C495AA36F6C495AA36F6D48C7FCA393387FC00EA2706C5AA3706C5AA3706C5AA3706C
5AA270B45AA3705BA3013E6E90C8FC137F496C4E7E000701F0027E4B7EB66C4BB612FC17
3CA35E527AD16B>77 D<003FBB12C0A449C79038F0000701F06E48130001C0183F48C8EE
0FE0007E1907007C1903A200781901A400701900A500F01AF0481A70A6C91700B3B3AC4C
7E030313FC027FB712E0A44C517CD055>84 D<ECFFC0010F13F8013F13FE9039FF00FF80
D801F0EB3FE0D803C0EB0FF0486C6D7E01F86D7E000F816D13016F7EA3707E6C5AEA01E0
C9FCA6ED3FFF020FB5FC9138FFFC7F01071300EB1FF0EB7FC04848C7FCEA03FC485A485A
485A123F5B485A187012FF90C8FCA216FFA35D6D14BF007F14036DEB073F6C6C90390F1F
C0E06C6C131E6C6C90393C0FE1C02707FE01F013FF0001B5486C13806C6C90398003FE00
D907FCC712F834367BB43B>97 D<EC0FFE91387FFFE049B512F8903907F801FE90391FE0
001FD93F80EB078049C7EA0FC001FE143F484815E00003157F485A485AA2485AEE3FC000
3FED0F004991C7FCA2127FA35B12FFAB127F7FA3123F6D1570121F6D15F0000F16E06D14
0112076C6CEC03C06D15806C6C14076C6DEB0F00D93FC0131E6D6C137C903907FC03F06D
B55AD9007F1380DA0FF8C7FC2C367CB434>99 D<17FF4BB5FCA4ED0007160182B3A6EC0F
F8EC7FFF49B512E0903907FC03F090391FE0007C49487F49C7120F01FE80484880485A00
0781484880A2485AA2485AA2127FA35B12FFAB127FA27FA2123FA27F121FA26C6C5C0007
5D7F6C6C5C6C6C5C6C6C021E7F6D6C017C13E0D91FC049EBFF8090390FF807E00103B512
800100495ADA1FF091C7FC39547CD241>I<EC0FF891B5FC010314C090390FF80FF09039
1FC003FC90397F8001FE49C77E4848EC7F804848143F49EC1FC0485A000FED0FE05B001F
16F01607485AA2007F16F8A25B160312FF90B7FCA30180C9FCA8127F7FA2123FA26D1538
121F17786C6C1570000716F06D15E06C6C14016C6CEC03C06C6C15806D6C130F6D6CEB1F
00D90FF0133C903907FE01F80101B512E06D6C1380DA07FCC7FC2D367DB434>I<EF1FC0
DA3FE0EBFFE0902701FFFC0313F001079039FF07E1F8903A1FE03FCF01903A3F800FFC03
903A7F0007F80101FE010314F04848903901FC004000036F1300491300000781A2498000
0F82A8000793C7FC6D5CA200035D6D130100015D6C6C495A017F495A6E485A9039FFE03F
C0D801C7B5C8FC01C113FC3903803FE091CAFCA57FA27F7F7F6CB612E016FF6C16C017F0
013F15FC8390B8FCD803F8C7001F1380D80FE0020113C04848EC007F4848ED1FE090C912
0F127EEF07F012FE481603A56C1607007E17E0007F160F6C6CED1FC06C6CED3F806C6CED
7F006C6C15FED803FCEC03FCC6B4EC0FF0D93FF0EBFFC0010FB6C7FC010114F8D9001F13
80354E7DB43B>103 D<EB7F80B5FCA41203C6FC137FB3A6ED07FC92383FFF8092B512E0
913981F00FF8913983C007FC9139870003FE028E1301029C6D7E14B814B002F06E7E5CA2
5CA35CB3AD2601FFE0903801FFE0B600C0B612C0A43A537CD241>I<1378EA01FE487E48
7FA66C90C7FC6C5AEA007890C8FCB0EB7F80B5FCA41203C6FC137FB3B3A43801FFE0B612
80A419507CCF21>I<01FFEB07FCB590383FFF8092B512E0913901F00FF8913903C007FC
000349C66C7EC6010E13016D486D7E5C143002706E7E146014E05CA35CB3AD2601FFE090
3801FFE0B600C0B612C0A43A347CB341>110 D<EC0FFC91387FFF8049B512E0903907F8
07F890391FE001FE90393F80007F017EC7EA1F80496E7E48486E7E00038248486E7EA248
486E7EA248486E7EA2003F82A24848ED7F80A400FF17C0AB007F1780A26D15FFA2003F17
00A2001F5E6D1401000F5E6D140300075E6C6C4A5A6C6C4A5AA2D8007FEC3F806D6C49C7
FC90391FE001FE903907F807F86DB55AD9007F1380DA0FFCC8FC32367CB43B>I<D907FE
13C090387FFF8148B512E33907F803FF390FC0007F4848133F48C7121F003E140F007E14
07127C00FC1403A315017EA27E7F6C6C90C7FC13F013FF6C13F86CEBFF806C14E06C14F8
6C14FEC680013F1480010714C0D9003F13E014039138007FF0151F00E0140FED07F8A26C
1403A215017EA36C15F0A26C14036C15E015076DEB0FC06DEB1F80D8FDF0EB3F0039F8FC
01FE39F07FFFF8D8E01F13E0D8C00390C7FC25367CB42E>115 D<EB01C0A71303A41307
A3130FA2131FA2133F137F13FF5A5A001F90B512E0B7FCA326003FC0C7FCB3A71638AC6E
1378011F1470A26D6C13F016E0903807F801903903FC03C0903901FE07806DB51200EC3F
FCEC07F0254B7EC92E>I<B60007B5D8F007B5FCA400039027E0001FFEC713F06C0180D9
0FF8EC7FC06C0307ED3F80F21F00017F0203151EA26D6C801A1CA26D6C496C5CA26E6E14
78010FDA0E7F1470A26E6F13F00107DA1C3F5CA26EEDC0010103DA381F5CA26E0178EBE0
030101DA700F5CA26E01F0EBF0076DDAE00791C7FCA2DA7F81ECF80EEEC003A2DA3FC36E
5AEE8001A2DA1FE76E5A93C7FCA2DA0FFEEC7F70A219F06E486E5AA36E486E5AA36E486E
5AA36E486EC8FC50347EB255>119 D E
%EndDVIPSBitmapFont
end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 921 85 a Fk(T)-10 b(esting)38 b(Monadic)g(Co)s(de)g(with)g
Fj(QuickCheck)1193 313 y Fi(Ko)s(en)30 b(Claessen)401
b(John)29 b(Hughes)552 495 y(Departmen)m(t)j(of)f(Computer)e(Science,)i
(Chalmers)d(Univ)m(ersit)m(y)i(of)h(T)-8 b(ec)m(hnology)-152
1276 y Fh(Abstract)-152 1433 y Fg(QuickCheck)33 b Ff(is)j(a)g
(previously)f(published)g(random)f(testing)i(to)r(ol)-152
1516 y(for)30 b(Hask)n(ell)f(programs.)43 b(In)28 b(this)h(pap)r(er)f
(w)n(e)h(sho)n(w)g(ho)n(w)g(to)g(use)g(it)-152 1599 y(for)d(testing)f
(monadic)e(co)r(de,)j(and)e(in)g(particular)i(imp)r(erativ)n(e)d(co)r
(de)-152 1682 y(written)31 b(using)f(the)f Fe(ST)40 b
Ff(monad.)47 b Fg(QuickCheck)27 b Ff(tests)k(a)f(program)-152
1765 y(against)i(a)e(sp)r(eci\014cation:)44 b(w)n(e)31
b(sho)n(w)g(that)e Fg(QuickCheck)p Ff('s)g(sp)r(eci\014-)-152
1848 y(cation)21 b(language)h(is)f(su\016cien)n(tly)f(p)r(o)n(w)n
(erful)h(to)f(represen)n(t)g(common)-152 1931 y(forms)30
b(of)g(sp)r(eci\014cations:)44 b(algebraic,)32 b(mo)r(del-based)d(\(b)r
(oth)g(func-)-152 2014 y(tional)23 b(and)e(relational\),)k(and)d
(pre-/p)r(ost-conditional.)34 b(Moreo)n(v)n(er,)-152
2097 y(all)25 b(these)g(forms)f(of)h(sp)r(eci\014cation)g(can)f(b)r(e)g
(used)g(directly)g(for)h(test-)-152 2181 y(ing.)45 b(W)-6
b(e)29 b(de\014ne)f(a)h(new)h(language)g(of)g(monadic)e(prop)r(erties,)
j(and)-152 2264 y(mak)n(e)25 b(a)i(link)f(b)r(et)n(w)n(een)g(program)g
(testing)h(and)f(the)g(notion)g(of)h(ob-)-152 2347 y(serv)l(ational)g
(equiv)l(alence.)-152 2542 y Fh(1)89 b(In)n(tro)r(duction)-152
2699 y Fg(QuickCheck)22 b Ff([4)q(])i(is)g(an)g(automated)f(testing)h
(to)r(ol)g(for)h(Hask)n(ell)f(pro-)-152 2782 y(grams.)35
b(It)24 b(de\014nes)g(a)h Fe(formal)h(sp)l(e)l(ci\014c)l(ation)j
(language)c Ff(whic)n(h)g(pro-)-152 2865 y(grammers)i(can)h(use)f(to)h
(sp)r(ecify)g(the)f(co)r(de)h(under)f(test,)h(and)f(then)-152
2948 y(c)n(hec)n(ks)36 b(that)h(the)f(stated)h(prop)r(erties)g(hold)g
(in)f(a)h(large)h(n)n(um)n(b)r(er)-152 3031 y(of)e(randomly)f
(generated)g(test)h(cases.)65 b(Sp)r(eci\014cations)36
b(are)f(th)n(us)-152 3114 y(used)24 b(directly)-6 b(,)25
b(b)r(oth)f(for)h(test)f(case)h(generation)g(and)f(as)h(a)f(test)h(or-)
-152 3197 y(acle.)38 b(The)26 b(b)r(ene\014ts)g(of)h(using)g
Fg(QuickCheck)d Ff(are)j Fe(do)l(cumente)l(d)h Ff(and)-152
3280 y Fe(r)l(ep)l(e)l(atable)35 b Ff(testing,)f(and)e(pro)r(duction)g
(of)g(a)h(sp)r(eci\014cation)g(whic)n(h)-152 3363 y(has)21
b(b)r(een)e(mac)n(hine-c)n(hec)n(k)n(ed)f(for)j(consistency)f(with)g
(the)g(program.)-152 3446 y(While)38 b(there)f(is)g(no)h(guaran)n(tee)f
(that)g(the)g(sp)r(eci\014ed)g(prop)r(erties)-152 3529
y(hold)27 b(in)g(general,)h(w)n(e)f(and)g(others)g(ha)n(v)n(e)f(found)h
(this)g(approac)n(h)g(to)-152 3612 y(b)r(e)f(highly)f(e\013ectiv)n(e)h
(at)g(rev)n(ealing)g(errors)h(quic)n(kly)d([21)r(,)h(17)q(].)-40
3695 y(In)37 b(our)g(\014rst)g Fg(QuickCheck)e Ff(pap)r(er,)41
b(w)n(e)d(fo)r(cussed)g(on)f(testing)-152 3778 y(pure)31
b(functions,)j(whic)n(h)d(are)h(easier)g(to)g(test)f(than)g
(side-e\013ecting)-152 3861 y(ones)i(since)f(one)g(need)f(not)h(tak)n
(e)f(a)h(p)r(oten)n(tially)g(large)h(and)f(com-)-152
3945 y(plex)25 b(state)g(in)n(to)g(accoun)n(t.)34 b(Hask)n(ell)26
b(programs)f(consist)g(to)g(a)h(large)-152 4028 y(exten)n(t)g(of)h
(pure)e(functions,)i(and)f(so)h(this)f(fo)r(cus)i(w)n(as)f(not)f(a)g
(ma)t(jor)-152 4111 y(restriction.)40 b(Y)-6 b(et)26
b(ev)n(en)g(in)h(Hask)n(ell,)h(imp)r(erativ)n(e)e(data-structures)-152
4194 y(and)d(algorithms)h(are)g(sometimes)f(imp)r(ortan)n(t)f(for)i(ac)
n(hieving)g(go)r(o)r(d)-152 4277 y(p)r(erformance;)56
b(hence)45 b(the)g(p)r(opularit)n(y)g(of)h(monads)f([22)q(],)51
b(and)-152 4360 y(P)n(eyton-Jones')31 b(claim)f(that)f(Hask)n(ell)i(is)
f(\\the)g(w)n(orld's)h(\014nest)f(im-)-152 4443 y(p)r(erativ)n(e)e
(programming)g(language")h([14)r(].)42 b(Th)n(us,)28
b(in)g(this)g(pap)r(er,)-152 4526 y(w)n(e)e(shall)g(sho)n(w)g(ho)n(w)g
Fg(QuickCheck)d Ff(can)j(b)r(e)f(used)g(to)h(test)f(monadic)-152
4609 y(Hask)n(ell)30 b(co)r(de,)h(and)f(esp)r(ecially)g(imp)r(erativ)n
(e)f(co)r(de)h(using)g(the)f Fe(ST)-152 4692 y Ff(monad)c([15)q(].)-40
4775 y(The)66 b(k)n(ey)e(problem)h(is)h(constructing)f(sp)r
(eci\014cations)i(of)-152 4858 y(monadic)31 b(co)r(de,)i(whic)n(h)f
(can)f(b)r(e)g(used)g(directly)g(for)i(testing.)51 b(Al-)-152
4941 y(though)28 b(this)g(is)g(not)g(as)h(straigh)n(tforw)n(ard)g(as)g
(for)g(pure)e(functions,)-152 5024 y(w)n(e)35 b(shall)h(sho)n(w)g(that)
e(b)n(y)g(b)r(orro)n(wing)i(concepts)f(from)f(program-)-152
5107 y(ming)41 b(language)i(theory)-6 b(,)44 b(w)n(e)e(can)g(construct)
f(testable)h(sp)r(eci\014-)-152 5190 y(cations)c(based)e(on)h
(algebraic)h(la)n(ws,)i(abstract)d(mo)r(dels,)j(or)c(pre-)2040
1276 y(and)28 b(p)r(ostconditions.)44 b(W)-6 b(e)28 b(in)n(tro)r(duce)g
(a)h(new)g Fe(monadic)h(pr)l(op)l(erty)2040 1359 y(language)p
Ff(,)f(whic)n(h)e(simpli\014es)g(these)h(sp)r(eci\014cations)g
(considerably)-6 b(.)2040 1442 y(Our)37 b(main)g(examples)g(are)i(an)e
(imp)r(erativ)n(e)g(implemen)n(tation)g(of)2040 1525
y(queues,)25 b(and)h(the)f(Union/Find)h(algorithm.)2152
1608 y(The)e(structure)f(of)i(the)e(pap)r(er)h(is)g(as)g(follo)n(ws.)36
b(In)23 b(the)h(next)e(sec-)2040 1691 y(tion,)33 b(w)n(e)f(in)n(tro)r
(duce)f Fg(QuickCheck)e Ff(as)i(previously)g(describ)r(ed.)51
b(In)2040 1774 y(section)18 b(3)g(w)n(e)f(in)n(tro)r(duce)g(the)g
(queue)g(example.)31 b(Section)17 b(4)h(presen)n(ts)2040
1857 y(an)31 b(algebraic)i(sp)r(eci\014cation)f(of)g(imp)r(erativ)n(e)e
(queues,)i(and)f(sho)n(ws)2040 1940 y(ho)n(w)f(it)f(can)g(b)r(e)g(used)
g(for)h(testing,)h(in)n(tro)r(ducing)e(the)g(k)n(ey)f(idea)i(of)2040
2023 y(testing)d(observ)l(ational)h(equiv)l(alence.)38
b(The)27 b(next)e(section)j(rep)r(eats)2040 2107 y(the)35
b(exercise)g(for)h(a)f(mo)r(del-based)g(sp)r(eci\014cation)h(instead.)
62 b(Sec-)2040 2190 y(tion)28 b(6)h(dra)n(ws)g(lessons)g(from)f(the)g
(queue)f(example,)i(in)f(particular)2040 2273 y(the)d(desirabilit)n(y)h
(of)g(extending)e Fg(QuickCheck)f Ff(with)j(a)f(language)i(of)2040
2356 y(monadic)g(prop)r(erties.)40 b(The)27 b(next)g(three)g(sections)h
(in)n(tro)r(duce)f(this)2040 2439 y(language,)i(presen)n(t)d(a)i
(formal)f(seman)n(tics,)h(and)e(sk)n(etc)n(h)g(its)i(imple-)2040
2522 y(men)n(tation.)33 b(W)-6 b(e)23 b(illustrate)i(the)e(monadic)g
(prop)r(ert)n(y)g(language)i(b)n(y)2040 2605 y(testing)c(the)g
(Union/Find)f(algorithm)h(in)g(the)g(next)f(three)g(sections,)2040
2688 y(whic)n(h)28 b(in)n(tro)r(duce)g(the)g(algorithm,)i(test)e(it)h
(using)f(pre-)g(and)g(p)r(ost-)2040 2771 y(conditions,)e(and)e(using)h
(a)g(relational)h(mo)r(del-based)e(sp)r(eci\014cation)2040
2854 y(resp)r(ectiv)n(ely)-6 b(.)34 b(Sp)r(eci\014cations)25
b(can)g(b)r(ecome)f(quite)g(bulky;)g(section)2040 2937
y(13)29 b(illustrates)h(an)e(approac)n(h)h(to)f(simplifying)h(them,)f
(b)n(y)f(de\014ning)2040 3020 y(ev)n(en)f(higher-lev)n(el)g(com)n
(binators)g(for)h(mo)r(del-based)e(sp)r(eci\014cation)2040
3103 y(of)36 b(imp)r(erativ)n(e)f(ADTs,)j(whic)n(h)d(mak)n(e)f(suc)n(h)
h(sp)r(eci\014cations)i(v)n(ery)2040 3186 y(concise.)g(Finally)-6
b(,)27 b(section)g(14)g(discusses)h(related)f(w)n(ork,)g(and)e(sec-)
2040 3269 y(tion)h(15)g(concludes.)2040 3464 y Fh(2)89
b(Bac)n(kground:)39 b(An)29 b(Ov)n(erview)g(of)h Fg(QuickCheck)2040
3621 y(QuickCheck)35 b Ff(is)i(used)g(b)n(y)e(adding)i(prop)r(ert)n(y)f
(de\014nitions)h(to)g(the)2040 3704 y(program)28 b(co)r(de,)i(either)e
(together)h(with)f(the)g(co)r(de)h(under)e(test,)i(or)2040
3787 y(in)h(separate)h(\\sp)r(eci\014cation")h(mo)r(dules.)47
b(Prop)r(erties)31 b(are)f(simply)2040 3870 y(Hask)n(ell)c
(de\014nitions,)g(suc)n(h)f(as)i(the)e(follo)n(wing:)2206
4027 y Fe(pr)l(op)p 2360 4027 24 4 v 34 w(PlusAsso)l(c)44
b Ff(::)39 b Fe(Int)45 b Fd(!)38 b Fe(Int)46 b Fd(!)38
b Fe(Int)46 b Fd(!)38 b Fe(Bo)l(ol)2206 4110 y(pr)l(op)p
2360 4110 V 34 w(PlusAsso)l(c)22 b(x)27 b(y)d(z)48 b
Ff(=)38 b(\()p Fe(x)26 b Ff(+)17 b Fe(y)7 b Ff(\))17
b(+)g Fe(z)35 b Ff(=)-13 b(=)25 b Fe(x)i Ff(+)16 b(\()p
Fe(y)24 b Ff(+)17 b Fe(z)9 b Ff(\))2040 4267 y(Prop)r(erties)22
b(are)f(implicitly)f(univ)n(ersally)g(quan)n(ti\014ed)f(o)n(v)n(er)h
(their)h(ar-)2040 4350 y(gumen)n(ts,)k(so)h(this)g(prop)r(ert)n(y)f
(states)i(the)e(asso)r(ciativit)n(y)j(of)e(in)n(teger)2040
4433 y(addition.)2152 4516 y(Prop)r(erties)37 b(are)g(tested)e(b)n(y)g
(passing)i(them)d(to)i(the)f(function)2040 4599 y Fe(quickChe)l(ck)10
b Ff(.)68 b(F)-6 b(or)37 b(example,)j(using)d(the)f(Hugs)h(in)n
(terpreter)g(w)n(e)2040 4682 y(w)n(ould)26 b(test)g(the)f(prop)r(ert)n
(y)g(ab)r(o)n(v)n(e)h(b)n(y)2206 4839 y Fe(Main)6 b Fc(>)16
b Fe(quickChe)l(ck)27 b(pr)l(op)p 3009 4839 V 34 w(PlusAsso)l(c)2206
4922 y(OK)11 b Fc(;)30 b Fe(p)l(asse)l(d)c Ff(100)19
b Fe(tests)6 b Fc(:)2040 5079 y Ff(This)40 b(tests)g(the)f(prop)r(ert)n
(y)g(in)h(one)f(h)n(undred)f(randomly)h(gener-)2040 5162
y(ated)32 b(cases.)56 b(The)32 b(function)h Fe(quickChe)l(ck)42
b Ff(is)32 b(o)n(v)n(erloaded,)j(to)e(ac-)2040 5245 y(cept)25
b(prop)r(erties)g(with)g(an)n(y)f(n)n(um)n(b)r(er)f(of)i(argumen)n(ts,)
g(and)f(w)n(e)h(also)p eop
%%Page: 2 2
2 1 bop -152 -69 a Ff(pro)n(vide)34 b(a)h(small)g(script)f(whic)n(h)h
(in)n(v)n(ok)n(es)e Fe(quickChe)l(ck)44 b Ff(on)35 b(ev)n(ery)-152
14 y(prop)r(ert)n(y)30 b(in)g(a)h(mo)r(dule)f(\(prop)r(ert)n(y)f(names)
h(b)r(egin)h(with)g(\\)p Fe(pr)l(op)p 1778 14 24 4 v
33 w Ff(")-152 97 y(just)26 b(so)g(that)g(this)g(script)g(can)f(\014nd)
g(them\).)-40 180 y(The)30 b Fg(QuickCheck)d Ff(prop)r(ert)n(y)h
(language)j(also)f(pro)n(vides)f Fe(c)l(ondi-)-152 263
y(tional)f(pr)l(op)l(erties)p Ff(.)37 b(F)-6 b(or)26
b(example,)14 416 y Fe(pr)l(op)p 168 416 V 34 w(InsertOr)l(der)l(e)l(d)
192 b Ff(::)30 b Fe(Int)46 b Fd(!)38 b Ff([)p Fe(Int)7
b Ff(])39 b Fd(!)f Fe(Pr)l(op)l(erty)14 499 y(pr)l(op)p
168 499 V 34 w(InsertOr)l(der)l(e)l(d)27 b(x)g(xs)h Ff(=)21
b Fe(or)l(der)l(e)l(d)27 b(xs)45 b Ff(=)-13 b Fd(\))91
582 y Fe(or)l(der)l(e)l(d)27 b Ff(\()p Fe(insert)e(x)i(xs)6
b Ff(\))-152 735 y(states)20 b(that)e(inserting)h(an)f(elemen)n(t)g(in)
n(to)h(an)f(ordered)g(list)i(pro)r(duces)-152 818 y(an)28
b(ordered)g(list.)41 b(T)-6 b(esting)28 b(suc)n(h)f(a)h(prop)r(ert)n(y)
f Fe(disc)l(ar)l(ds)i Ff(test)f(cases)-152 901 y(whic)n(h)d(do)g(not)g
(satisfy)h(the)e(precondition,)h(to)g(guaran)n(tee)h(that)e(w)n(e)-152
984 y(test)18 b(the)g(conclusion)h(with)f(100)h(ordered)f(lists.)33
b(Notice)18 b(that)g(the)f(re-)-152 1067 y(sult)24 b(t)n(yp)r(e)e(is)i
(di\013eren)n(t)e(in)h(this)h(case:)34 b(=)-13 b Fd(\))23
b Ff(isn't)g(a)h(simple)f(b)r(o)r(olean)-152 1150 y(op)r(erator)k
(since)g(it)f(a\013ects)g(the)g(selection)h(of)g(test)f(cases.)36
b(All)26 b(suc)n(h)-152 1233 y(op)r(erators)h(in)f(Quic)n(kChec)n(k)f
(ha)n(v)n(e)g(the)g(result)h(t)n(yp)r(e)f Fe(Pr)l(op)l(erty)9
b Ff(.)-40 1316 y(Alternativ)n(ely)-6 b(,)21 b(rather)g(than)f(quan)n
(tify)f(o)n(v)n(er)i(all)g(lists)g(and)f(then)-152 1399
y(select)30 b(the)f(ordered)g(ones,)i(w)n(e)f(can)f(quan)n(tify)g
(explicitly)g(o)n(v)n(er)g(or-)-152 1482 y(dered)d(ones:)14
1635 y Fe(pr)l(op)p 168 1635 V 34 w(InsertOr)l(der)l(e)l(d)102
b Ff(::)30 b Fe(Int)46 b Fd(!)38 b Fe(Pr)l(op)l(erty)14
1718 y(pr)l(op)p 168 1718 V 34 w(InsertOr)l(der)l(e)l(d)27
b(x)k Ff(=)21 b Fe(forA)n(l)t(l)j(or)l(der)l(e)l(dLists)i
Ff($)18 b Fc(\025)f Fe(xs)45 b Fd(!)91 1801 y Fe(or)l(der)l(e)l(d)27
b Ff(\()p Fe(insert)e(x)i(xs)6 b Ff(\))-152 1954 y(This)27
b(mak)n(es)e(for)i(more)e(e\016cien)n(t)h(testing)g(and,)g(often,)h(b)r
(etter)f(test)-152 2037 y(co)n(v)n(erage.)-40 2120 y(The)38
b(\014rst)f(argumen)n(t)f(of)i Fe(forA)n(l)t(l)44 b Ff(ab)r(o)n(v)n(e,)
c Fe(or)l(der)l(e)l(dLists)9 b Ff(,)41 b(is)c(a)-152
2203 y Fe(test)g(data)g(gener)l(ator)p Ff(.)62 b(W)-6
b(e)34 b(can)h(think)e(of)i(it)f(as)h(represen)n(ting)f(a)-152
2286 y(set)c(that)f(w)n(e)h(quan)n(tify)f(o)n(v)n(er,)h(or,)h(more)e
(precisely)-6 b(,)31 b(a)f(probabilit)n(y)-152 2369 y(distribution)22
b(o)n(v)n(er)g(suc)n(h)g(a)g(set.)34 b Fg(QuickCheck)20
b Ff(also)j(pro)n(vides)f(a)h(test)-152 2452 y(data)31
b(generation)f(language)i(for)e(de\014ning)g(suc)n(h)f(sets.)48
b(T)-6 b(est)31 b(data)-152 2535 y(generators)k(ha)n(v)n(e)e(t)n(yp)r
(es)h(of)g(the)f(form)h Fe(Gen)24 b Fc(\034)8 b Ff(,)36
b(where)e Fe(Gen)40 b Ff(is)34 b(a)-152 2618 y(monad,)23
b(whic)n(h)h(enables)f(us)g(to)h(use)f(Hask)n(ell's)h(monadic)f(syn)n
(tactic)-152 2702 y(sugar)39 b(and)f(ric)n(h)g(library)h(of)g(monadic)f
(op)r(erators)h(in)f(test)h(data)-152 2785 y(generator)24
b(de\014nitions.)33 b(In)21 b(addition,)j(there)e(are)h(com)n(binators)
f(for)-152 2868 y(making)j(c)n(hoices)i(b)r(et)n(w)n(een)e(alternativ)n
(es,)i(suc)n(h)e(as)14 3020 y Fe(one)l(of)55 b Ff(::)39
b([)p Fe(Gen)24 b Fc(\013)p Ff(])39 b Fd(!)f Fe(Gen)24
b Fc(\013)-152 3173 y Ff(whic)n(h)31 b(c)n(ho)r(oses)g(b)r(et)n(w)n
(een)g(alternativ)n(es)g(with)f(equal)h(probabilit)n(y)-6
b(,)-152 3256 y(or)14 3409 y Fe(fr)l(e)l(quency)47 b
Ff(::)39 b([\()p Fe(Int)7 b Fc(;)14 b Fe(Gen)23 b Fc(\013)p
Ff(\)])39 b Fd(!)g Fe(Gen)23 b Fc(\013)-152 3562 y Ff(whic)n(h)j(attac)
n(hes)g(a)g(w)n(eigh)n(t)g(to)g(eac)n(h)g(alternativ)n(e.)-40
3645 y(W)-6 b(e)23 b(can)f(de\014ne)g(a)h Fe(default)g
Ff(test)f(data)h(generator)h(for)f(eac)n(h)g(t)n(yp)r(e)-152
3728 y(as)k(an)e(instance)h(of)h(the)e(class)i Fe(A)n(rbitr)l(ary)9
b Ff(:)14 3881 y Fh(class)18 b Fe(A)n(rbitr)l(ary)26
b Fc(\013)91 3964 y Fh(where)168 4047 y Fe(arbitr)l(ary)47
b Ff(::)39 b Fe(Gen)24 b Fc(\013)-152 4192 y Fg(QuickCheck)16
b Ff(pro)n(vides)i(instances)h(of)g(this)f(class)h(for)g(all)g(of)g
(Hask)n(ell's)-152 4275 y(standard)31 b(t)n(yp)r(es.)48
b(These)31 b(default)g(generators)h(are)f(used)f(to)h(con-)-152
4358 y(struct)25 b(top-lev)n(el)g(prop)r(ert)n(y)f(argumen)n(ts,)h(or)g
(of)h(course)f(if)h(the)e(pro-)-152 4441 y(grammer)h(writes)i
Fe(forA)n(l)t(l)d(arbitr)l(ary)34 b Ff(explicitly)-6
b(.)-40 4524 y Fg(QuickCheck)40 b Ff(pro)n(vides)i(sev)n(eral)g
(functions)g(for)h(making)e Fe(ob-)-152 4607 y(servations)k
Ff(of)e(test)g(data,)k(of)c(whic)n(h)g(the)f(most)g(imp)r(ortan)n(t)f
(is)-152 4690 y Fe(c)l(ol)t(le)l(ct)8 b Ff(.)49 b(F)-6
b(or)31 b(example,)g(w)n(e)g(could)g(observ)n(e)f(the)h(lengths)f(of)i
(lists)-152 4773 y(in)26 b Fe(pr)l(op)p 92 4773 V 33
w(InsertOr)l(der)l(e)l(d)36 b Ff(b)n(y)25 b(rede\014ning)g(it)h(as)14
4926 y Fe(pr)l(op)p 168 4926 V 34 w(InsertOr)l(der)l(e)l(d)h(x)g(xs)h
Ff(=)21 b Fe(or)l(der)l(e)l(d)27 b(xs)45 b Ff(=)-13 b
Fd(\))91 5009 y Fe(c)l(ol)t(le)l(ct)25 b Ff(\()p Fe(length)f(xs)6
b Ff(\))18 b($)f Fe(or)l(der)l(e)l(d)27 b Ff(\()p Fe(insert)e(x)i(xs)6
b Ff(\))-152 5162 y(whic)n(h)22 b(causes)h(a)f(table)h(sho)n(wing)g
(the)e(distribution)h(of)h Fe(length)h(xs)29 b Ff(in)-152
5245 y(the)18 b(actual)g(test)g(data)g(to)g(b)r(e)g(displa)n(y)n(ed)f
(when)h(testing)g(is)h(complete.)2040 -69 y(The)24 b(programmer)g(can)g
(then)f(decide)i(whether)f(the)f(test)i(co)n(v)n(erage)2040
14 y(w)n(as)i(adequate,)e(or)i(not.)2152 97 y(Apart)34
b(from)g(the)g(small)h(script)f(for)h(extracting)g(and)f(testing)2040
180 y(prop)r(erties)22 b(from)g(mo)r(dules,)g Fg(QuickCheck)e
Ff(is)i(de\014ned)e(en)n(tirely)i(as)g(a)2040 263 y(collection)h(of)f
(com)n(binators)g(|)f(it)h(is)g(a)g Fe(domain)h(sp)l(e)l(ci\014c)i(emb)
l(e)l(dde)l(d)2040 346 y(language)j Ff([13)q(].)39 b(T)-6
b(o)28 b(use)f(it,)h(the)f(programmer)f(need)g(only)h(imp)r(ort)2040
429 y(mo)r(dule)d Fg(QuickCheck)e Ff(|)h(whic)n(h)i(is)f(itself)i(only)
e(300)h(lines)g(of)g(co)r(de!)2040 512 y(Its)c(ligh)n(t)n(w)n(eigh)n(t)
g(nature)g(mak)n(es)f Fg(QuickCheck)f Ff(easy)i(to)g(mo)r(dify)f(and)
2040 596 y(exp)r(erimen)n(t)k(with.)2040 787 y Fh(3)89
b(A)29 b(Simple)h(Example:)38 b(Queues)2040 944 y Ff(W)-6
b(e)25 b(shall)h(tak)n(e)f(as)h(an)f(example)g(one)g(of)h(the)f
(simplest)g(imp)r(erativ)n(e)2040 1027 y(abstract)38
b(datat)n(yp)r(es,)i(a)d(queue.)68 b(W)-6 b(e)36 b(assume)h(w)n(e)h
(are)f(giv)n(en)g(a)2040 1110 y(mo)r(dule)25 b(implemen)n(ting)f
(queues,)h(with)h(the)g(signature)2206 1243 y Fh(data)18
b Fe(Queue)23 b(s)h(a)j Ff(=)34 b Fc(:)13 b(:)g(:)2206
1326 y Fe(empty)352 b Ff(::)30 b Fe(ST)d(s)d Ff(\()p
Fe(Queue)f(s)g(a)6 b Ff(\))2206 1409 y Fe(add)434 b Ff(::)30
b Fe(Queue)24 b(s)f(a)45 b Fd(!)38 b Fe(a)44 b Fd(!)38
b Fe(ST)27 b(s)d Ff(\(\))2206 1492 y Fe(r)l(emove)316
b Ff(::)30 b Fe(Queue)24 b(s)f(a)k Fd(!)39 b Fe(ST)27
b(s)c Ff(\(\))2206 1575 y Fe(fr)l(ont)392 b Ff(::)30
b Fe(Queue)24 b(s)f(a)k Fd(!)39 b Fe(ST)27 b(s)c Ff(\()p
Fe(Mayb)l(e)h(a)6 b Ff(\))2040 1708 y(whose)32 b(op)r(erations)h
(create)f(an)g(empt)n(y)d(queue,)k(add)e(an)g(elemen)n(t,)2040
1791 y(remo)n(v)n(e)i(an)h(elemen)n(t,)i(and)e(return)f(the)h(fron)n(t)
g(elemen)n(t)f(without)2040 1874 y(remo)n(ving)25 b(it,)h(if)g(there)f
(is)h(one.)35 b(Queues)25 b(are)h(implemen)n(ted)e(in)h(the)2040
1957 y(standard)19 b(imp)r(erativ)n(e)e(w)n(a)n(y)-6
b(,)20 b(so)g(the)e(queue)f(op)r(erations)j(ha)n(v)n(e)e(t)n(yp)r(es)
2040 2040 y(in)27 b(the)f Fe(ST)37 b Ff(monad,)27 b(and)f(the)h
Fe(Queue)33 b Ff(t)n(yp)r(e)26 b(is)i(parameterised)f(on)2040
2123 y(the)k(state)g(thread)g(it)h(b)r(elongs)g(to.)51
b(W)-6 b(e)31 b(omit)f(the)h(details)h(of)g(the)2040
2206 y(implemen)n(tation.)2152 2289 y(Of)d(course,)h(there)f(are)g
(e\016cien)n(t)g(w)n(a)n(ys)g(to)g(implemen)n(t)d(queues)2040
2372 y(purely)21 b(functionally)h(also)g([3)q(],)h(but)d(this)i(is)g
(not)f(the)g(p)r(oin)n(t:)32 b(queues)2040 2455 y(serv)n(e)18
b(here)g(simply)e(as)j(an)f(example)e(of)j(an)f(abstract)g(datat)n(yp)r
(e)f(with)2040 2538 y(an)26 b(imp)r(erativ)n(e)e(implemen)n(tation.)34
b(In)24 b(the)i(follo)n(wing)i(sections)e(w)n(e)2040
2621 y(shall)h(see)f(ho)n(w)g(w)n(e)g(can)g(sp)r(ecify)g(their)g(b)r
(eha)n(viour.)2040 2813 y Fh(4)89 b(T)-7 b(esting)29
b(an)h(Algebraic)h(Sp)r(eci\014cation)h(of)e(Queues)2040
2970 y Ff(One)25 b(w)n(ell)h(established)h(w)n(a)n(y)e(to)h(sp)r(ecify)
g(an)f(abstract)h(datat)n(yp)r(e)f(is)2040 3053 y(via)31
b(an)g Fe(algebr)l(aic)i(sp)l(e)l(ci\014c)l(ation)p Ff(,)i(in)30
b(whic)n(h)h(w)n(e)h(c)n(haracterise)g(the)2040 3136
y(b)r(eha)n(viour)38 b(of)h(our)f(op)r(erations)i(b)n(y)d(giving)i
(equations)g(b)r(et)n(w)n(een)2040 3219 y(terms.)63 b(F)-6
b(or)35 b(example,)i(if)f(w)n(e)g(w)n(ere)g(sp)r(ecifying)g(Hask)n
(ell's)g(lists,)2040 3302 y(then)25 b(one)h(suc)n(h)f(equation)h(migh)n
(t)e(b)r(e)2462 3435 y Fe(xs)g Ff(+)-30 b(+)16 b(\()p
Fe(ys)24 b Ff(+)-30 b(+)16 b Fe(zs)6 b Ff(\))22 b(=)g(\()p
Fe(xs)h Ff(+)-30 b(+)17 b Fe(ys)6 b Ff(\))18 b(+)-30
b(+)16 b Fe(zs)2040 3568 y Ff(In)27 b(this)g(case,)i(since)f(our)f(op)r
(erations)i(are)e(monadic,)h(w)n(e)g(will)g(giv)n(e)2040
3651 y(equations)f(b)r(et)n(w)n(een)g Fe(fr)l(agments)j(of)f(monadic)f
(c)l(o)l(de)p Ff(,)h(that)e(is,)h(pro-)2040 3734 y(gram)f(fragmen)n(ts)
h(whic)n(h)f(migh)n(t)g(app)r(ear)h(as)g(part)f(of)i(a)e
Fh(do)h Ff(blo)r(c)n(k.)2040 3817 y(Our)d(sp)r(eci\014cation)i(of)f
(queues)f(is)i(giv)n(en)e(b)r(elo)n(w.)p 2308 3961 473
4 v 2306 4044 4 84 v 2345 4019 a Fe(q)j Fd( )21 b Fe(empty)p
2779 4044 V 2306 4127 V 2345 4102 a(x)31 b Fd( )21 b
Fe(fr)l(ont)33 b(q)p 2779 4127 V 2308 4131 473 4 v 2855
4063 a Ff(=)p 2990 3961 746 4 v 2988 4044 4 84 v 3027
4019 a Fe(q)28 b Fd( )22 b Fe(empty)p 3734 4044 V 2988
4127 V 3027 4102 a(x)31 b Fd( )21 b Fe(r)l(eturn)33 b(Nothing)p
3734 4127 V 2990 4131 746 4 v 3935 4063 a Ff(\(1\))p
2308 4167 473 4 v 2306 4250 4 84 v 2345 4225 a Fe(q)28
b Fd( )21 b Fe(empty)p 2779 4250 V 2306 4333 V 2345 4308
a(add)34 b(q)e(m)p 2779 4333 V 2306 4416 V 2345 4391
a(x)f Fd( )21 b Fe(fr)l(ont)33 b(q)p 2779 4416 V 2308
4420 473 4 v 2855 4310 a Ff(=)p 2990 4167 776 4 v 2988
4250 4 84 v 3027 4225 a Fe(q)28 b Fd( )22 b Fe(empty)p
3763 4250 V 2988 4333 V 3027 4308 a(add)34 b(q)f(m)p
3763 4333 V 2988 4416 V 3027 4391 a(x)e Fd( )21 b Fe(r)l(eturn)33
b Ff(\()p Fe(Just)h(m)6 b Ff(\))p 3763 4416 V 2990 4420
776 4 v 3935 4310 a(\(2\))p 2308 4456 473 4 v 2306 4539
4 84 v 2345 4514 a Fe(add)34 b(q)e(m)p 2779 4539 V 2306
4622 V 2345 4597 a(add)i(q)e(n)p 2779 4622 V 2306 4705
V 2345 4680 a(x)f Fd( )21 b Fe(fr)l(ont)33 b(q)p 2779
4705 V 2308 4708 473 4 v 2855 4599 a Ff(=)p 2990 4456
V 2988 4539 4 84 v 3027 4514 a Fe(add)h(q)f(m)p 3461
4539 V 2988 4622 V 3027 4597 a(x)e Fd( )21 b Fe(fr)l(ont)33
b(q)p 3461 4622 V 2988 4705 V 3027 4680 a(add)h(q)f(n)p
3461 4705 V 2990 4708 473 4 v 3935 4599 a Ff(\(3\))p
2338 4745 443 4 v 2336 4828 4 84 v 2375 4803 a Fe(q)c
Fd( )21 b Fe(empty)p 2779 4828 V 2336 4911 V 2375 4886
a(add)34 b(q)f(m)p 2779 4911 V 2336 4994 V 2375 4969
a(r)l(emove)g(q)p 2779 4994 V 2338 4997 443 4 v 2855
4888 a Ff(=)p 2990 4828 V 2988 4911 4 84 v 3027 4886
a Fe(q)28 b Fd( )22 b Fe(empty)p 3431 4911 V 2990 4914
443 4 v 3935 4888 a Ff(\(4\))p 2397 5034 385 4 v 2395
5117 4 84 v 2434 5092 a Fe(add)34 b(q)e(m)p 2779 5117
V 2395 5200 V 2434 5175 a(add)i(q)e(n)p 2779 5200 V 2395
5283 V 2434 5258 a(r)l(emove)g(q)p 2779 5283 V 2397 5286
385 4 v 2855 5177 a Ff(=)p 2990 5034 V 2988 5117 4 84
v 3027 5092 a Fe(add)i(q)f(m)p 3372 5117 V 2988 5200
V 3027 5175 a(r)l(emove)g(q)p 3372 5200 V 2988 5283 V
3027 5258 a(add)h(q)f(n)p 3372 5283 V 2990 5286 385 4
v 3935 5177 a Ff(\(5\))1921 5494 y(2)p eop
%%Page: 3 3
3 2 bop -152 -69 a Ff(Are)29 b(these)h(equations)f(a)h(complete)f(sp)r
(eci\014cation?)46 b(Do)29 b(they)f(de-)-152 14 y(\014ne)18
b(the)f(b)r(eha)n(viour)h(of)h(ev)n(ery)e(sequence)h(of)h(queue)e(op)r
(erations?)33 b(T)-6 b(o)-152 97 y(see)33 b(that)e(they)g(do,)j(w)n(e)f
(shall)f(argue)h(that)f(ev)n(ery)f(suc)n(h)g(sequence)-152
180 y(can)25 b(b)r(e)f(put)g(in)n(to)g(a)h Fe(normal)h(form)e
Ff(consisting)i(of)f(queue)f(creation,)-152 263 y(follo)n(w)n(ed)f(b)n
(y)c(an)n(y)h(n)n(um)n(b)r(er)e(of)j Fe(add)28 b Ff(op)r(erations,)23
b(follo)n(w)n(ed)g(b)n(y)c(bind-)-152 346 y(ings)h(of)h(v)l(ariables)f
(to)g(v)l(alues)f(\(via)h Fe(x)47 b Fd( )39 b Fe(r)l(eturn)24
b(v)9 b Ff(\).)32 b(Consider)20 b(an)n(y)-152 429 y(suc)n(h)j
(sequence,)g(and)f(consider)i(the)e Fe(\014rst)i Ff(use)f(of)g
Fe(fr)l(ont)31 b Ff(or)23 b Fe(r)l(emove)7 b Ff(,)-152
512 y(if)29 b(one)e(exists.)41 b(If)27 b(this)h(\014rst)f(use)h(is)g
(of)g Fe(fr)l(ont)8 b Ff(,)28 b(then)f(equations)h(\(1\))-152
596 y(to)23 b(\(3\))g(allo)n(w)i(us)d(to)h(remo)n(v)n(e)f(it,)i(b)n(y)d
(mo)n(ving)h(it)h(earlier)h(un)n(til)f(it)g(can)-152
679 y(b)r(e)35 b(replaced)g(b)n(y)f(a)h Fe(r)l(eturn)7
b Ff(.)62 b(Bindings)35 b(using)g Fe(r)l(eturn)43 b Ff(can)34
b(then)-152 762 y(b)r(e)g(mo)n(v)n(ed)e(to)i(the)g(end)f(of)i(the)e
(sequence)h(of)h(queue)e(op)r(erations)-152 845 y(using)28
b(the)f(monad)g(la)n(ws,)j(and)d(so)h(do)g(not)f(in)n(terfere)h(with)g
(further)-152 928 y(application)g(of)f(these)g(equations.)37
b(If)26 b(the)h(\014rst)f(use)g(is)h(of)h Fe(r)l(emove)7
b Ff(,)-152 1011 y(then)21 b(equations)h(\(4\))g(and)f(\(5\))h(enable)g
(us)g(to)g(remo)n(v)n(e)e(it)i(b)n(y)f(mo)n(ving)-152
1094 y(it)31 b(earlier)h(un)n(til)e(it)h(encoun)n(ters)f(the)h(matc)n
(hing)e Fe(add)39 b Ff(|)30 b Fe(pr)l(ovide)l(d)-152
1177 y Ff(there)h(are)f(at)h(least)g(as)h(man)n(y)c Fe(add)9
b Ff(s)30 b(as)h Fe(r)l(emove)7 b Ff(s.)49 b(Indeed,)31
b(a)g(se-)-152 1260 y(quence)18 b(of)i(queue)e(op)r(erations)i(is)f
(only)g Fe(wel)t(l-forme)l(d)f Ff(if)i(ev)n(ery)e(pre\014x)-152
1343 y(con)n(tains)27 b(at)e(least)i(as)f(man)n(y)e Fe(add)34
b Ff(op)r(erations)27 b(as)f Fe(r)l(emove)7 b Ff(s.)-40
1426 y(But)38 b Fe(what)h(do)g(we)g(me)l(an)g(by)g(e)l(quality)f
Ff(in)g(these)f(equations?)-152 1509 y(W)-6 b(e)31 b(certainly)h(do)f
Fe(not)h Ff(mean)e(that)h(the)g(t)n(w)n(o)g(sides)h(generate)g(the)-152
1592 y(same)d(state)g(when)f(they)g(are)h(run!)42 b(In)28
b(particular,)i(the)e(left)h(hand)-152 1675 y(side)39
b(of)f(equation)g(\(4\))g(creates)h(and)f(discards)h(an)f(in)n(ternal)g
(cell)-152 1758 y(in)d(the)g(queue,)i(while)f(the)e(righ)n(t)h(hand)g
(side)g(do)r(es)h(not:)53 b(clearly)-152 1841 y(p)r(oin)n(ter)23
b(v)l(alues)g(and)f(memory)f(con)n(ten)n(ts)h(will)i(di\013er)f(after)g
(the)f(t)n(w)n(o)-152 1924 y(sequences)36 b(are)f(executed.)63
b(Y)-6 b(et)35 b(the)f(di\013erence)i(is)g(in)f(lo)n(w-lev)n(el)-152
2007 y(represen)n(tations,)24 b(and)e(cannot)h(b)r(e)f(observ)n(ed)g(b)
n(y)f(the)h(Hask)n(ell)h(pro-)-152 2090 y(grammer.)-40
2173 y(W)-6 b(e)33 b(therefore)h(fo)r(cus)h(on)e(the)g(observ)l(able)h
(b)r(eha)n(viour)f(of)h(our)-152 2256 y(co)r(de.)f(F)-6
b(ortunately)g(,)21 b(op)r(erational)g(seman)n(ticists)f(ha)n(v)n(e)f
(already)h(de-)-152 2339 y(\014ned)25 b(a)h(program)g(equiv)l(alence)f
(based)h(on)f(observ)l(ations!)14 2464 y Fh(De\014nition)42
b Ff(A)d Fe(c)l(ontext)k(C)51 b Ff(is)40 b(a)h(\\program)f(with)g(a)14
2547 y(hole".)68 b(W)-6 b(e)37 b(write)g(the)f(result)h(of)g
(\\\014lling)h(the)e(hole")14 2630 y(with)26 b(a)g(term)f
Fe(e)31 b Ff(as)c Fe(C)11 b Ff([)p Fe(e)6 b Ff(].)14
2796 y Fh(De\014nition)56 b Ff(W)-6 b(e)54 b(write)g
Fe(p)74 b Fd(+)69 b Fe(o)59 b Ff(when)54 b(program)14
2879 y Fe(p)31 b Ff(computes)25 b(an)g(observ)l(able)h(result)g
Fe(o)5 b Ff(.)14 3045 y Fh(De\014nition)60 b Ff(Tw)n(o)f(terms)e
Fe(e)64 b Ff(and)58 b Fe(e)1229 3013 y Fb(0)1309 3045
y Ff(are)h Fe(op)l(er)l(a-)14 3128 y(tional)t(ly)38 b(e)l(quivalent)f
Ff(if,)k(for)c(ev)n(ery)e(con)n(text)h Fe(C)11 b Ff(,)39
b(then)14 3211 y Fe(C)11 b Ff([)p Fe(e)6 b Ff(])22 b
Fd(+)f Fe(o)31 b Ff(if)26 b(and)f(only)h(if)g Fe(C)11
b Ff([)p Fe(e)909 3179 y Fb(0)932 3211 y Ff(])21 b Fd(+)h
Fe(o)5 b Ff(.)-40 3335 y(In)37 b(our)h(case,)j(t)n(w)n(o)d(program)g
(fragmen)n(ts)f(are)h(equiv)l(alen)n(t)f(if,)-152 3418
y(when)30 b(they)e(are)i(inserted)g(in)n(to)f(an)n(y)g(Hask)n(ell)h
(program,)g(the)f(pro-)-152 3501 y(gram)i(output)e(is)i(the)g(same.)49
b(Y)-6 b(et)29 b(quan)n(tifying)h(o)n(v)n(er)h(all)g(Hask)n(ell)-152
3584 y(programs)37 b(with)g(holes)g(is)h(impractical,)i(b)r(ecause)d
(Hask)n(ell)g(is)g(so)-152 3667 y(complex.)85 b(So)43
b(instead,)48 b(w)n(e)43 b(shall)h(restrict)f(our)g(atten)n(tion)g(to)
-152 3750 y(\\queue)26 b(programs",)i(whic)n(h)f(con)n(tain)g
Fe(only)f Ff(queue)g(op)r(erations)i(on)-152 3833 y(a)g(single)g(queue)
f(of)h(in)n(tegers,)h(and)e(moreo)n(v)n(er)f(are)i(w)n(ell-formed)g(in)
-152 3916 y(the)19 b(sense)h(discussed)g(ab)r(o)n(v)n(e.)33
b(W)-6 b(e)19 b(shall)h(restrict)h(our)e(observ)l(ations)-152
3999 y(to)30 b(the)e(v)l(alues)h(b)r(ound)g(to)g(v)l(ariables)h(in)f
(uses)g(of)h Fe(fr)l(ont)8 b Ff(.)44 b(Th)n(us)29 b(w)n(e)-152
4082 y(consider)j(t)n(w)n(o)g(queue-program)e(fragmen)n(ts)h(equiv)l
(alen)n(t)f(if,)k(when)-152 4165 y(they)25 b(are)h(inserted)g(in)n(to)g
(an)n(y)f(queue)g(program)h(\(in)f(a)h(w)n(ell-formed)-152
4248 y(w)n(a)n(y\),)h(then)f(the)g(results)i(deliv)n(ered)e(b)n(y)g
(all)h(the)f(calls)j(of)e Fe(fr)l(ont)34 b Ff(are)-152
4332 y(the)26 b(same.)-40 4415 y(In)f(restricting)i(con)n(texts)e(and)g
(observ)l(ations)h(lik)n(e)g(this,)f(w)n(e)h(are)-152
4498 y(making)j(a)g(n)n(um)n(b)r(er)e(of)j(reasonable)g(assumptions.)45
b(Since)28 b Fe(Queue)-152 4581 y Ff(is)g(an)e(abstract)i(datat)n(yp)r
(e,)e(other)h(op)r(erations)h(in)f(the)f Fe(ST)37 b Ff(monad)-152
4664 y(should)42 b(not)f(in)n(terfere)h(with)g(queue)f(op)r(erations)i
(|)e(i.e.)83 b(they)-152 4747 y(should)32 b(comm)n(ute,)f(since)g(the)g
Fe(Queue)38 b Ff(represen)n(tations)32 b(are)g(hid-)-152
4830 y(den.)78 b(W)-6 b(e)40 b(are)g(also)i(assuming)e(that)g(op)r
(erations)h(on)f Fe(di\013er)l(ent)-152 4913 y Ff(queues)19
b(comm)n(ute,)f(since)h(there)g(is)g(no)g(sharing)h(b)r(et)n(w)n(een)f
(their)f(rep-)-152 4996 y(resen)n(tations.)36 b(Giv)n(en)25
b(these)h(assumptions,)g(w)n(e)g(can)g(ignore)h(other)-152
5079 y(monadic)33 b(op)r(erations)i(and)f(op)r(erations)h(on)e(other)h
(queues)f(when)-152 5162 y(w)n(e)26 b(reason)f(ab)r(out)g(the)g(queue)f
(of)h(in)n(terest.)35 b(Since)25 b(the)f Fe(Queue)31
b Ff(op-)-152 5245 y(erations)36 b(are)f(p)r(olymorphic,)h(w)n(e)e(can)
h(app)r(eal)g(to)f(parametricit)n(y)2040 -69 y(to)i(argue)g(that)g(if)g
(the)f(equations)h(are)h(satis\014ed)f(for)g Fe(Queue)7
b Ff(s)36 b(of)2040 14 y(in)n(tegers,)31 b(they)c(are)j(satis\014ed)f
(at)g(ev)n(ery)f(t)n(yp)r(e.)43 b(It)28 b(is)h(also)h(reason-)2040
97 y(able)i(to)h(restrict)f(our)g(observ)l(ations)h(to)f(the)f(results)
i(from)e Fe(fr)l(ont)8 b Ff(,)2040 180 y(again)27 b(since)f
Fe(Queue)32 b Ff(is)26 b(an)g(abstract)g(data)g(t)n(yp)r(e,)f(and)h
(there)f(is)i(no)2040 263 y(other)h(op)r(erator)i(whic)n(h)e(deliv)n
(ers)h(an)n(y)f(other)g(t)n(yp)r(e)g(of)h(v)l(alue)f(from)2040
346 y(it.)33 b(Th)n(us,)21 b(if)g(t)n(w)n(o)f(program)g(fragmen)n(ts)g
(are)h(op)r(erationally)h(equiv)l(a-)2040 429 y(len)n(t)g(when)h(w)n(e)
g(restrict)g(our)g(atten)n(tion)f(to)h(queue)f(programs,)h(then)2040
512 y(they)i(should)h(b)r(e)f(equiv)l(alen)n(t)g(in)h(Hask)n(ell)g
(also.)2152 596 y(No)n(w)51 b(w)n(e)g(just)g(program)f(op)r(erational)i
(equiv)l(alence)e(using)2040 679 y Fg(QuickCheck)p Ff(.)40
b(W)-6 b(e)28 b(m)n(ust)e(de\014ne)i(queue)f(programs:)39
b(they)28 b(consist)2040 762 y(of)f(queue)d(creation)j(follo)n(w)n(ed)g
(b)n(y)e(a)h(sequence)f(of)i Fe(A)l(ction)7 b Ff(s.)2206
919 y Fh(data)18 b Fe(A)l(ction)45 b Ff(=)38 b Fe(A)l(dd)25
b(Int)f Fd(j)18 b Fe(R)l(emove)23 b Fd(j)2755 1002 y
Fe(F)-6 b(r)l(ont)25 b Fd(j)18 b Fe(R)l(eturn)24 b Ff(\()p
Fe(Mayb)l(e)g(Int)7 b Ff(\))2755 1085 y Fh(deriving)19
b Ff(\()p Fe(Eq)7 b Fc(;)13 b Fe(Show)8 b Ff(\))2040
1239 y(W)-6 b(e)26 b(will)i(not)e(need)g(to)g(represen)n(t)g(v)l
(ariable)h Fe(names)g Ff(in)g(this)f(exam-)2040 1322
y(ple:)53 b(w)n(e)36 b(just)f(assume)g(that)f(eac)n(h)h
Fe(F)-6 b(r)l(ont)44 b Ff(and)34 b Fe(R)l(eturn)43 b
Ff(binds)34 b(a)2040 1405 y(v)l(ariable,)24 b(and)d(w)n(e)i(shall)g
(observ)n(e)f(the)g(sequence)f(of)i(v)l(alues)f(b)r(ound.)2040
1488 y(W)-6 b(e)21 b(de\014ne)f(the)g(seman)n(tics)h(of)h(action)g
(sequences)f(via)g(the)f(function)2040 1571 y Fe(p)l(erform)7
b Ff(.)2206 1729 y Fe(p)l(erform)358 b Ff(::)2283 1812
y Fe(Queue)32 b(a)g(Int)c Fd(!)21 b Ff([)p Fe(A)l(ction)6
b Ff(])23 b Fd(!)e Fe(ST)35 b(a)d Ff([)p Fe(Mayb)l(e)h(Int)7
b Ff(])2206 1895 y Fe(p)l(erform)24 b(q)g Ff([])225 b(=)21
b Fe(r)l(eturn)k Ff([])2206 1978 y Fe(p)l(erform)f(q)g
Ff(\()p Fe(a)j Ff(:)22 b Fe(as)6 b Ff(\))22 b(=)2300
2061 y Fh(case)17 b Fe(a)23 b Fh(of)2377 2144 y Fe(A)l(dd)i(n)119
b Fd(!)p Fe(add)25 b(n)e(q)33 b Fc(>)-38 b(>)24 b Fe(p)l(erform)g(q)g
(as)2377 2227 y(R)l(emove)59 b Fd(!)p Fe(r)l(emove)24
b(q)32 b Fc(>)-38 b(>)25 b Fe(p)l(erform)f(q)g(as)2377
2310 y(F)-6 b(r)l(ont)139 b Fd(!)p Fe(liftM)12 b Ff(2)k(\(:\))h(\()p
Fe(fr)l(ont)25 b(q)7 b Ff(\))17 b(\()p Fe(p)l(erform)23
b(q)h(as)6 b Ff(\))2377 2393 y Fe(R)l(eturn)24 b(x)31
b Fd(!)p Fe(liftM)d Ff(\()p Fe(x)i Ff(:\))18 b(\()p Fe(p)l(erform)23
b(q)h(as)6 b Ff(\))2152 2547 y(W)-6 b(e)28 b(shall)i(need)e(to)h(quan)n
(tify)f(o)n(v)n(er)g(actions,)j(or)e(more)f(sp)r(eci\014-)2040
2630 y(cally)g(o)n(v)n(er)e Fe(wel)t(l-forme)l(d)j(action)g(se)l(quenc)
l(es)p Ff(.)41 b(W)-6 b(e)26 b(m)n(ust)g(therefore)2040
2713 y(de\014ne)i(a)i(test-data)e(generator)i(for)g(these.)45
b(W)-6 b(e)28 b(de\014ne)g Fe(actions)d(n)2040 2796 y
Ff(as)g(the)f(set)g(of)h(action)g(sequences)f(whic)n(h)g(are)h(w)n
(ell-formed)g Fe(after)i(n)2040 2879 y(add)34 b(op)l(er)l(ations)p
Ff(,)27 b(that)d(is,)h(for)g(queues)e(already)i(con)n(taining)f
Fe(n)30 b Ff(ele-)2040 2962 y(men)n(ts.)i(A)20 b Fe(R)l(emove)28
b Ff(is)21 b(only)g(p)r(ossible)h(if)g(the)f(queue)f(is)h(non-empt)n(y)
-6 b(.)2206 3202 y Fe(actions)103 b Ff(::)31 b Fe(Num)23
b(a)44 b Fd(\))38 b Fe(a)45 b Fd(!)38 b Fe(Gen)24 b Ff([)p
Fe(A)l(ction)6 b Ff(])2206 3285 y Fe(actions)24 b(n)k
Ff(=)2283 3368 y Fe(one)l(of)33 b Ff(\([)p Fe(r)l(eturn)25
b Ff([])p Fc(;)2543 3451 y Fe(liftM)12 b Ff(2)17 b(\(:\))g(\()p
Fe(liftM)28 b(A)l(dd)d(arbitr)l(ary)7 b Ff(\))2870 3534
y(\()p Fe(actions)24 b Ff(\()p Fe(n)f Ff(+)17 b(1\)\))p
Fc(;)2543 3618 y Fe(liftM)28 b Ff(\()p Fe(F)-6 b(r)l(ont)30
b Ff(:\))17 b(\()p Fe(actions)25 b(n)6 b Ff(\)])17 b(+)-30
b(+)2539 3696 y Fh(if)26 b Fe(n)i Ff(==)21 b(0)c Fh(then)2616
3779 y Ff([])2539 3862 y Fh(else)2616 3945 y Ff([)p Fe(liftM)28
b Ff(\()p Fe(R)l(emove)g Ff(:\))17 b(\()p Fe(actions)24
b Ff(\()p Fe(n)f Fd(\000)17 b Ff(1\)\)]\))2040 4099 y(W)-6
b(e)25 b(also)i(de\014ne)e(a)h(function)2206 4257 y Fe(delta)45
b Ff(::)39 b([)p Fe(A)l(ction)6 b Ff(])40 b Fd(!)e Fe(Int)2040
4415 y Ff(to)g(compute)e(the)h Fe(change)h Ff(in)f(the)g(n)n(um)n(b)r
(er)f(of)i(queue)e(elemen)n(ts)2040 4498 y(wrough)n(t)26
b(b)n(y)f(a)h(sequence)f(of)i Fe(A)l(ction)6 b Ff(s.)2152
4581 y(No)n(w)26 b(for)h(the)f(de\014nition)g(of)h(op)r(erational)g
(equiv)l(alence,)g(whic)n(h)2040 4664 y(follo)n(ws)h(the)d(formal)g
(de\014nition)g(exactly:)34 b(w)n(e)26 b(c)n(ho)r(ose)g(an)f(arbitary)
2040 4747 y(con)n(text)34 b(consisting)i(of)g(a)f(pre\014x)e(and)i
(su\016x)f(of)h(queue)f(actions,)2040 4830 y(taking)29
b(care)h(that)e(the)h(complete)f(program)h(is)g(w)n(ell-formed,)i(and)
2040 4913 y(then)e(c)n(hec)n(k)h(that)f(the)h(observ)l(ations)h(w)n(e)f
(mak)n(e)f(are)h(the)g(same)g(in)2040 4996 y(eac)n(h)c(case.)2206
5153 y(\()2236 5134 y Fd(\030)2236 5158 y Ff(=)2296 5153
y(\))148 b(::)30 b([)p Fe(A)l(ction)6 b Ff(])40 b Fd(!)e
Ff([)p Fe(A)l(ction)6 b Ff(])40 b Fd(!)e Fe(Pr)l(op)l(erty)2206
5236 y(c)2284 5217 y Fd(\030)2284 5241 y Ff(=)2382 5236
y Fe(c)2421 5205 y Fb(0)2465 5236 y Ff(=)1921 5494 y(3)p
eop
%%Page: 4 4
4 3 bop 91 -69 a Fe(forA)n(l)t(l)24 b Ff(\()p Fe(actions)g
Ff(0\))18 b($)f Fc(\025)g Fe(pr)l(ef)55 b Fd(!)91 14
y Fe(forA)n(l)t(l)24 b Ff(\()p Fe(actions)g Ff(\()p Fe(delta)g
Ff(\()p Fe(pr)l(ef)33 b Ff(+)-30 b(+)34 b Fe(c)t Ff(\)\)\))17
b($)g Fc(\025)g Fe(su\013)55 b Fd(!)108 97 y Fh(let)185
180 y Fe(observe)25 b(x)48 b Ff(=)374 263 y Fe(runST)27
b Ff(\()17 b Fh(do)739 346 y Fe(q)45 b Fd( )39 b Fe(empty)739
429 y(p)l(erform)24 b(q)g Ff(\()p Fe(pr)l(ef)50 b Ff(+)-30
b(+)34 b Fe(x)43 b Ff(+)-30 b(+)34 b Fe(su\013)17 b Ff(\)\))108
508 y Fh(in)108 591 y Fe(observe)25 b(c)30 b Ff(=)-13
b(=)25 b Fe(observe)g(c)878 560 y Fb(0)-152 724 y Ff(Equations)19
b(\(3\))f(and)g(\(5\))g(in)g(the)g(sp)r(eci\014cation)i(can)e(no)n(w)g
(b)r(e)g(written)-152 807 y(directly)26 b(as)g Fg(QuickCheck)e
Ff(prop)r(erties.)14 958 y Fe(pr)l(op)p 168 958 24 4
v 34 w(F)-6 b(r)l(ontA)l(dd)26 b(m)d(n)45 b Ff(=)91 1041
y([)p Fe(A)l(dd)26 b(m)6 b Fc(;)30 b Fe(A)l(dd)25 b(n)6
b Fc(;)30 b Fe(F)-6 b(r)l(ont)7 b Ff(])892 1021 y Fd(\030)892
1045 y Ff(=)990 1041 y([)p Fe(A)l(dd)26 b(m)6 b Fc(;)30
b Fe(F)-6 b(r)l(ont)7 b Fc(;)31 b Fe(A)l(dd)26 b(n)6
b Ff(])14 1124 y Fe(pr)l(op)p 168 1124 V 34 w(A)l(ddR)l(emove)24
b(m)e(n)45 b Ff(=)91 1207 y([)p Fe(A)l(dd)26 b(m)6 b
Fc(;)30 b Fe(A)l(dd)25 b(n)6 b Fc(;)30 b Fe(R)l(emove)6
b Ff(])970 1187 y Fd(\030)970 1211 y Ff(=)1068 1207 y([)p
Fe(A)l(dd)26 b(m)6 b Fc(;)30 b Fe(R)l(emove)6 b Fc(;)30
b Fe(A)l(dd)c(n)6 b Ff(])-152 1358 y(The)35 b(other)g(three)f
(equations)h(relate)g(fragmen)n(ts)g(that)f(b)r(egin)h(b)n(y)-152
1441 y(creating)30 b(an)f(empt)n(y)e(queue,)i(and)g(can)g(th)n(us)f
(only)h(app)r(ear)g(at)g(the)-152 1524 y(start)f(of)g(a)g(queue)e
(program.)39 b(W)-6 b(e)27 b(therefore)h(need)f(a)h(sligh)n(tly)g(dif-)
-152 1607 y(feren)n(t)e(notion)g(of)h(op)r(erational)g(equiv)l(alence.)
14 1758 y Fe(c)92 1738 y Fd(\030)92 1762 y Ff(=)152 1726
y Fb(^)236 1758 y Fe(c)275 1726 y Fb(0)336 1758 y Ff(=)91
1841 y Fe(forA)n(l)t(l)d Ff(\()p Fe(actions)g Ff(\()p
Fe(delta)g(c)t Ff(\)\))17 b($)h Fc(\025)e Fe(su\013)55
b Fd(!)220 1924 y Fh(let)297 2007 y Fe(observe)25 b(x)48
b Ff(=)486 2090 y Fe(runST)28 b Ff(\()16 b Fh(do)851
2173 y Fe(q)46 b Fd( )38 b Fe(empty)851 2256 y(p)l(erform)24
b(q)g Ff(\()p Fe(x)i Ff(+)-30 b(+)34 b Fe(su\013)17 b
Ff(\)\))220 2335 y Fh(in)220 2418 y Fe(observe)25 b(c)30
b Ff(=)-13 b(=)25 b Fe(observe)g(c)990 2386 y Fb(0)-152
2546 y Ff(The)h(remaining)g(equations)g(are)g(no)n(w)g(easily)h
(stated.)14 2697 y Fe(pr)l(op)p 168 2697 V 34 w(F)-6
b(r)l(ontEmpty)47 b Ff(=)91 2780 y([)p Fe(F)-6 b(r)l(ont)7
b Ff(])360 2760 y Fd(\030)360 2784 y Ff(=)419 2748 y
Fb(^)503 2780 y Ff([)p Fe(R)l(eturn)25 b(Nothing)7 b
Ff(])14 2863 y Fe(pr)l(op)p 168 2863 V 34 w(F)-6 b(r)l(ontA)l(ddEmpty)
26 b(m)44 b Ff(=)91 2946 y([)p Fe(A)l(dd)26 b(m)6 b Fc(;)30
b Fe(F)-6 b(r)l(ont)7 b Ff(])636 2926 y Fd(\030)636 2950
y Ff(=)696 2914 y Fb(^)780 2946 y Ff([)p Fe(A)l(dd)25
b(m)6 b Fc(;)30 b Fe(R)l(eturn)24 b Ff(\()p Fe(Just)i(m)6
b Ff(\)])14 3029 y Fe(pr)l(op)p 168 3029 V 34 w(A)l(ddR)l(emoveEmpty)25
b(m)45 b Ff(=)91 3112 y([)p Fe(A)l(dd)26 b(m)6 b Fc(;)30
b Fe(R)l(emove)6 b Ff(])714 3092 y Fd(\030)714 3116 y
Ff(=)773 3080 y Fb(^)858 3112 y Ff([])-152 3263 y(The)29
b(prop)r(erties)g(can)f(no)n(w)h(b)r(e)f(c)n(hec)n(k)n(ed)g(b)n(y)f
Fg(QuickCheck)p Ff(.)40 b(As)29 b(ex-)-152 3346 y(p)r(ected,)d(they)f
(all)i(succeed.)-152 3540 y Fh(5)89 b(T)-7 b(esting)29
b(a)h(Mo)r(del-based)g(Sp)r(eci\014cation)i(of)e(Queues)-152
3697 y Ff(In)d(the)g(previous)g(section,)i(w)n(e)f(implemen)n(ted)d(an)
i(algebraic)i(sp)r(ec-)-152 3780 y(i\014cation)f(of)g(queues)e(as)h
Fg(QuickCheck)e Ff(prop)r(erties.)39 b(But)26 b(sp)r(eci\014ca-)-152
3864 y(tions)i(come)g(in)f(other)h(\015a)n(v)n(ours)f(to)r(o.)41
b(In)27 b(this)h(section,)h(w)n(e)f(imple-)-152 3947
y(men)n(t)g(a)i(sp)r(eci\014cation)g(based)f(on)g(an)g
Fe(abstr)l(act)34 b(mo)l(del)29 b Ff(of)h(queues.)-152
4030 y(The)25 b(p)r(opular)h(Z)e(sp)r(eci\014cation)i(language,)h(for)f
(example,)e(is)i(based)-152 4113 y(on)g(suc)n(h)f(mo)r(dels)h([11)q(].)
-40 4196 y(W)-6 b(e)21 b(shall)h(mo)r(del)e(the)g(state)i(of)f(a)g
(queue)f(as)i(a)f(list)g(of)h(the)e(stored)-152 4279
y(elemen)n(ts.)50 b(With)31 b(this)g(mo)r(del,)h(the)e(queue)g(op)r
(erations)i(are)g(v)n(ery)-152 4362 y(easy)24 b(to)g(de\014ne.)33
b(W)-6 b(e)24 b(giv)n(e)f(them)g(names)g(subscripted)g(b)n(y)g
Fe(S)9 b Ff(,)24 b(since)-152 4445 y(they)37 b(will)i(serv)n(e)f(as)g
(sp)r(eci\014cations.)72 b(Note)37 b(that)h(eac)n(h)f(\(except)-152
4528 y Fe(empty)8 b Ff(\))25 b(returns)h(b)r(oth)f(a)h(\\result")h(and)
e(a)h(new)g(queue.)14 4679 y Fe(empty)213 4687 y Fa(S)525
4679 y Ff(=)21 b([])14 4762 y Fe(add)131 4770 y Fa(S)192
4762 y Fe(a)i(q)236 b Ff(=)21 b(\(\(\))p Fc(;)30 b Fe(q)41
b Ff(+)-30 b(+)34 b([)p Fe(a)6 b Ff(]\))14 4845 y Fe(r)l(emove)249
4853 y Fa(S)310 4845 y Ff(\()p 345 4845 V 49 w(:)22 b
Fe(q)7 b Ff(\))21 b(=)g(\(\(\))p Fc(;)30 b Fe(q)7 b Ff(\))14
4928 y Fe(fr)l(ont)173 4936 y Fa(S)234 4928 y Ff([])249
b(=)21 b(\()p Fe(Nothing)7 b Fc(;)31 b Ff([]\))14 5011
y Fe(fr)l(ont)173 5019 y Fa(S)234 5011 y Ff(\()p Fe(a)c
Ff(:)22 b Fe(q)7 b Ff(\))80 b(=)21 b(\()p Fe(Just)k(a)6
b Fc(;)31 b Fe(a)c Ff(:)22 b Fe(q)7 b Ff(\))-40 5162
y(No)n(w,)21 b(to)f(form)n(ulate)f(the)f(correctness)i(of)g(the)f
(implemen)n(tation,)-152 5245 y(w)n(e)40 b(m)n(ust)d(relate)j(the)f
(implemen)n(tation)f(state)h(to)h(the)e(abstract)2040
-69 y(mo)r(del.)62 b(A)34 b(standard)h(w)n(a)n(y)g(to)g(do)f(so)i(is)f
(to)g(de\014ne)f(an)h Fe(abstr)l(ac-)2040 14 y(tion)30
b(function)p Ff(,)g(whic)n(h)f(maps)e(the)h(implemen)n(tation)f(state)i
(to)g(the)2040 97 y(abstract)g(v)l(alue)f(that)h(it)f(represen)n(ts.)43
b(Our)28 b(abstraction)h(function)2040 180 y(m)n(ust,)c(of)h(course,)h
(b)r(e)e(monadic.)2206 330 y Fe(abstr)l(act)31 b Ff(::)22
b Fe(Queue)i(s)f(a)45 b Fd(!)38 b Fe(ST)27 b(s)c Ff([)p
Fe(a)6 b Ff(])2040 479 y(W)-6 b(e)25 b(omit)f(the)h(\(easy\))g
(de\014nition;)g(note)g(only)g(that)g Fe(abstr)l(act)35
b Ff(m)n(ust)2040 562 y(not)26 b Fe(change)h Ff(the)e(implemen)n
(tation)f(state)i(in)g(an)n(y)f(w)n(a)n(y)-6 b(.)2152
645 y(An)59 b(implemen)n(tation)g(is)h Fe(c)l(orr)l(e)l(ct)j
Ff(if)d(it)g Fe(c)l(ommutes)g(with)2040 728 y(abstr)l(act)10
b Ff(:)55 b(that)35 b(is,)40 b(if)c(the)g(answ)n(er)h(deliv)n(ered)e
(is)i(the)e(same)h(an-)2040 811 y(sw)n(er)23 b(that)f(the)g(sp)r
(eci\014cation)i(deliv)n(ers)e(on)h(the)f(abstraction)h(of)g(the)2040
894 y(initial)39 b(state,)j(and)37 b(the)g(\014nal)h(state,)k(when)37
b(abstracted,)42 b(is)c(the)2040 977 y(same)31 b(as)g(the)g(\014nal)g
(state)g(pro)r(duced)f(b)n(y)g(the)h(sp)r(eci\014cation)h(from)2040
1060 y(the)25 b(abstraction)i(of)f(the)g(initial)h(state.)2206
1210 y Fe(c)l(ommutes)215 b Ff(::)31 b Fe(Eq)24 b(a)44
b Fd(\))2283 1293 y Fe(Queue)23 b(s)h(Int)46 b Fd(!)38
b Ff(\()p Fe(Queue)23 b(s)g(Int)46 b Fd(!)38 b Fe(ST)27
b(s)d(a)6 b Ff(\))21 b Fd(!)2395 1376 y Ff(\([)p Fe(Int)7
b Ff(])39 b Fd(!)f Ff(\()p Fe(a)6 b Fc(;)13 b Ff([)p
Fe(Int)7 b Ff(]\)\))40 b Fd(!)e Fe(ST)27 b(s)c(Bo)l(ol)2206
1455 y(c)l(ommutes)i(q)f(a)f(f)37 b Ff(=)h Fh(do)2915
1538 y Fe(old)47 b Fd( )38 b Fe(abstr)l(act)27 b(q)2915
1621 y(x)48 b Fd( )39 b Fe(a)23 b(q)2915 1704 y(new)47
b Fd( )39 b Fe(abstr)l(act)26 b(q)2915 1787 y(r)l(eturn)f
Ff(\(\()p Fe(x)9 b Fc(;)14 b Fe(new)8 b Ff(\))h(=)-13
b(=)25 b Fe(f)32 b(old)8 b Ff(\))2040 1932 y(Of)27 b(course,)h(this)f
(condition)h(m)n(ust)d(hold)i(in)g(all)h(states.)39 b(But)27
b(what)2040 2015 y(do)17 b(w)n(e)h(mean)e(b)n(y)h(\\all)h(states"?)33
b(Certainly)18 b(not)f(all)h(memory)d(states:)2040 2098
y(the)j(references)h(that)e(mak)n(e)g(up)g(a)h(queue)f(represen)n
(tation)h(m)n(ust)e(sat-)2040 2181 y(isfy)27 b(a)f(strong)g(in)n(v)l
(arian)n(t)g(|)f(they)g(m)n(ust)g(b)r(e)h(link)n(ed)f(together)h(in)g
(a)2040 2264 y(linear)c(c)n(hain,)g(without)g(lo)r(ops,)h(the)e(head)g
(no)r(de)g(m)n(ust)f(p)r(oin)n(t)h(at)g(the)2040 2347
y(\014rst)g(and)f(last)i(elemen)n(t)e(no)r(des,)i(and)f(so)g(on.)33
b(T)-6 b(rying)21 b(to)g(generate)g(a)2040 2430 y(random)i(heap)g
(state,)i(with)f(a)g(rats')g(nest)g(of)g(references,)i(and)d(then)2040
2513 y(select)32 b(those)g(that)f(represen)n(t)g(queues,)i(w)n(ould)e
(b)r(e)h(b)r(oth)f(di\016cult)2040 2596 y(and)21 b(hop)r(eless)h(in)f
(practice.)34 b(Let)21 b(us)g(instead)g(quan)n(tify)g(o)n(v)n(er)g
Fe(r)l(e)l(ach-)2040 2679 y(able)33 b(states)p Ff(,)i(that)30
b(is,)k(states)d(whic)n(h)g(can)h(actually)f(b)r(e)g(pro)r(duced)2040
2762 y(b)n(y)20 b(a)g(sequence)g(of)i(queue)d(op)r(erations.)34
b(These)21 b(automatically)g(sat-)2040 2845 y(isfy)29
b(the)f(queue)g(in)n(v)l(arian)n(t,)h(they)f(can)h(b)r(e)f(represen)n
(ted)g(naturally)2040 2928 y(b)n(y)i(the)h(sequence)g(of)h(op)r
(erations)g(whic)n(h)f(constructs)g(them,)h(and)2040
3011 y(they)23 b(are)h(the)g(only)f(states)i(of)f(in)n(terest)g(an)n
(yw)n(a)n(y!)34 b(F)-6 b(ortunately)g(,)23 b(w)n(e)2040
3094 y(ha)n(v)n(e)28 b(already)h(de\014ned)e(a)i(generator)g(for)h(w)n
(ell-formed)f(sequences)2040 3178 y(of)22 b(queue)f(op)r(erations)i(in)
e(the)g(previous)g(section,)j(so)e(no)n(w)g(it)f(is)h(easy)2040
3261 y(to)k(de\014ne)g(when)f(an)h(op)r(eration)h(correctly)g(implemen)
n(ts)d(a)j(sp)r(eci\014-)2040 3344 y(cation.)2206 3493
y Fe(implements)198 b Ff(::)30 b Fe(Eq)24 b(a)45 b Fd(\))2283
3576 y Ff(\()p Fd(8)17 b Fe(s)6 b Fc(:)17 b Fe(Queue)24
b(s)f(Int)46 b Fd(!)38 b Fe(ST)27 b(s)d(a)6 b Ff(\))38
b Fd(!)2395 3659 y Ff(\([)p Fe(Int)7 b Ff(])39 b Fd(!)f
Ff(\()p Fe(a)6 b Fc(;)13 b Ff([)p Fe(Int)7 b Ff(]\)\))40
b Fd(!)e Fe(Pr)l(op)l(erty)2206 3738 y(a)23 b Ff(`)p
Fe(implements)6 b Ff(`)18 b Fe(f)37 b Ff(=)2283 3821
y Fe(forA)n(l)t(l)24 b Ff(\()p Fe(actions)g Ff(0\))17
b($)h Fc(\025)f Fe(as)45 b Fd(!)2395 3904 y Fe(runST)28
b Ff(\()16 b Fh(do)2760 3987 y Fe(q)46 b Fd( )38 b Fe(empty)2760
4070 y(p)l(erform)24 b(q)g(as)2760 4153 y(c)l(ommutes)h(q)f(a)f(f)15
b Ff(\))2040 4298 y(The)22 b(correctness)i(prop)r(erties)e(for)h
Fe(add)31 b Ff(and)21 b Fe(fr)l(ont)30 b Ff(are)23 b(no)n(w)f(direct.)
2206 4531 y Fe(pr)l(op)p 2360 4531 V 34 w(A)l(dd)j(n)44
b Ff(=)38 b Fe(add)26 b(n)d Ff(`)p Fe(implements)6 b
Ff(`)18 b Fe(add)3496 4539 y Fa(S)3556 4531 y Fe(n)2206
4614 y(pr)l(op)p 2360 4614 V 34 w(F)-6 b(r)l(ont)46 b
Ff(=)39 b Fe(fr)l(ont)24 b Ff(`)p Fe(implements)6 b Ff(`)19
b Fe(fr)l(ont)3496 4622 y Fa(S)2040 4763 y Ff(The)h Fe(empty)27
b Ff(op)r(eration)20 b(do)r(es)g(not)f(quite)g(\014t)g(this)h(framew)n
(ork,)h(since)2040 4846 y(it)f Fe(cr)l(e)l(ates)h Ff(a)f(queue)f
(rather)g(than)g(mo)r(difying)g(an)g(existing)h(one.)33
b(W)-6 b(e)2040 4929 y(cannot)32 b(reuse)g Fe(implements)6
b Ff(,)34 b(but)c(of)j(course)f(it)g(is)g(correct)h(if)f(the)2040
5012 y(represen)n(tation)23 b(it)f(constructs)g(abstracts)h(to)g(the)e
(empt)n(y)f(queue)i(in)2040 5095 y(the)j(sp)r(eci\014cation.)2206
5245 y Fe(pr)l(op)p 2360 5245 V 34 w(Empty)45 b Ff(=)1921
5494 y(4)p eop
%%Page: 5 5
5 4 bop 91 -69 a Fe(runST)28 b Ff(\()17 b Fh(do)456 14
y Fe(q)46 b Fd( )38 b Fe(empty)456 97 y(q)498 66 y Fb(0)559
97 y Fd( )g Fe(abstr)l(act)27 b(q)456 180 y(r)l(eturn)e
Ff(\()p Fe(q)757 149 y Fb(0)788 180 y Ff(=)-13 b(=)25
b(\()p Fe(empty)1149 188 y Fa(S)1214 180 y Ff(::)d([)p
Fe(Int)7 b Ff(]\)\)\))-152 334 y(Finally)-6 b(,)30 b(the)e
Fe(r)l(emove)36 b Ff(op)r(eration)29 b(do)r(es)g(not)g(quite)f(\014t)g
(either,)h(b)r(e-)-152 417 y(cause)g(it)g(has)g(a)f(precondition:)41
b(it)28 b(can)h(only)f(b)r(e)g(applied)h(to)g(non-)-152
500 y(empt)n(y)21 b(queues.)33 b(Th)n(us)22 b(w)n(e)h(need)g(a)g(v)n
(ersion)f(of)i Fe(implements)29 b Ff(whic)n(h)-152 583
y(quan)n(ti\014es)c(o)n(v)n(er)h(states)g(satisfying)h(a)f
(precondition.)14 741 y Fe(implementsIf)54 b Ff(::)39
b Fe(Eq)24 b(a)45 b Fd(\))91 824 y Ff(\()p Fd(8)17 b
Fe(s)6 b Fc(:)18 b Fe(Queue)23 b(s)h(Int)45 b Fd(!)38
b Fe(ST)27 b(s)d(Bo)l(ol)8 b Ff(\))38 b Fd(!)91 907 y
Ff(\()p Fd(8)17 b Fe(s)6 b Fc(:)18 b Fe(Queue)23 b(s)h(Int)45
b Fd(!)38 b Fe(ST)27 b(s)d(a)6 b Ff(\))38 b Fd(!)91 990
y Ff(\([)p Fe(Int)7 b Ff(])39 b Fd(!)g Ff(\()p Fe(a)6
b Fc(;)13 b Ff([)p Fe(Int)7 b Ff(]\)\))39 b Fd(!)280
1073 y Fe(Pr)l(op)l(erty)14 1148 y(implementsIf)33 b(pr)l(e)23
b(a)h(f)53 b Ff(=)91 1231 y Fe(forA)n(l)t(l)24 b Ff(\()p
Fe(actions)g Ff(0\))18 b($)f Fc(\025)g Fe(as)45 b Fd(!)203
1314 y Fe(runST)28 b Ff(\()17 b Fh(do)569 1397 y Fe(q)45
b Fd( )38 b Fe(empty)569 1480 y(p)l(erform)23 b(q)h(as)569
1563 y(pr)l(e)f(q)7 b Ff(\))38 b(=)-13 b Fd(\))203 1646
y Fe(runST)28 b Ff(\()17 b Fh(do)569 1729 y Fe(q)45 b
Fd( )38 b Fe(empty)569 1812 y(p)l(erform)23 b(q)h(as)569
1895 y(c)l(ommutes)g(q)g(a)f(f)16 b Ff(\))-152 2048 y(No)n(w)26
b(w)n(e)g(can)g(complete)f(our)h(sp)r(eci\014cation:)14
2206 y Fe(pr)l(op)p 168 2206 24 4 v 34 w(R)l(emove)45
b Ff(=)91 2289 y Fe(implementsIf)33 b Ff(\()p Fe(liftM)27
b(isJust)43 b Fd(\016)34 b Fe(fr)l(ont)7 b Ff(\))18 b
Fe(r)l(emove)24 b(r)l(emove)1790 2297 y Fa(S)-40 2447
y Ff(Once)i(again,)h(all)f(prop)r(erties)h(succeed.)-152
2643 y Fh(6)89 b(Lessons)29 b(from)h(the)f Fe(Queue)36
b Fh(Example)-152 2800 y Ff(W)-6 b(e)21 b(ha)n(v)n(e)g(sho)n(wn)g(ho)n
(w)h(to)f(represen)n(t)g(t)n(w)n(o)h(p)r(opular)f(kinds)g(of)h(sp)r
(eci-)-152 2883 y(\014cation)c(as)g Fg(QuickCheck)d Ff(prop)r(erties,)
20 b(and)d(th)n(us)g(use)g(them)f(directly)-152 2966
y(for)21 b(testing.)32 b(The)20 b(k)n(ey)f(idea)g(for)i(coping)f(with)f
(the)g(monadic)g(nature)-152 3049 y(of)27 b(the)f(implemen)n(tation)e
(w)n(as)j(to)g(de\014ne)e(a)h(\\queue)g(program)g(lan-)-152
3132 y(guage",)c(represen)n(ted)c(as)i(a)f(Hask)n(ell)g(datat)n(yp)r
(e,)h(and)e(quan)n(tify)g(o)n(v)n(er)-152 3215 y(con)n(texts.)63
b(This)36 b(enabled)f(us)g(to)g(implemen)n(t)e(directly)i(the)g(def-)
-152 3298 y(inition)f(of)g(op)r(erational)h(equiv)l(alence)e(for)h
(testing)f(the)g(algebraic)-152 3381 y(sp)r(eci\014cation,)40
b(and)c(to)g(generate)h(random)e(reac)n(hable)i(states)g(to)-152
3464 y(test)26 b(the)f(mo)r(del-based)g(one.)-40 3547
y(The)31 b(reader)g(ma)n(y)e(w)n(onder)h(wh)n(y)g(w)n(e)h(did)f(not)g
(represen)n(t)g(pro-)-152 3630 y(gram)h(fragmen)n(ts)f(as)h(monadic)f
(v)l(alues)h(|)f(as)h(seman)n(tics,)h(rather)-152 3713
y(than)22 b(abstract)h(syn)n(tax.)33 b(In)22 b(principle)g(this)h(ma)n
(y)e(seem)h(attractiv)n(e,)-152 3796 y(but)j(there)h(are)g(ma)t(jor)g
(adv)l(an)n(tages)g(in)g(using)f(a)h(datat)n(yp)r(e.)-66
3939 y Fd(\017)42 b Ff(When)31 b(tests)g(fail,)j(the)c(v)l(alues)h(of)h
(quan)n(ti\014ed)e(v)l(ariables)h(are)14 4022 y(displa)n(y)n(ed.)i(If)
21 b(w)n(e)g(quan)n(tify)f(o)n(v)n(er)h(con)n(texts,)h(then)e(w)n(e)h
(see)g(the)14 4105 y(abstract)33 b(syn)n(tax)f(tree,)j(whic)n(h)d(is,)j
(of)e(course,)i(v)n(ery)d(useful.)14 4188 y(The)g(seman)n(tics)g(of)h
(a)f(con)n(text)f(is)h(a)h(function,)g(ho)n(w)n(ev)n(er:)47
b(if)14 4271 y(w)n(e)33 b(quan)n(ti\014ed)e(o)n(v)n(er)h(this)g
(instead)h(then)e(w)n(e)i(w)n(ould)f(see)h(no)14 4354
y(useful)27 b(information)f(on)f(a)h(test)g(failure.)-66
4497 y Fd(\017)42 b Ff(As)34 b(w)n(ell)g(as)g(running)f(program)g
(fragmen)n(ts,)j(w)n(e)e(ma)n(y)e(wish)14 4580 y(to)26
b(compute)e(some)h(of)g(their)h(prop)r(erties)f(b)n(y)g
Fe(static)j(analysis)p Ff(,)14 4663 y(whic)n(h)20 b(requires)g(an)g
(abstract)h(syn)n(tax)d(tree.)33 b(A)20 b(simple)f(exam-)14
4746 y(ple)28 b(of)h(this)f(is)g(the)g Fe(delta)34 b
Ff(function,)29 b(used)e(ab)r(o)n(v)n(e)h(to)g(predict)14
4829 y(the)33 b(c)n(hanges)h(in)g(the)f(n)n(um)n(b)r(er)e(of)j(elemen)n
(ts)f(in)g(the)g(queue,)14 4912 y(when)26 b(a)g(queue)f(program)g
(fragmen)n(t)h(is)g(run.)-66 5054 y Fd(\017)42 b Ff(When)18
b(w)n(e)g(test)g(co)r(de)g(using)h(the)e Fe(ST)28 b Ff(monad,)19
b(then)e(computa-)14 5137 y(tions)23 b(ha)n(v)n(e)f(p)r(olymorphic)g(t)
n(yp)r(es,)g(and)g(functions)h(o)n(v)n(er)f(them)14 5220
y(m)n(ust)h(ha)n(v)n(e)h(rank-2)g(t)n(yp)r(es.)33 b(Examples)24
b(are)h(the)e Fe(implements)2206 -69 y Ff(and)41 b Fe(implementsIf)57
b Ff(functions)41 b(in)g(the)g(previous)g(section.)2206
14 y(These)26 b(t)n(yp)r(es)e(can)h(b)r(e)g(quite)f(complex,)h(and)g
(moreo)n(v)n(er)f(m)n(ust)2206 97 y(alw)n(a)n(ys)g(b)r(e)e(stated)h
(explicitly)-6 b(.)33 b(By)22 b(passing)h(abstract)g(syn)n(tax)2206
180 y(trees)h(instead,)h(w)n(e)f(a)n(v)n(oid)g(the)f(need)h(for)g(most)
f(rank-2)h(t)n(yp)r(es.)2152 323 y(Indeed,)41 b(there)d(is)h(an)f(ev)n
(en)g(more)g(sev)n(ere)g(problem.)72 b(If)38 b(w)n(e)2040
406 y(w)n(ere)32 b(to)f(quan)n(tify)f(o)n(v)n(er)h(the)f(seman)n(tics)h
(of)h(con)n(texts)e(in)h(the)g Fe(ST)2040 489 y Ff(monad,)26
b(b)n(y)f(writing)i Fe(forA)n(l)t(l)d(c)l(ontexts)6 b
Ff(\()p Fc(\025)20 b Fe(c)43 b Fd(!)38 b Fc(:)13 b(:)g(:)p
Ff(\),)27 b(then)e(since)i Fe(c)2040 572 y Ff(m)n(ust)e(ha)n(v)n(e)i(a)
g(p)r(olymorphic)e(t)n(yp)r(e,)i(the)f Fc(\025)p Ff(-expression)h(m)n
(ust)e(ha)n(v)n(e)2040 655 y(a)h(rank-2)f(t)n(yp)r(e,)g(and)g
Fe(forA)n(l)t(l)32 b Ff(m)n(ust)25 b(b)r(e)g(used)g(at)h(an)f(instance)
h(with)2040 738 y(a)33 b(rank-3)e(t)n(yp)r(e!)53 b(This)33
b(go)r(es)h(b)r(ey)n(ond)d(what)h(to)r(da)n(y's)h(implemen-)2040
821 y(tations)k(can)g(supp)r(ort:)56 b(Hugs)36 b(allo)n(ws)j(only)d
(rank-2)g(t)n(yp)r(es,)j(and)2040 904 y(although)32 b(GHC)g(no)n(w)g
(supp)r(orts)f(rank-)p Fe(k)39 b Ff(t)n(yp)r(es)31 b(\(using)h(Odersky)
2040 987 y(and)26 b(L\177)-38 b(aufer's)27 b(w)n(ork)g([20)q(]\),)g
(the)f(t)n(yp)r(e)f(system)g(is)i(still)g Fe(pr)l(e)l(dic)l(ative)p
Ff(,)2040 1070 y(whic)n(h)j(means)f(that)g(t)n(yp)r(e)f(v)l(ariables)j
(cannot)e(b)r(e)h(instan)n(tiated)f(to)2040 1153 y(an)n(ything)35
b(other)h(than)g(monot)n(yp)r(es.)64 b(T)-6 b(o)37 b(quan)n(tify)e(o)n
(v)n(er)h(v)l(alues)2040 1236 y(in)n(v)n(olving)f(the)f
Fe(ST)45 b Ff(monad,)36 b(w)n(e)g(w)n(ould)f(need)f(to)h(de\014ne)g(a)g
(sp)r(e-)2040 1319 y(cial)27 b(v)n(ersion)f(of)g Fe(forA)n(l)t(l)7
b Ff(,)26 b(with)g(an)g(explicitly)g(stated)g(rank-3)f(t)n(yp)r(e.)2040
1402 y(Moreo)n(v)n(er,)38 b(w)n(e)d(w)n(ould)g(need)g(a)g
Fe(di\013er)l(ent)h Ff(v)n(ersion)f(of)g Fe(forA)n(l)t(l)42
b Ff(for)2040 1486 y(eac)n(h)27 b(t)n(yp)r(e)f(of)h(v)l(alue)f(quan)n
(ti\014ed)g(o)n(v)n(er,)h(so)g(these)f(v)n(ersions)i(cannot)2040
1569 y(reasonably)i(b)r(e)f(placed)g(in)g(the)g Fg(QuickCheck)e
Ff(library;)32 b(they)c(m)n(ust)2040 1652 y(b)r(e)20
b(de\014ned)f(b)n(y)g(the)g Fe(user)i Ff(of)g Fg(QuickCheck)p
Ff(,)f(whic)n(h)g(is)g(unacceptable.)2040 1735 y(Th)n(us)g(represen)n
(ting)h(con)n(texts)f(b)n(y)f(abstract)i(syn)n(tax)f(is)h(essen)n(tial)
g(to)2040 1818 y(making)k(our)h(approac)n(h)g(w)n(ork)f(at)h(all.)2152
1901 y(So)36 b(far,)k(w)n(e)d(ha)n(v)n(e)e(used)h(only)g
Fg(QuickCheck)e Ff(as)i(describ)r(ed)h(in)2040 1984 y(our)f(original)i
(pap)r(er)f([4],)j(and)c(it)g(has)h(w)n(ork)n(ed)f(prett)n(y)f(w)n
(ell;)43 b(w)n(e)2040 2067 y(ha)n(v)n(e)37 b(needed)f
Fe(no)i Ff(extensions)f(sp)r(eci\014c)h(to)f(monads.)68
b(Ho)n(w)n(ev)n(er,)2040 2150 y(the)28 b(sho)r(e)g(do)r(es)g(pinc)n(h)f
(a)i(little.)41 b(Lo)r(ok)29 b(bac)n(k)e(at)h(the)f(de\014nition)h(of)
2040 2233 y Fe(implementsIf)36 b Ff(\(for)20 b(testing)h(an)f(op)r
(eration)h(with)g(a)f(precondition\):)2040 2316 y(in)33
b(order)f(to)h(c)n(hec)n(k)f(that)g(the)h(state)g(generated)g(b)n(y)e
(the)h(random)2040 2399 y(con)n(text)f(satis\014es)j(the)d
(precondition,)j(w)n(e)f(had)e(to)h(run)g(the)f(co)r(de)2040
2482 y(generating)c(it)f(t)n(wice!)35 b(W)-6 b(e)25 b(cannot)h(write,)h
(for)f(example,)2206 2640 y Fe(pr)l(e)e(q)45 b Ff(=)-13
b Fd(\))38 b Fe(c)l(ommutes)25 b(q)f(a)f(f)2040 2797
y Ff(inside)g(a)f(single)h(call)h(of)f Fe(runST)10 b
Ff(,)23 b(b)r(ecause)g(=)-13 b Fd(\))22 b Ff(is)g(a)h
Fe(pr)l(op)l(erty)i Ff(com-)2040 2880 y(binator,)31 b(and)e(has)g(the)g
(wrong)h(t)n(yp)r(e)f(to)g(app)r(ear)h(in)f(an)g Fe(ST)40
b Ff(com-)2040 2963 y(putation.)34 b(W)-6 b(e)26 b(cannot)f(either)h
(write)2206 3121 y Fe(b)44 b Fd( )38 b Fe(pr)l(e)23 b(q)2223
3204 y Fh(if)j Fe(b)c Fh(then)2300 3287 y Fe(c)l(ommutes)i(q)g(a)g(f)
2223 3370 y Fh(else)2300 3453 y Fe(r)l(eturn)h(T)-6 b(rue)2040
3588 y Ff(b)r(ecause)37 b(this)g(has)g(a)g(di\013eren)n(t)f(meaning:)56
b(it)37 b(coun)n(ts)g(a)g(test)g(in)2040 3671 y(whic)n(h)31
b(the)f(precondition)h(is)h(not)e(satis\014ed)i(as)f(a)g
Fe(suc)l(c)l(essful)j(test)p Ff(,)2040 3754 y(whic)n(h)26
b(is)g(not)g(what)g(w)n(e)g(w)n(an)n(t)f(at)h(all!)2152
3837 y(The)36 b(problem)e(is)i(that)f(w)n(e)h(cannot)g(use)f
Fe(pr)l(op)l(erty)k(op)l(er)l(ators)2040 3920 y Ff(in)29
b(the)g(midst)f(of)i(a)f(monadic)g(computation)f(|)h(and)g(sometimes,)
2040 4003 y(that)d(is)h(exactly)g(what)f(w)n(e)h(w)n(an)n(t)g(to)g(do.)
36 b(Other)26 b(examples)g(w)n(ould)2040 4086 y(b)r(e)45
b(quan)n(tifying)g(o)n(v)n(er)g(the)g(elemen)n(ts)f(of)i(a)g(list)g
(pro)r(duced)f(b)n(y)2040 4169 y(a)36 b(monadic)g(computation,)i(or)e
(collecting)h(v)l(alues)f(generated)h(in)2040 4252 y(monadic)31
b(co)r(de.)53 b(This)32 b(motiv)l(ates)f(extending)g
Fg(QuickCheck)e Ff(with)2040 4335 y(a)k(language)g(of)g
Fe(monadic)h(pr)l(op)l(erties)p Ff(:)49 b(the)32 b(sub)t(ject)h(of)g
(the)e(next)2040 4418 y(section.)2040 4614 y Fh(7)89
b(A)29 b(Language)h(of)f(Monadic)i(Sp)r(eci\014cations)2040
4771 y Ff(Our)26 b(goal)i(is)f(to)g(extend)e Fg(QuickCheck)f
Ff(with)j(a)g(new)f(kind)g(of)h(prop-)2040 4854 y(ert)n(y)-6
b(,)40 b(whic)n(h)d(can)g(con)n(tain)h(monadic)e(computations)h(in)g
(an)h(un-)2040 4937 y(derlying)31 b(monad)g Fe(m)6 b
Ff(.)51 b(W)-6 b(e)31 b(therefore)h(de\014ne)e(a)i Fe(pr)l(op)l(erty)j
(monad)2040 5020 y(Pr)l(op)l(ertyM)c(m)23 b(a)6 b Ff(,)43
b(whose)e(elemen)n(ts)d(ma)n(y)h(mix)f(prop)r(ert)n(y)h(op)r(er-)2040
5103 y(ations)e(and)g Fe(m)6 b Ff(-computations.)66 b(This)37
b(is)g(really)g(just)g(a)g(monad)2040 5186 y(transformer)26
b([16)q(],)g(whose)h(lifting)g(op)r(eration)g(w)n(e)f(call)1921
5494 y(5)p eop
%%Page: 6 6
6 5 bop 14 -69 a Fe(run)45 b Ff(::)39 b Fe(Monad)26 b(m)44
b Fd(\))38 b Fe(m)23 b(a)44 b Fd(!)38 b Fe(Pr)l(op)l(ertyM)31
b(m)23 b(a)-152 88 y Ff(Non-monadic)j(prop)r(erties)i(can)f(b)r(e)g(em)
n(b)r(edded)e(in)i(monadic)f(ones)-152 171 y(using)14
327 y Fe(assert)48 b Ff(::)39 b(\()p Fe(Monad)25 b(m)6
b Fc(;)30 b Fe(T)-6 b(estable)24 b(a)6 b Ff(\))38 b Fd(\))91
410 y Fe(a)45 b Fd(!)38 b Fe(Pr)l(op)l(ertyM)31 b(m)23
b Ff(\(\))-152 566 y(\(where)h Fe(T)-6 b(estable)30 b
Ff(t)n(yp)r(es)23 b(are)h(those)f(corresp)r(onding)i(to)e(prop)r
(erties)-152 649 y(in)34 b(v)l(anilla)f Fg(QuickCheck)p
Ff(\).)56 b(An)32 b(assertion)j(m)n(ust)d(hold)h(when)g(the)-152
732 y(monadic)25 b(prop)r(ert)n(y)g(is)i(tested.)-40
815 y(Preconditions)e(can)f(b)r(e)g(included)g(in)f(monadic)h(prop)r
(erties)g(us-)-152 898 y(ing)14 1055 y Fe(pr)l(e)45 b
Ff(::)39 b Fe(Monad)26 b(m)44 b Fd(\))38 b Fe(Bo)l(ol)46
b Fd(!)38 b Fe(Pr)l(op)l(ertyM)31 b(m)23 b Ff(\(\))-152
1211 y(T)-6 b(est)26 b(cases)h(in)f(whic)n(h)f(preconditions)i(fail)g
(are)f(discarded.)-40 1294 y(Using)j(these)f(op)r(erations,)i(w)n(e)e
(can)h(represen)n(t)f(a)g(Hoare)g(triple)-152 1377 y
Fd(f)p Fe(p)5 b Fd(g)p Fe(x)32 b Fd( )21 b Fe(e)6 b Fd(f)p
Fe(q)h Fd(g)26 b Ff(as)14 1533 y Fe(pr)l(e)e(p)14 1616
y(x)48 b Fd( )38 b Fe(run)24 b(e)14 1699 y(assert)j(q)-152
1855 y Ff(W)-6 b(e)23 b(can)h(also)h(think)d(of)j Fe(run)30
b Ff(as)24 b(a)g(monadic)f Fe(we)l(akest)k(pr)l(e)l(c)l(ondition)-152
1939 y Ff(op)r(erator:)36 b(w)n(e)26 b(could)g(de\014ne)14
2095 y Fe(wp)181 b Ff(::)31 b Fe(Monad)25 b(m)44 b Fd(\))91
2178 y Fe(m)23 b(a)44 b Fd(!)39 b Ff(\()p Fe(a)44 b Fd(!)38
b Fe(Pr)l(op)l(ertyM)31 b(m)23 b(b)5 b Ff(\))38 b Fd(!)g
Fe(Pr)l(op)l(ertyM)31 b(m)23 b(b)14 2261 y(wp)f(m)h(k)30
b Ff(=)21 b Fe(run)i(m)32 b Fc(>)-38 b(>)-26 b Ff(=)24
b Fe(k)-152 2417 y Ff(and)39 b(represen)n(t)f(the)h(w)n(eak)n(est)g
(precondition)g Fg(wp)p Ff(\()p Fe(x)53 b Fd( )43 b Fe(e)6
b Fc(;)13 b Fe(p)5 b Ff(\))38 b(as)-152 2500 y Fe(wp)22
b(e)h Ff($)18 b Fc(\025)f Fe(x)47 b Fd(!)39 b Fe(p)5
b Ff(.)-40 2583 y(W)-6 b(e)25 b(represen)n(t)g(quan)n(ti\014cation)g
(in)g(monadic)g(prop)r(erties)g(using)14 2822 y Fe(pick)47
b Ff(::)39 b(\()p Fe(Monad)25 b(m)6 b Fc(;)30 b Fe(Show)c(a)6
b Ff(\))38 b Fd(\))91 2905 y Fe(Gen)24 b(a)44 b Fd(!)39
b Fe(Pr)l(op)l(ertyM)31 b(m)22 b(a)-152 3062 y Ff(or,)27
b(for)f(more)f(familiar)i(notation,)14 3218 y Fe(forA)n(l)t(lM)h(gen)c
(k)47 b Ff(=)38 b Fe(pick)25 b(gen)33 b Fc(>)-38 b(>)-26
b Ff(=)24 b Fe(k)-152 3374 y Ff(The)30 b(c)n(hoice)h(b)r(et)n(w)n(een)e
Fe(pick)8 b Ff(/)p Fe(forA)n(l)t(lM)41 b Ff(and)30 b
Fe(run)6 b Ff(/)p Fe(wp)35 b Ff(is)c(a)f(matter)-152
3457 y(of)d(taste:)35 b(the)25 b(latter)i(op)r(erations)f(resem)n(ble)g
(mathematical)f(nota-)-152 3540 y(tion)h(more)g(closely)-6
b(,)27 b(while)g(the)e(former)h(let)h(us)e(tak)n(e)h(adv)l(an)n(tage)g
(of)-152 3623 y(Hask)n(ell's)h Fh(do)f Ff(syn)n(tactic)g(sugar.)-40
3706 y(W)-6 b(e)26 b(can)f(mak)n(e)g(observ)l(ations)h(of)h(test)f
(data)g(using)14 3863 y Fe(monitor)47 b Ff(::)39 b Fe(Monad)26
b(m)44 b Fd(\))91 3946 y Ff(\()p Fe(Pr)l(op)l(erty)j
Fd(!)39 b Fe(Pr)l(op)l(erty)7 b Ff(\))40 b Fd(!)e Fe(Pr)l(op)l(ertyM)31
b(m)23 b Ff(\(\))-152 4102 y(F)-6 b(or)27 b(example,)f
Fe(monitor)f Ff(\()p Fe(c)l(ol)t(le)l(ct)g(e)6 b Ff(\))26
b(collects)i(the)e(distribution)g(of)-152 4185 y(v)l(alues)21
b(of)g Fe(e)6 b Ff(.)32 b(Finally)-6 b(,)22 b(w)n(e)f(can)g(con)n(v)n
(ert)e(monadic)h(prop)r(erties)h(bac)n(k)-152 4268 y(to)27
b(ordinary)f(ones,)i(giv)n(en)e(a)h(\\run)f(function")h(for)g(the)f
(underlying)-152 4351 y(monad,)f(using)14 4507 y Fe(monadic)89
b Ff(::)22 b Fe(Monad)k(m)44 b Fd(\))91 4590 y Ff(\()p
Fe(m)23 b(Pr)l(op)l(erty)47 b Fd(!)38 b Fe(Pr)l(op)l(erty)7
b Ff(\))40 b Fd(!)203 4673 y Fe(Pr)l(op)l(ertyM)31 b(m)23
b Ff(\(\))38 b Fd(!)g Fe(Pr)l(op)l(erty)14 4756 y(imp)l(er)l(ative)28
b Ff(::)22 b(\()p Fd(8)17 b Fe(b)5 b Fc(:)17 b Fe(Pr)l(op)l(ertyM)31
b Ff(\()p Fe(ST)c(b)5 b Ff(\))17 b(\(\)\))38 b Fd(!)g
Fe(Pr)l(op)l(erty)-152 4913 y(imp)l(er)l(ative)31 b Ff(is)26
b(equiv)l(alen)n(t)d(to)i Fe(monadic)c(runST)11 b Ff(,)25
b(except)f(that)g(the)-152 4996 y(latter)h(w)n(ould)g(need)e
(impredicativ)n(e)h(rank-3)g(t)n(yp)r(es)f(and)h(so)h(cannot)-152
5079 y(b)r(e)h(written.)-40 5162 y(Using)f(these)f(op)r(erations,)i(w)n
(e)e(can)g(revisit)h Fe(implementsIf)39 b Ff(and)-152
5245 y(rewrite)27 b(it)f(as)g(follo)n(ws:)2206 -69 y
Fe(implementsIf)33 b(p)22 b(a)h(f)54 b Ff(=)38 b Fe(imp)l(er)l(ative)23
b Ff(\()2283 14 y Fe(forA)n(l)t(lM)28 b Ff(\()p Fe(actions)c
Ff(0\))17 b($)h Fc(\025)f Fe(as)45 b Fd(!)2412 97 y Fh(do)2489
180 y Fe(q)g Fd( )38 b Fe(run)24 b(empty)2489 263 y(run)f
Ff(\()p Fe(p)l(erform)h(q)g(as)6 b Ff(\))2489 346 y Fe(ok)47
b Fd( )38 b Fe(run)24 b Ff(\()p Fe(p)d(q)7 b Ff(\))2489
429 y Fe(pr)l(e)24 b(ok)2489 512 y(b)43 b Fd( )38 b Fe(run)24
b Ff(\()p Fe(c)l(ommutes)g(q)g(a)g(f)15 b Ff(\))2489
596 y Fe(assert)26 b(b)5 b Ff(\))2040 732 y(The)20 b(rep)r(eated)f
(execution)g(needed)g(in)g(the)g(original)i(v)n(ersion)f(to)f(test)2040
815 y(the)25 b(precondition)h(is)h(gone.)2040 1007 y
Fh(8)89 b(Seman)n(tics)29 b(of)h(Monadic)h(Prop)r(erties)2040
1164 y Fg(QuickCheck)k Ff(prop)r(erties)j(enjo)n(y)f(b)r(oth)g(a)h
(computational)f(and)g(a)2040 1247 y(declarativ)n(e)30
b(reading,)g(in)f(whic)n(h)g(generators)h(really)g(denote)f(sets,)2040
1330 y(=)-13 b Fd(\))23 b Ff(is)h(true)e(implication,)j(and)d
Fe(forA)n(l)t(l)30 b Ff(is)24 b(true)f(quan)n(ti\014cation.)33
b(In)2040 1414 y(the)18 b(declarativ)n(e)g(reading,)j(a)d(prop)r(ert)n
(y)f(just)h(denotes)h(a)f(truth)f(v)l(alue)2040 1497
y(\(not)j(necessarily)i(computable\).)32 b(Of)20 b(course,)i
(non-termination)e(in)2040 1580 y(a)27 b(prop)r(ert)n(y)g(ma)n(y)f(mak)
n(e)f(a)j(declarativ)n(e)g(reading)f(imp)r(ossible,)h(but)2040
1663 y(w)n(e)36 b(restrict)h(ourselv)n(es)f(here)g(to)g(terminating)g
(programs)g(whose)2040 1746 y(seman)n(tics)27 b(can)h(b)r(e)f(mo)r
(delled)g(using)h(sets)g(and)f(functions,)h(rather)2040
1829 y(than)36 b(domains)f(and)h(con)n(tin)n(uous)g(functions.)66
b(Ev)n(en)35 b(if)i(there)f(is)2040 1912 y(a)e(mismatc)n(h)d(here,)36
b(the)d(declarativ)n(e)h(reading)g(is)f(the)g(\\in)n(tended)2040
1995 y(seman)n(tics")19 b(whic)n(h)f(our)h(Hask)n(ell)g(implemen)n
(tation)e(appro)n(ximates.)2152 2078 y(But)29 b(what)g(is)g(the)f
(declarativ)n(e)i(reading)f(of)g(a)g(monadic)f(prop-)2040
2161 y(ert)n(y?)49 b(What)30 b(is)i(the)e(logic)i(whic)n(h)f(w)n(e)g
(are)g(trying)g(to)f(represen)n(t?)2040 2244 y(Of)23
b(course,)h(monadic)f(prop)r(erties)g(ma)n(y)f(b)r(e)g(based)h(on)g
Fe(any)g Ff(monad,)2040 2327 y(not)29 b(just)h(the)f(familiar)i(state)e
(one.)46 b(The)30 b(meaning)f(of)h(prop)r(erties)2040
2410 y(when)g(the)h(underlying)e(monad)h(p)r(ermits)g(bac)n(ktrac)n
(king)g(through)2040 2493 y(preconditions,)i(for)e(example,)h(or)f
(concurrency)-6 b(,)30 b(is)h(far)f(from)g(ob-)2040 2576
y(vious.)63 b(In)34 b(this)h(section,)k(w)n(e)c(giv)n(e)h(a)f(formal)h
(seman)n(tics)f(to)g(the)2040 2659 y(monadic)25 b(prop)r(ert)n(y)g
(language)i(whic)n(h)f(answ)n(ers)h(suc)n(h)e(questions.)2152
2742 y(W)-6 b(e)27 b(mo)r(del)h(monadic)f(prop)r(erties)h(o)n(v)n(er)g
(a)g(monad)e Fe(M)39 b Ff(as)29 b Fe(non-)2040 2825 y(empty)40
b(sets)g(of)f(c)l(omputations)h(of)f(the)h(typ)l(e)g(M)29
b(Bo)l(ol)7 b Ff(.)72 b(W)-6 b(e)38 b(use)2040 2908 y(sets)21
b(to)g(mo)r(del)f(quan)n(ti\014cation:)31 b(a)21 b(prop)r(ert)n(y)f
Fe(forA)n(l)t(lM)28 b(s)c(p)h Ff(is)c(mo)r(d-)2040 2991
y(elled)28 b(b)n(y)e(a)i(set)f(constructed)g(from)g Fe(s)6
b Ff(.)40 b(Giv)n(en)27 b(a)h(satisfaction)h(test)2040
3074 y(for)i(the)e(monad,)h Fe(test)2692 3082 y Fa(M)2795
3074 y Ff(::)39 b Fe(M)29 b(Bo)l(ol)g Fd(!)38 b Fe(Bo)l(ol)8
b Ff(,)31 b(a)f(monadic)f(prop-)2040 3157 y(ert)n(y)22
b(is)h(satis\014ed)f(if)h Fe(every)j(c)l(omputation)g(in)e(the)i(set)f
(delivers)g(T)-6 b(rue)2040 3240 y(when)31 b(it)f(is)h(teste)l(d)p
Ff(.)46 b(Di\013eren)n(t)28 b(c)n(hoices)i(for)g Fe(test)3478
3248 y Fa(M)3572 3240 y Ff(lead)f(to)g(di\013er-)2040
3323 y(en)n(t)24 b(in)n(terpretations)i(of)f(prop)r(erties)h(|)e(for)i
(example,)f(if)g Fe(M)37 b Ff(is)25 b(the)2040 3406 y(list)30
b(monad)e(\(represen)n(ting)h(bac)n(ktrac)n(king)g(computations\),)g
(then)2040 3489 y Fe(test)2156 3497 y Fa(M)2249 3489
y Ff(migh)n(t)e(require)h(that)f Fe(al)t(l)h Ff(p)r(ossible)h(results)f
(are)h Fe(T)-6 b(rue)6 b Ff(,)29 b(that)2040 3572 y Fe(the)34
b(\014rst)f Ff(result)f(is)g Fe(T)-6 b(rue)6 b Ff(,)33
b(or)f(that)g Fe(some)g Ff(result)g(is)g Fe(T)-6 b(rue)6
b Ff(.)52 b(If)32 b Fe(M)2040 3655 y Ff(is)24 b(the)g
Fe(Mayb)l(e)30 b Ff(monad,)24 b(then)f Fe(test)3048 3663
y Fa(M)3136 3655 y Ff(migh)n(t)g(in)n(terpret)h Fe(Nothing)31
b Ff(as)2040 3738 y Fe(T)-6 b(rue)31 b Ff(\(testing)25
b(for)g Fe(p)l(artial)i(c)l(orr)l(e)l(ctness)p Ff(\))g(or)e
Fe(F)-6 b(alse)31 b Ff(\()p Fe(total)c(c)l(orr)l(e)l(ct-)2040
3821 y(ness)p Ff(\).)36 b(W)-6 b(e)25 b(require)g(only)h(that)f
Fe(test)3108 3829 y Fa(M)3190 3821 y Ff(\()p Fe(r)l(eturn)g(b)5
b Ff(\))38 b(=)g Fe(b)5 b Ff(.)2152 3904 y(No)n(w,)25
b(without)f(loss)i(of)f(generalit)n(y)-6 b(,)25 b(w)n(e)f(can)g(assume)
g(\(b)r(ecause)2040 3987 y(of)c(their)f(t)n(yp)r(e\))f(that)h(monadic)g
(prop)r(erties)g(end)g(in)g Fe(r)l(eturn)25 b Ff(\(\))o(.)33
b(Suc)n(h)2040 4070 y(a)26 b(prop)r(ert)n(y)f(is)h(trivially)h
(satis\014ed.)2206 4211 y([)-13 b([)p Fe(r)l(eturn)6
b Ff(\(\)])-13 b(])42 b(=)c Fd(f)p Fe(r)l(eturn)25 b(T)-6
b(rue)6 b Fd(g)2040 4351 y Ff(Otherwise,)24 b(a)f(prop)r(ert)n(y)e(tak)
n(es)h(the)g(form)g(of)h Fe(m)15 b Fc(>)-38 b(>)-26 b
Ff(=)24 b Fe(k)31 b Ff(for)23 b(some)f Fe(m)2040 4434
y Ff(and)j Fe(k)8 b Ff(.)35 b(An)25 b(assertion)i(returns)e
Fe(F)-6 b(alse)32 b Ff(if)27 b(it)e(is)i(not)e(satis\014ed:)2206
4574 y([)-13 b([)p Fe(assert)36 b(T)-6 b(rue)15 b Fc(>)-38
b(>)7 b Fe(p)e Ff(])-13 b(])34 b(=)21 b([)-13 b([)p Fe(p)5
b Ff(])-13 b(])2206 4657 y([)g([)p Fe(assert)36 b(F)-6
b(alse)15 b Fc(>)-38 b(>)7 b Fe(p)e Ff(])-13 b(])22 b(=)f
Fd(f)p Fe(r)l(eturn)26 b(F)-6 b(alse)6 b Fd(g)2040 4798
y Ff(A)25 b(precondition)h(returns)g Fe(T)-6 b(rue)32
b Ff(if)26 b(it)g(is)g Fe(F)-6 b(alse)6 b Ff(.)2206 4938
y([)-13 b([)p Fe(pr)l(e)33 b(T)-6 b(rue)15 b Fc(>)-38
b(>)8 b Fe(p)d Ff(])-13 b(])34 b(=)21 b([)-13 b([)p Fe(p)5
b Ff(])-13 b(])2206 5021 y([)g([)p Fe(pr)l(e)33 b(F)-6
b(alse)15 b Fc(>)-38 b(>)8 b Fe(p)d Ff(])-13 b(])22 b(=)f
Fd(f)p Fe(r)l(eturn)k(T)-6 b(rue)6 b Fd(g)2040 5162 y
Ff(Quan)n(ti\014cation)27 b(deriv)n(es)g(a)g(set)h(of)g(computations)e
(from)h(eac)n(h)g(ele-)2040 5245 y(men)n(t)e(of)i(the)f(set)h(quan)n
(ti\014ed)e(o)n(v)n(er,)i(and)f(merges)h(them)e(|)h(unless)1921
5494 y(6)p eop
%%Page: 7 7
7 6 bop 14 -21 a Fh(data)18 b Fe(Element)25 b(s)e(a)45
b Ff(=)38 b Fe(Element)24 b(a)g Ff(\()p Fe(STR)l(ef)32
b(s)24 b Ff(\()p Fe(Link)h(s)e(a)6 b Ff(\)\))14 62 y
Fh(data)18 b Fe(Link)25 b(s)f(a)44 b Ff(=)38 b Fe(Weight)25
b(Int)f Fd(j)17 b Fe(Next)26 b Ff(\()p Fe(Element)e(s)g(a)6
b Ff(\))14 145 y Fe(newElement)47 b Ff(::)39 b Fe(a)44
b Fd(!)39 b Fe(ST)26 b(s)e Ff(\()p Fe(Element)g(s)g(a)6
b Ff(\))14 228 y Fe(newElement)25 b(a)45 b Ff(=)38 b
Fh(do)700 311 y Fe(r)47 b Fd( )38 b Fe(newSTR)l(ef)33
b Ff(\()p Fe(Weight)24 b Ff(1\))700 394 y Fe(r)l(eturn)h
Ff(\()p Fe(Element)f(a)f(r)8 b Ff(\))14 477 y Fe(\014ndElement)47
b Ff(::)39 b Fe(Element)25 b(s)e(a)45 b Fd(!)38 b Fe(ST)27
b(s)c Ff(\()p Fe(Element)i(s)e(a)6 b Ff(\))14 560 y Fe(\014ndElement)25
b Ff(\()p Fe(Element)g(a)e(r)8 b Ff(\))39 b(=)108 643
y Fh(do)185 726 y Fe(e)44 b Fd( )39 b Fe(r)l(e)l(adSTR)l(ef)34
b(r)202 809 y Fh(case)17 b Fe(e)23 b Fh(of)279 892 y
Fe(Weight)h(w)47 b Fd(!)38 b Fe(r)l(eturn)25 b Ff(\()p
Fe(Element)f(a)g(r)8 b Ff(\))279 975 y Fe(Next)25 b(next)47
b Fd(!)38 b Fh(do)833 1058 y Fe(last)46 b Fd( )38 b Fe(\014ndElement)25
b(next)833 1141 y(writeSTR)l(ef)33 b(r)26 b Ff(\()p Fe(Next)f(last)7
b Ff(\))833 1224 y Fe(r)l(eturn)25 b(last)14 1289 y(unionElements)46
b Ff(::)39 b Fe(Element)25 b(s)e(a)45 b Fd(!)38 b Fe(Element)25
b(s)e(a)45 b Fd(!)38 b Fe(ST)27 b(s)c Ff(\(\))14 1372
y Fe(unionElements)i(e)6 b Ff(1)17 b Fe(e)6 b Ff(2)39
b(=)108 1455 y Fh(do)185 1538 y Fe(Element)25 b(a)6 b
Ff(1)17 b Fe(r)8 b Ff(1)39 b Fd( )g Fe(\014ndElement)25
b(e)6 b Ff(1)185 1621 y Fe(Element)25 b(a)6 b Ff(2)17
b Fe(r)8 b Ff(2)39 b Fd( )g Fe(\014ndElement)25 b(e)6
b Ff(2)185 1704 y Fe(Weight)25 b(w)8 b Ff(1)38 b Fd( )h
Fe(r)l(e)l(adSTR)l(ef)34 b(r)8 b Ff(1)185 1787 y Fe(Weight)25
b(w)8 b Ff(2)38 b Fd( )h Fe(r)l(e)l(adSTR)l(ef)34 b(r)8
b Ff(2)202 1870 y Fh(if)26 b Fe(w)8 b Ff(1)22 b Fd(\024)38
b Fe(w)8 b Ff(2)18 b Fh(then)296 1953 y(do)373 2036 y
Fe(writeSTR)l(ef)33 b(r)8 b Ff(1)18 b(\()p Fe(Next)25
b Ff(\()p Fe(Element)g(a)6 b Ff(2)17 b Fe(r)8 b Ff(2\)\))373
2119 y Fe(writeSTR)l(ef)33 b(r)8 b Ff(2)18 b(\()p Fe(Weight)24
b Ff(\()p Fe(w)8 b Ff(1)18 b(+)f Fe(w)8 b Ff(2\)\))202
2198 y Fh(else)296 2281 y(do)373 2364 y Fe(writeSTR)l(ef)33
b(r)8 b Ff(2)18 b(\()p Fe(Next)25 b Ff(\()p Fe(Element)g(a)6
b Ff(1)17 b Fe(r)8 b Ff(1\)\))373 2447 y Fe(writeSTR)l(ef)33
b(r)8 b Ff(1)18 b(\()p Fe(Weight)24 b Ff(\()p Fe(w)8
b Ff(1)18 b(+)f Fe(w)8 b Ff(2\)\))14 2530 y Fh(instance)18
b Fe(Eq)24 b Ff(\()p Fe(Element)h(s)e(a)6 b Ff(\))91
2613 y Fh(where)168 2696 y Fe(Element)p 470 2696 24 4
v 69 w(r)34 b Ff(=)-13 b(=)26 b Fe(Element)p 1011 2696
V 69 w(r)1091 2664 y Fb(0)1152 2696 y Ff(=)38 b Fe(r)c
Ff(=)-13 b(=)25 b Fe(r)1488 2664 y Fb(0)210 2914 y Ff(Figure)h(1:)35
b(The)26 b(Union-Find)e(Algorithm.)-152 3151 y(the)i(set)g(w)n(e)h
(quan)n(tify)e(o)n(v)n(er)h(is)h(empt)n(y)-6 b(,)24 b(when)i(it)g
(succeeds)g(at)g(once)-152 3234 y(\(to)g(ensure)f(that)g(the)g(meaning)
f(of)i(the)f(prop)r(ert)n(y)g(is)g(a)h Fe(non-empty)-152
3317 y Ff(set\).)-12 3466 y([)-13 b([)p Fe(pick)35 b
Fd(;)9 b Fc(>)-38 b(>)-26 b Ff(=)8 b Fe(k)g Ff(])-13
b(])75 b(=)g Fd(f)p Fe(r)l(eturn)34 b(T)-6 b(rue)6 b
Fd(g)-12 3550 y Ff([)-13 b([)p Fe(pick)35 b(s)15 b Fc(>)-38
b(>)-26 b Ff(=)8 b Fe(k)g Ff(])-13 b(])76 b(=)f Fd(f)p
Fe(m)27 b Fd(j)22 b Fe(x)31 b Fd(2)21 b Fe(s)6 b Fc(;)14
b Fe(m)27 b Fd(2)21 b Ff([)-13 b([)p Fe(k)35 b(x)9 b
Ff(])-13 b(])p Fd(g)p Fc(;)40 b Ff(if)27 b Fe(s)h Fd(6)p
Ff(=)21 b Fd(;)-152 3699 y Ff(Finally)-6 b(,)33 b(running)e(a)h
(computation)e(of)i(t)n(yp)r(e)e Fe(M)f Fc(\034)40 b
Ff(is)31 b(in)n(terpreted)-152 3782 y(as)-10 3913 y([)-13
b([)p Fe(run)33 b(m)14 b Fc(>)-38 b(>)-26 b Ff(=)8 b
Fe(k)g Ff(])-13 b(])76 b(=)e Fd(f)p Fe(m)15 b Fc(>)-38
b(>)-26 b Ff(=)7 b Fe(k)933 3882 y Fb(0)977 3913 y Fd(j)59
b Fe(k)1100 3882 y Fb(0)1144 3913 y Fd(2)22 b Fc(\034)30
b Fd(!)21 b Fe(M)37 b(Bo)l(ol)8 b Fc(;)1057 3998 y Fd(8)p
Fe(x)h Fc(:)p Fe(k)1208 3966 y Fb(0)1257 3998 y Fe(x)31
b Fd(2)21 b Ff([)-13 b([)p Fe(k)35 b(x)9 b Ff(])-13 b(])p
Fd(g)-152 4147 y Ff(Here)19 b Fe(k)28 b Ff(represen)n(ts)19
b(a)h(function)f(from)g Fc(\034)28 b Ff(to)19 b(a)h Fe(set)g
Ff(of)g(computations,)-152 4230 y(and)f Fe(k)34 4198
y Fb(0)76 4230 y Ff(is)h(a)g(function)f(whic)n(h)h(mak)n(es)e(a)i(c)n
(hoice)g(from)f(eac)n(h)g(suc)n(h)g(set.)-152 4313 y(It)25
b(is)h(to)g(mak)n(e)e(this)h(p)r(ossible)i(that)e(w)n(e)g(require)h
(the)e(meaning)h(of)h(a)-152 4396 y(prop)r(ert)n(y)d(to)g(b)r(e)f(a)i
Fe(non-empty)g Ff(set.)34 b(The)23 b(e\013ect)g(of)h(this)f
(de\014nition)-152 4479 y(is)35 b(that,)h(if)f(there)e(is)i(quan)n
(ti\014cation)f(in)f Fe(k)43 b Ff(\(p)r(erhaps)33 b(dep)r(ending)-152
4562 y(on)28 b(the)e(result)i(deliv)n(ered)f(b)n(y)f
Fe(m)6 b Ff(\),)28 b(then)e(ev)n(ery)h(p)r(ossible)h(c)n(hoice)g(is)
-152 4645 y(represen)n(ted)e(b)n(y)e(some)i Fe(m)14 b
Fc(>)-38 b(>)-26 b Ff(=)8 b Fe(k)800 4613 y Fb(0)848
4645 y Ff(in)26 b(the)f(resulting)h(set.)-40 4728 y(With)k(these)f
(de\014nitions,)i(monadic)d(prop)r(erties)j(ha)n(v)n(e)d(a)i(w)n(ell-)
-152 4811 y(de\014ned)25 b(meaning)g(no)h(matter)f Fe(what)h
Ff(the)f(underlying)g(monad)g(is.)-152 5005 y Fh(9)89
b(Implemen)n(ting)30 b(Monadic)g(Prop)r(erties)-152 5162
y Ff(The)h(implemen)n(tation)e(of)i Fg(QuickCheck)d Ff(is)i(based)h(on)
f(the)g(monad)-152 5245 y Fe(Gen)7 b Ff(,)26 b(an)g(abstract)g(t)n(yp)r
(e)f(de\014ned)f(b)n(y)2206 -69 y Fh(newt)n(yp)r(e)16
b Fe(Gen)24 b(a)45 b Ff(=)38 b Fe(Gen)24 b Ff(\()p Fe(Int)45
b Fd(!)38 b Fe(StdGen)46 b Fd(!)38 b Fe(a)6 b Ff(\))2040
80 y(Essen)n(tially)37 b(a)f Fe(Gen)23 b(a)42 b Ff(is)36
b(a)f(function)h(from)f(a)h(random)f(n)n(um)n(b)r(er)2040
163 y(seed)22 b(to)g(an)f Fe(a)6 b Ff(:)33 b(the)21 b
Fe(Int)29 b Ff(parameter)21 b(is)i(used)e(to)h(con)n(trol)g(the)f(size)
i(of)2040 246 y(generated)31 b(data)f(and)g(need)g(not)g(concern)g(us)g
(here.)48 b Fg(QuickCheck)2040 329 y Ff(prop)r(erties)26
b(are)h(just)f(generators)h(for)f(test)g(results)2206
478 y Fh(newt)n(yp)r(e)16 b Fe(Pr)l(op)l(erty)48 b Ff(=)38
b Fe(Pr)l(op)23 b Ff(\()p Fe(Gen)g(R)l(esult)7 b Ff(\))2040
626 y(where)28 b(the)f Fe(R)l(esult)35 b Ff(t)n(yp)r(e)27
b(collects)i(quan)n(ti\014ed)d(v)l(ariables,)j(precon-)2040
709 y(ditions,)f(and)e(monitoring)h(information)h(as)f(w)n(ell)h(as)f
(represen)n(ting)2040 792 y(success)g(or)f(failure.)2152
875 y(Monadic)34 b(prop)r(erties)g(are)g(built)f(b)n(y)g(com)n(bining)f
Fe(Gen)40 b Ff(and)33 b(a)2040 958 y(CPS)26 b(monad)f(with)h(the)f
(underlying)g(monad)g Fe(m)6 b Ff(.)2206 1107 y Fh(newt)n(yp)r(e)16
b Fe(Pr)l(op)l(ertyM)32 b(m)22 b(a)45 b Ff(=)2283 1190
y Fe(Monadic)21 b Ff(\(\()p Fe(a)45 b Fd(!)38 b Fe(Gen)24
b Ff(\()p Fe(m)e(R)l(esult)7 b Ff(\)\))39 b Fd(!)2781
1273 y Fe(Gen)24 b Ff(\()p Fe(m)f(R)l(esult)7 b Ff(\)\))2040
1417 y(Using)31 b(CPS)g(enables)g Fe(pr)l(e)37 b Ff(and)30
b Fe(assert)39 b Ff(to)31 b(discard)g(the)f(rest)h(of)g(a)2040
1500 y(prop)r(ert)n(y)25 b(when)h(their)f(argumen)n(t)g(is)h(false.)
2152 1583 y(Giv)n(en)21 b(this)h(t)n(yp)r(e,)f(the)g(rest)h(of)g(the)f
(implemen)n(tation)f(is)i(mostly)2040 1666 y(straigh)n(tforw)n(ard,)36
b(and)31 b(follo)n(ws)k(the)c(seman)n(tics)h(closely;)37
b(indeed,)2040 1749 y(w)n(e)d(added)e(only)h(ab)r(out)h(30)g(lines)g
(of)g(co)r(de)f(to)h Fg(QuickCheck)p Ff(,)f(and)2040
1832 y(did)d(not)g(need)g(to)g(c)n(hange)h(an)n(y)e(existing)i(co)r(de)
g(at)f(all.)49 b(The)31 b(only)2040 1915 y(tric)n(ky)25
b(part)h(is)g(the)f(de\014nition)g(of)i Fe(run)6 b Ff(:)2206
2064 y Fe(run)24 b(m)44 b Ff(=)38 b Fe(Monadic)21 b Ff(\()p
Fc(\025)c Fe(k)47 b Fd(!)38 b Fe(liftM)28 b Ff(\()p Fe(m)j
Fc(>)-38 b(>)-26 b Ff(=)-14 b(\))17 b(\()p Fe(pr)l(omote)25
b(k)8 b Ff(\)\))2040 2213 y(Here)19 b(the)g(con)n(tin)n(uation)g
Fe(k)28 b Ff(is)19 b(of)h(t)n(yp)r(e)f Fe(a)44 b Fd(!)39
b Fe(Gen)23 b Ff(\()p Fe(m)g(R)l(esult)7 b Ff(\))q(,)20
b(but)2040 2296 y(b)r(efore)26 b(w)n(e)f(apply)f Fe(liftM)k
Ff(\()p Fe(m)j Fc(>)-38 b(>)-26 b Ff(=)-13 b(\))24 b(to)h(it,)h(w)n(e)f
(m)n(ust)e(con)n(v)n(ert)h(it)h(to)g(a)2040 2379 y Fe(Gen)f
Ff(\()p Fe(a)44 b Fd(!)38 b Fe(m)23 b(R)l(esult)7 b Ff(\))q(.)44
b(Because)30 b(of)g(the)f(w)n(a)n(y)g(w)n(e)g(de\014ned)f
Fe(Gen)2040 2462 y Ff(this)i(is)h(simple)f(to)g(do:)44
b(the)30 b Fe(pr)l(omote)37 b Ff(function)30 b(need)g(only)g(sw)n(ap)
2040 2545 y(the)d(argumen)n(ts)f(of)i(the)f(function)g(it)h(is)g
(passed,)g(to)f(tak)n(e)g(the)g(ran-)2040 2628 y(dom)35
b(n)n(um)n(b)r(er)g(seed)h(and)g(size)i(\014rst,)h(rather)d(than)g(the)
g Fe(a)6 b Ff(.)67 b(But)2040 2711 y(this)36 b(kind)e(of)j(promotion)e
(is)h(quite)f(imp)r(ossible)h(for)h(most)e(mon-)2040
2794 y(ads:)40 b(indeed,)28 b(for)h(the)f(monad)f Fe(Set)36
b Ff(\(whic)n(h)28 b Fe(Gen)35 b Ff(is)28 b(supp)r(osed)g(to)2040
2877 y(represen)n(t\),)k Fe(pr)l(omote)39 b Ff(corresp)r(onds)31
b(to)h(applying)e(the)h(Axiom)f(of)2040 2960 y(Choice!)k(No)22
b(w)n(onder)g(this)f(seemingly)h(simple)f(de\014nition)g(is)h(some-)
2040 3043 y(what)k(coun)n(ter-in)n(tuitiv)n(e.)2040 3237
y Fh(10)89 b(Another)30 b(Example:)38 b(The)29 b(Union-Find)i
(Algorithm)2040 3394 y Ff(As)24 b(an)f(example)g(whic)n(h)h(mak)n(es)f
(extensiv)n(e)h(use)f(of)i(monadic)e(prop-)2040 3477
y(erties,)38 b(w)n(e)c(shall)i(test)e(the)g(Union/Find)g(algorithm.)60
b(This)35 b(is)g(a)2040 3560 y(v)n(ery)28 b(e\016cien)n(t)i(w)n(a)n(y)f
(to)h(represen)n(t)f(an)g(equiv)l(alence)g(relation.)46
b(El-)2040 3643 y(emen)n(ts)26 b(of)j(the)e(relation)h(are)g(organised)
h(in)n(to)e(trees)h(represen)n(ting)2040 3726 y(equiv)l(alence)f
(classes,)j(with)e(eac)n(h)g(elemen)n(t)f(con)n(taining)h(a)g(p)r(oin)n
(ter)2040 3809 y(to)22 b(its)g(paren)n(t.)33 b(By)21
b(follo)n(wing)k(these)c(p)r(oin)n(ters)h(to)g(the)g(ro)r(ot)g(of)g
(eac)n(h)2040 3892 y(tree,)39 b(w)n(e)e(can)f(\014nd)f(a)i
(distinguished)f(elemen)n(t)f(of)i(eac)n(h)g(equiv)l(a-)2040
3975 y(lence)30 b(class;)j(the)c(op)r(eration)h(whic)n(h)f(do)r(es)h
(so)g(is)g(called)g Fe(\014nd)8 b Ff(.)46 b(W)-6 b(e)2040
4058 y(can)26 b(test)f(whether)h(t)n(w)n(o)g(elemen)n(ts)e(are)i(equiv)
l(alen)n(t)f(b)n(y)g(comparing)2040 4141 y(the)f(results)g(of)g
Fe(\014nd)32 b Ff(on)24 b(eac)n(h)g(one.)34 b(Equiv)l(alence)24
b(classes)h(can)f(also)2040 4224 y(b)r(e)i(merged)g(b)n(y)f(declaring)j
(t)n(w)n(o)f(elemen)n(ts)e(to)i(b)r(e)f(equiv)l(alen)n(t:)35
b(this)2040 4307 y(is)27 b(done)f(b)n(y)f(the)h(function)h
Fe(union)6 b Ff(,)26 b(and)g(ac)n(hiev)n(ed)g(b)n(y)f(making)h(the)2040
4390 y(ro)r(ot)h(of)f(one)g(tree)g(p)r(oin)n(t)f(at)h(the)f(ro)r(ot)i
(of)f(the)f(other.)2152 4473 y(The)36 b(Union/Find)f(algorithm)g(o)n(w)
n(es)h(its)g(great)g(e\016ciency)f(to)2040 4556 y(t)n(w)n(o)26
b(optimisations:)2126 4691 y Fd(\017)42 b Ff(After)25
b Fe(\014nd)32 b Ff(has)25 b(tra)n(v)n(ersed)g(a)g(path)f(to)g(the)h
(ro)r(ot)g(of)g(a)g(tree,)g(it)2206 4774 y(up)r(dates)30
b(all)g(the)f(elemen)n(ts)g(in)h(the)f(path)g(to)h(p)r(oin)n(t)g
(directly)2206 4857 y(at)c(the)f(ro)r(ot.)36 b(This)26
b(sp)r(eeds)g(up)f(subsequen)n(t)f Fe(\014nd)8 b Ff(s.)2126
4996 y Fd(\017)42 b Ff(When)29 b(trees)h(are)h(merged,)f(the)f(ro)r(ot)
i(of)f(the)g Fe(lighter)g Ff(tree)g(is)2206 5079 y(made)35
b(to)h(p)r(oin)n(t)g(at)g(the)g(ro)r(ot)g(of)h(the)f
Fe(he)l(avier)p Ff(,)k(where)c(the)2206 5162 y(w)n(eigh)n(t)30
b(of)f(a)g(tree)g(is)h(the)e(n)n(um)n(b)r(er)f(of)j(elemen)n(ts)e(in)h
(it.)44 b(This)2206 5245 y(also)27 b(sp)r(eeds)f(up)f(subsequen)n(t)f
Fe(\014nd)9 b Ff(s.)1921 5494 y(7)p eop
%%Page: 8 8
8 7 bop -152 -69 a Ff(With)25 b(these)g(optimisations,)i(a)e(sequence)g
(of)h Fe(union)31 b Ff(and)25 b Fe(\014nd)33 b Ff(op-)-152
14 y(erations)e(is)f(executed)e(in)i(almost)f(linear)h(time)f(\(where)h
(\\almost")-152 97 y(in)n(v)n(olv)n(es)k(the)g(in)n(v)n(erse)g(of)g
(the)g(Ac)n(k)n(ermann)e(function,)k(so)f(for)g(all)-152
180 y(practical)27 b(purp)r(oses)f(w)n(e)g(can)g(consider)g(the)g(time)
e(to)i(b)r(e)g(linear\).)-40 263 y(A)i(Hask)n(ell)g(implemen)n(tation)f
(of)i(the)f(Union/Find)f(algorithm)-152 346 y(is)d(v)n(ery)e(simple;)i
(one)g(app)r(ears)g(in)f(Figure)h(1.)34 b(Elemen)n(ts)22
b(are)i(repre-)-152 429 y(sen)n(ted)f(b)n(y)f(the)h(t)n(yp)r(e)f
Fe(Element)8 b Ff(,)24 b(con)n(tain)f(a)g(v)l(alue)g(\(so)h(w)n(e)f
(can)g(rep-)-152 512 y(resen)n(t)f(equiv)l(alence)f(relations)i(on)f
(other)f(t)n(yp)r(es\),)h(and)f(are)h(created)-152 596
y(b)n(y)c(the)h(function)g Fe(newElement)8 b Ff(.)32
b(The)20 b Fe(\014nd)27 b Ff(and)18 b Fe(union)26 b Ff(op)r(erations)
-152 679 y(are)35 b(implemen)n(ted)d(b)n(y)h Fe(\014ndElement)43
b Ff(and)33 b Fe(unionElements)8 b Ff(.)60 b(Fi-)-152
762 y(nally)-6 b(,)24 b Fe(Element)8 b Ff(s)24 b(can)g(b)r(e)f
(compared,)h(so)g(w)n(e)g(can)g(decide)g(whether)-152
845 y(t)n(w)n(o)29 b(results)f(of)h Fe(\014ndElement)36
b Ff(are)29 b(the)f(same.)41 b(Elemen)n(ts)28 b(con)n(tain)-152
928 y(an)20 b(up)r(dateable)f Fe(Link)8 b Ff(,)21 b(whic)n(h)f(in)f
(the)g(case)h(of)g(ro)r(ot)h(no)r(des)e(con)n(tains)-152
1011 y(a)26 b(w)n(eigh)n(t,)h(and)e(for)i(other)e(no)r(des)h(con)n
(tains)h(the)e(paren)n(t.)-152 1206 y Fh(11)89 b(T)-7
b(esting)138 b(Pre-)h(and)g(P)n(ostconditions)i(for)25
1289 y(Union/Find)-152 1446 y Ff(W)-6 b(e)32 b(shall)i(test)f(our)f
(Union/Find)h(implemen)n(tation)e(using)i(y)n(et)e(a)-152
1529 y(third)37 b(metho)r(d:)57 b(b)r(e)37 b(sp)r(ecifying)i(pre-)e
(and)g(p)r(ost-conditions)h(for)-152 1612 y(eac)n(h)f(op)r(eration.)68
b(With)37 b(this)f(approac)n(h,)k(w)n(e)d(need)f(neither)h(an)-152
1695 y(abstract)c(mo)r(del,)g(nor)f(algebraic)i(la)n(ws.)54
b(But)32 b(w)n(e)g(will)h(still)g(need)-152 1778 y(to)i(quan)n(tify)g
(o)n(v)n(er)f(reac)n(hable)i(states.)63 b(As)35 b(b)r(efore,)k(w)n(e)c
(de\014ne)f(a)-152 1861 y(language)27 b(of)g(union/\014nd)d(programs.)
14 2019 y Fh(data)18 b Fe(A)l(ction)45 b Ff(=)38 b Fe(New)25
b Fd(j)18 b Fe(Find)24 b(V)-6 b(ar)26 b Fd(j)18 b Fe(Union)23
b(V)-6 b(ar)25 b(V)-6 b(ar)91 2102 y Fh(deriving)20 b
Fe(Show)14 2185 y Fh(t)n(yp)r(e)d Fe(V)-6 b(ar)47 b Ff(=)38
b Fe(Int)-152 2343 y Ff(A)j(program)f(is)i(a)f(list)g(of)h
Fe(A)l(ction)6 b Ff(s,)46 b(whic)n(h)40 b(ma)n(y)g(create,)46
b(\014nd,)-152 2426 y(or)h(unite)e(elemen)n(ts.)96 b(The)46
b(argumen)n(ts)f(of)i Fe(\014ndElement)54 b Ff(and)-152
2509 y Fe(unionElements)40 b Ff(ma)n(y)31 b(b)r(e)i(an)n(y)f(elemen)n
(t)f(previously)i(created)g(b)n(y)-152 2592 y Fe(newElement)8
b Ff(;)24 b(w)n(e)e(use)h(natural)f(n)n(um)n(b)r(ers)e(to)j(refer)g(to)
f(them)f(in)h(or-)-152 2675 y(der)f(of)g(creation.)34
b(The)21 b(seman)n(tics)g(of)g(action)h(sequences)f(is)g(de\014ned)-152
2758 y(b)n(y)14 2916 y Fe(exe)l(c)44 b Ff(::)39 b([)p
Fe(A)l(ction)6 b Ff(])40 b Fd(!)e Ff([)p Fe(Element)25
b(a)e Ff(\(\)])39 b Fd(!)630 2999 y Fe(ST)27 b(a)c Ff([)p
Fe(Element)i(a)e Ff(\(\)])-152 3152 y(whic)n(h)h(deliv)n(ers)h(as)f
(its)g(result)h(a)f(list)h(of)f(the)g Fe(Element)7 b
Ff(s)25 b(created)f(b)n(y)-152 3235 y Fe(newElement)8
b Ff(.)-40 3318 y(Of)38 b(course,)k(only)c(certain)g(union/\014nd)f
(programs)h(are)g Fe(wel)t(l-)-152 3401 y(forme)l(d)p
Ff(:)49 b(w)n(e)32 b(m)n(ust)g(not)g(use)g(an)h Fe(Element)40
b Ff(whic)n(h)32 b(has)h(not)f(b)r(een)-152 3484 y(created.)40
b(W)-6 b(e)26 b(therefore)i(de\014ne)f(a)g(generator)h(for)g(the)f(set)
g(of)h(pro-)-152 3567 y(grams)e(w)n(ell-formed)g(in)g(the)f(con)n(text)
g(of)i Fe(k)33 b Ff(elemen)n(ts.)14 3725 y Fe(actions)104
b Ff(::)30 b Fe(Int)46 b Fd(!)38 b Fe(Gen)24 b Ff([)p
Fe(A)l(ction)6 b Ff(])14 3808 y Fe(actions)25 b Ff(0)32
b(=)91 3891 y Fe(fr)l(e)l(quency)26 b Ff([\(25)p Fc(;)14
b Fe(liftM)28 b Ff(\()p Fe(New)h Ff(:\))17 b(\()p Fe(actions)25
b Ff(1\)\))p Fc(;)447 3974 y Ff(\(1)p Fc(;)30 b Fe(r)l(eturn)25
b Ff([]\)])14 4050 y Fe(actions)g(n)i Ff(=)91 4133 y
Fe(fr)l(e)l(quency)203 4216 y Ff([\(2)p Fc(;)14 b Fe(liftM)28
b Ff(\()p Fe(New)h Ff(:\))18 b(\()p Fe(actions)24 b Ff(\()p
Fe(n)f Ff(+)17 b(1\)\)\))p Fc(;)224 4299 y Ff(\(2)p Fc(;)d
Fe(liftM)e Ff(2)k(\(:\))h(\()p Fe(liftM)28 b(Find)d(element)7
b Ff(\))653 4382 y(\()p Fe(actions)25 b(n)6 b Ff(\)\))p
Fc(;)224 4465 y Ff(\(2)p Fc(;)14 b Fe(liftM)e Ff(2)k(\(:\))h(\()p
Fe(liftM)12 b Ff(2)17 b Fe(Union)23 b(element)1141 4548
y(element)7 b Ff(\))653 4631 y(\()p Fe(actions)25 b(n)6
b Ff(\)\))p Fc(;)224 4714 y Ff(\(1)p Fc(;)14 b Fe(r)l(eturn)25
b Ff([]\)])91 4824 y Fh(where)168 4907 y Fe(element)46
b Ff(=)38 b Fe(cho)l(ose)25 b Ff(\(0)p Fc(;)13 b Fe(n)23
b Fd(\000)17 b Ff(1\))-152 5061 y(When)26 b(the)g(n)n(um)n(b)r(er)e(of)
j(elemen)n(ts)f(is)h(zero,)g(the)f(only)g(p)r(ossible)i(ac-)-152
5144 y(tion)23 b(is)g Fe(New)8 b Ff(:)33 b(w)n(e)23 b(giv)n(e)g(this)g
(a)g(high)f(probabilit)n(y)-6 b(,)23 b(to)g(a)n(v)n(oid)g(a)g(large)
-152 5227 y(n)n(um)n(b)r(er)35 b(of)j(tests)g(in)e(the)h(initial)h
(state.)69 b(Similarly)-6 b(,)40 b(w)n(e)d(assign)2040
-69 y(a)e(higher)g(probabilit)n(y)g(to)g(c)n(ho)r(osing)h(an)f(op)r
(eration)h(than)e(to)h(re-)2040 14 y(turning)f(the)h(empt)n(y)e(list:)
53 b(w)n(e)35 b(can)g(exp)r(ect)f(to)h(generate)h(action)2040
97 y(sequences)26 b(with)g(an)f(a)n(v)n(erage)i(length)e(of)i(7)f
(using)g(this)g(de\014nition.)2152 180 y(No)n(w)f(w)n(e)h(can)f
(de\014ne)f(a)i(com)n(binator)e(for)i(quan)n(tifying)f(o)n(v)n(er)g
(all)2040 263 y(states.)2206 421 y Fe(forA)n(l)t(lStates)98
b Ff(::)2283 504 y(\()p Fd(8)17 b Fe(s)6 b Fc(:)17 b
Ff([)p Fe(Element)25 b(s)f Ff(\(\)])38 b Fd(!)h Fe(Pr)l(op)l(ertyM)31
b Ff(\()p Fe(ST)26 b(s)6 b Ff(\))18 b Fe(a)6 b Ff(\))38
b Fd(!)2395 587 y Fe(Pr)l(op)l(erty)2206 662 y(forA)n(l)t(lStates)24
b(p)j Ff(=)2283 745 y Fe(forA)n(l)t(l)d Ff(\()p Fe(actions)g
Ff(0\))17 b($)h Fc(\025)f Fe(as)45 b Fd(!)2395 828 y
Fe(imp)l(er)l(ative)24 b Ff(\()17 b Fh(do)2885 911 y
Fe(vars)46 b Fd( )38 b Fe(run)24 b Ff(\()p Fe(exe)l(c)e(as)i
Ff([]\))2885 994 y Fe(p)e(vars)6 b Ff(\))2040 1148 y(W)-6
b(e)34 b(pass)h(the)f(prop)r(ert)n(y)g Fe(p)39 b Ff(a)34
b(list)i(of)f(all)g(created)g Fe(Element)7 b Ff(s;)40
b(in)2040 1231 y(most)34 b(prop)r(erties)i(w)n(e)f(need)f(to)h(quan)n
(tify)f(o)n(v)n(er)g(the)h(elemen)n(ts)f(of)2040 1314
y(this)26 b(list.)2152 1397 y(This)98 b(quan)n(ti\014cation)f(p)r(oses)
h(a)f(problem,)115 b(though.)2040 1480 y Fg(QuickCheck)p
Ff('s)66 b(quan)n(ti\014cation)h(op)r(erators)i(can)e(only)h(quan-)2040
1563 y(tify)32 b(o)n(v)n(er)f(t)n(yp)r(es)f(in)i(class)g
Fe(Show)9 b Ff(,)33 b(since)f(the)e(v)l(alue)i(c)n(hosen)f(m)n(ust)2040
1646 y(b)r(e)37 b(displa)n(y)n(ed)g(when)h(a)f(test)h(fails.)71
b(But)37 b Fe(Element)8 b Ff(s)37 b(cannot)h(b)r(e)2040
1729 y Fe(show)9 b Ff(n,)31 b(since)g(they)e(con)n(tain)i
Fe(STR)l(ef)16 b Ff(s,)32 b(and)e(this)g(is)h(an)f(abstract)2040
1812 y(t)n(yp)r(e)35 b(for)h(whic)n(h)g Fe(show)44 b
Ff(is)37 b(not)e(de\014ned.)64 b(Of)35 b(course,)k(w)n(e)d(could)2040
1895 y(de\014ne)49 b(our)h(o)n(wn)g Fe(Show)58 b Ff(instance)50
b(to)g(displa)n(y)g(references)h(as)2040 1978 y(")p Fc(<)22
b Ff(STRef)27 b Fc(>)p Ff(",)37 b(but)c(this)i(w)n(ould)g(not)f(b)r(e)g
(useful!)61 b(W)-6 b(e)34 b Fe(want)h Ff(to)2040 2061
y(kno)n(w)26 b(whic)n(h)f(elemen)n(t)g(w)n(as)i(c)n(hosen)f(when)f(a)h
(test)g(fails!)2152 2144 y(Our)e(solution)h(to)g(the)f(\\abstract)h(t)n
(yp)r(e)f(quan)n(ti\014cation")g(prob-)2040 2227 y(lem)19
b(is)h(to)f(quan)n(tify)g(o)n(v)n(er)g(an)g(elemen)n(t's)g
Fe(p)l(osition)k(in)e(a)h(list)d Ff(instead:)2040 2310
y(as)30 b(long)g(as)h(w)n(e)e(kno)n(w)h(ho)n(w)g(the)f(list)h(is)g
(constructed,)h(w)n(e)e(can)h(in-)2040 2393 y(fer)e(whic)n(h)g(elemen)n
(t)e(w)n(as)i(used.)40 b(In)27 b(this)g(case,)i(w)n(e)f(use)g(the)f
(list)h(of)2040 2476 y(created)g Fe(Element)8 b Ff(s)28
b(passed)g(to)g(prop)r(erties)h(b)n(y)e Fe(forA)n(l)t(lStates)7
b Ff(.)41 b(W)-6 b(e)2040 2559 y(de\014ne)25 b(a)h(function)2206
2717 y Fe(pickElement)46 b Ff(::)40 b Fe(Monad)25 b(m)44
b Fd(\))38 b Ff([)p Fe(a)6 b Ff(])39 b Fd(!)f Fe(Pr)l(op)l(ertyM)31
b(m)23 b(a)2206 2800 y(pickElement)i(vars)46 b Ff(=)2300
2883 y Fh(do)2377 2966 y Fe(pr)l(e)23 b Ff(\()p Fe(not)i
Ff(\()p Fe(nul)t(l)f(vars)6 b Ff(\)\))2377 3049 y Fe(i)45
b Fd( )38 b Fe(pick)26 b Ff(\()p Fe(cho)l(ose)e Ff(\(0)p
Fc(;)30 b Fe(length)24 b(vars)h Fd(\000)16 b Ff(1\)\))2377
3132 y Fe(r)l(eturn)25 b Ff(\()p Fe(vars)15 b Ff(!!)27
b Fe(i)7 b Ff(\))2040 3285 y(whic)n(h)31 b(quan)n(ti\014es)f(o)n(v)n
(er)h(this)g(list,)i(and)d(imp)r(oses)h(a)g(precondition)2040
3368 y(that)25 b(it)h(b)r(e)g(non-empt)n(y)-6 b(.)2152
3451 y(No)n(w)51 b(w)n(e)f(just)g(need)g(to)h(c)n(haracterise)g(the)f
(b)r(eha)n(viour)g(of)2040 3534 y Fe(\014ndElement)38
b Ff(and)31 b Fe(unionElements)37 b Ff(using)31 b(pre-)e(and)h(p)r
(ostcondi-)2040 3618 y(tions.)k(W)-6 b(e)24 b(will)h(need)f(to)g(refer)
g(to)g(the)g(distinguished)g(represen)n(ta-)2040 3701
y(tiv)n(e)h(of)i(eac)n(h)f(equiv)l(alence)f(class,)i(so)g(w)n(e)f
(de\014ne)2206 3858 y Fe(r)l(epr)l(esentative)48 b Ff(::)39
b Fe(Element)25 b(a)e(b)43 b Fd(!)38 b Fe(ST)27 b(a)c
Ff(\()p Fe(Element)i(a)e(b)5 b Ff(\))2040 4016 y(to)29
b(\014nd)e(it.)42 b(Of)28 b(course,)i(this)f(function)f(deliv)n(ers)g
(the)g(same)g(result)2040 4099 y(as)i Fe(\014ndElement)9
b Ff(,)31 b Fe(but)h(without)g(a)f(side)h(e\013e)l(ct)p
Ff(.)48 b(It)30 b(is)g(just)g(for)h(use)2040 4182 y(in)26
b(form)n(ulating)g(prop)r(erties.)2152 4265 y(Let)d(us)f(b)r(egin!)34
b(Firstly)-6 b(,)23 b Fe(\014ndElements)30 b Ff(returns)22
b(the)g(represen-)2040 4348 y(tativ)n(e)k(of)g(its)g(argumen)n(t.)2206
4506 y Fe(pr)l(op)p 2360 4506 24 4 v 34 w(FindR)l(eturnsR)l(ep)45
b Ff(=)2283 4589 y Fe(forA)n(l)t(lStates)24 b Ff(\()p
Fc(\025)17 b Fe(vars)46 b Fd(!)2412 4672 y Fh(do)2489
4755 y Fe(v)h Fd( )38 b Fe(pickElement)25 b(vars)2489
4838 y(r)47 b Fd( )38 b Fe(run)23 b Ff(\()p Fe(r)l(epr)l(esentative)k
(v)8 b Ff(\))2489 4921 y Fe(r)2529 4889 y Fb(0)2590 4921
y Fd( )38 b Fe(run)24 b Ff(\()p Fe(\014ndElement)h(v)8
b Ff(\))2489 5004 y Fe(assert)26 b Ff(\()p Fe(r)17 b
Ff(=)-13 b(=)25 b Fe(r)2959 4972 y Fb(0)2982 5004 y Ff(\)\))2040
5158 y(Secondly)-6 b(,)22 b Fe(\014ndElement)30 b Ff(do)r(es)22
b(not)f(c)n(hange)h(the)f(represen)n(tativ)n(e)h(of)2040
5241 y(an)n(y)j(elemen)n(t.)1921 5494 y(8)p eop
%%Page: 9 9
9 8 bop 14 -69 a Fe(pr)l(op)p 168 -69 24 4 v 34 w(FindPr)l(eservesR)l
(eps)48 b Ff(=)91 14 y Fe(forA)n(l)t(lStates)25 b Ff(\()p
Fc(\025)16 b Fe(vars)46 b Fd(!)220 97 y Fh(do)297 180
y Ff(\()p Fe(v)8 b Fc(;)13 b Fe(v)447 149 y Fb(0)470
180 y Ff(\))38 b Fd( )h Fe(two)22 b Ff(\()p Fe(pickElement)j(vars)6
b Ff(\))297 263 y Fe(r)i Ff(0)39 b Fd( )f Fe(run)24 b
Ff(\()p Fe(r)l(epr)l(esentative)i(v)8 b Ff(\))297 346
y Fe(r)337 315 y Fb(0)398 346 y Fd( )38 b Fe(run)24 b
Ff(\()p Fe(\014ndElement)h(v)1149 315 y Fb(0)1172 346
y Ff(\))297 429 y Fe(r)8 b Ff(1)39 b Fd( )f Fe(run)24
b Ff(\()p Fe(r)l(epr)l(esentative)i(v)8 b Ff(\))297 512
y Fe(assert)26 b Ff(\()p Fe(r)8 b Ff(0)h(=)-13 b(=)26
b Fe(r)8 b Ff(1\)\))-152 663 y(Thirdly)-6 b(,)23 b Fe(unionElements)28
b Ff(do)r(es)23 b(not)e(c)n(hange)h(the)f(represen)n(tativ)n(es)-152
746 y(of)30 b(elemen)n(ts)f(whic)n(h)g(w)n(ere)h Fe(not)g
Ff(previously)f(equiv)l(alen)n(t)f(to)i(one)f(of)-152
829 y(its)d(argumen)n(ts.)14 983 y Fe(pr)l(op)p 168 983
V 34 w(UnionPr)l(eservesOtherR)l(eps)49 b Ff(=)91 1066
y Fe(forA)n(l)t(lStates)25 b Ff(\()p Fc(\025)16 b Fe(vars)29
b Fd(!)220 1149 y Fh(do)297 1232 y Ff(\()p Fe(v)8 b Ff(0)p
Fc(;)14 b Fe(v)8 b Ff(1)p Fc(;)14 b Fe(v)8 b Ff(2\))39
b Fd( )f Fe(thr)l(e)l(e)24 b Ff(\()p Fe(pickElement)h(vars)6
b Ff(\))297 1315 y([)p Fe(r)i Ff(0)p Fc(;)14 b Fe(r)8
b Ff(1)p Fc(;)14 b Fe(r)8 b Ff(2])40 b Fd( )486 1398
y Fe(run)24 b Ff(\()p Fe(mapM)k(r)l(epr)l(esentative)f
Ff([)p Fe(v)8 b Ff(0)p Fc(;)14 b Fe(v)8 b Ff(1)p Fc(;)14
b Fe(v)8 b Ff(2]\))314 1481 y Fe(pr)l(e)24 b Ff(\()p
Fe(r)8 b Ff(0)22 b Fd(6)p Ff(=)38 b Fe(r)8 b Ff(1)35
b Fd(^)f Fe(r)8 b Ff(0)22 b Fd(6)p Ff(=)38 b Fe(r)8 b
Ff(2\))297 1564 y Fe(run)24 b Ff(\()p Fe(unionElements)g(v)8
b Ff(1)18 b Fe(v)8 b Ff(2\))297 1647 y Fe(r)g Ff(0)375
1616 y Fb(0)437 1647 y Fd( )38 b Fe(run)23 b Ff(\()p
Fe(r)l(epr)l(esentative)k(v)8 b Ff(0\))297 1730 y Fe(assert)26
b Ff(\()p Fe(r)8 b Ff(0)27 b(=)-13 b(=)25 b Fe(r)8 b
Ff(0)861 1699 y Fb(0)884 1730 y Ff(\)\))-152 1881 y(Finally)-6
b(,)21 b Fe(unionElements)27 b Ff(really)20 b(do)r(es)g(unite)f(equiv)l
(alence)g(classes.)-152 1964 y(W)-6 b(e)20 b(express)g(this)g(b)n(y)e
(stating)j(that)e(all)i(the)f(elemen)n(ts)f(of)i(the)e(equiv-)-152
2047 y(alence)j(class)h(of)e(either)h(argumen)n(t)e(ha)n(v)n(e)g(the)h
(same)g(represen)n(tativ)n(e)-152 2130 y(afterw)n(ards.)14
2284 y Fe(pr)l(op)p 168 2284 V 34 w(UnionUnites)45 b
Ff(=)91 2367 y Fe(forA)n(l)t(lStates)25 b Ff(\()p Fc(\025)16
b Fe(vars)46 b Fd(!)220 2450 y Fh(do)297 2533 y Ff(\()p
Fe(v)8 b Ff(1)p Fc(;)14 b Fe(v)8 b Ff(2\))39 b Fd( )f
Fe(two)22 b Ff(\()p Fe(pickElement)j(vars)6 b Ff(\))297
2616 y Fe(c)t Ff(1)39 b Fd( )f Fe(run)24 b Ff(\()p Fe(e)l(quivClass)g
(vars)h(v)8 b Ff(1\))297 2699 y Fe(c)t Ff(2)39 b Fd( )f
Fe(run)24 b Ff(\()p Fe(e)l(quivClass)g(vars)h(v)8 b Ff(2\))297
2782 y Fe(run)24 b Ff(\()p Fe(unionElements)g(v)8 b Ff(1)18
b Fe(v)8 b Ff(2\))297 2865 y Fe(c)t Ff(1)374 2833 y Fb(0)436
2865 y Fd( )38 b Fe(run)23 b Ff(\()p Fe(mapM)29 b(r)l(epr)l(esentative)
e(c)t Ff(1\))297 2948 y Fe(c)t Ff(2)374 2916 y Fb(0)436
2948 y Fd( )38 b Fe(run)23 b Ff(\()p Fe(mapM)29 b(r)l(epr)l(esentative)
e(c)t Ff(2\))297 3031 y Fe(assert)f Ff(\()p Fe(length)e
Ff(\()p Fe(nub)e Ff(\()p Fe(c)t Ff(1)1045 2999 y Fb(0)1085
3031 y Ff(+)-30 b(+)34 b Fe(c)t Ff(2)1286 2999 y Fb(0)1309
3031 y Ff(\)\))26 b(=)-13 b(=)25 b(1\)\))91 3141 y Fh(where)168
3224 y Fe(e)l(quivClass)f(vars)g(v)47 b Ff(=)38 b Fe(\014lterM)30
b Ff(\()p Fd(\021)38 b Fe(v)8 b Ff(\))17 b Fe(vars)168
3307 y(e)6 b Ff(1)39 b Fd(\021)f Fe(e)6 b Ff(2)39 b(=)f
Fe(liftM)12 b Ff(2)k(\()-13 b(=)g(=)g(\))17 b(\()p Fe(r)l(epr)l
(esentative)26 b(e)6 b Ff(1\))986 3390 y(\()p Fe(r)l(epr)l(esentative)
26 b(e)6 b Ff(2\))-152 3540 y(W)-6 b(e)28 b(claim)h(that)f(these)h
(prop)r(erties)g(are)g(easy)f(to)h(read)g(and)f(write.)-152
3623 y(Moreo)n(v)n(er,)33 b(note)e(that)f(w)n(e)h(ha)n(v)n(e)e(tak)n
(en)h(great)h(adv)l(an)n(tage)g(of)g(the)-152 3707 y(monadic)d(prop)r
(ert)n(y)g(language:)41 b(preconditions,)29 b(quan)n(ti\014cations,)
-152 3790 y(and)22 b(computations)g(are)g(thoroughly)g(mixed)f(in)h
(these)g(prop)r(erties.)-40 3873 y(Let)34 b(us)f(test)g(one)h(more)f
(prop)r(ert)n(y:)49 b(the)33 b(\\w)n(eigh)n(t)h(in)n(v)l(arian)n(t")
-152 3956 y(stating)c(that)f(eac)n(h)h(ro)r(ot)f(no)r(de)h(con)n(tains)
f(a)h(w)n(eigh)n(t)g(equal)f(to)g(the)-152 4039 y(n)n(um)n(b)r(er)24
b(of)i(elemen)n(ts)g(whic)n(h)f(it)h(represen)n(ts.)14
4193 y Fe(pr)l(op)p 168 4193 V 34 w(WeightInvariant)46
b Ff(=)91 4276 y Fe(forA)n(l)t(lStates)25 b Ff(\()p Fc(\025)16
b Fe(vars)46 b Fd(!)220 4359 y Fh(do)297 4442 y Fe(v)h
Fd( )38 b Fe(pickElement)25 b(vars)297 4525 y(r)8 b Ff(@\()p
Fe(Element)p 729 4525 V 69 w(link)g Ff(\))38 b Fd( )g
Fe(run)24 b Ff(\()p Fe(r)l(epr)l(esentative)i(v)8 b Ff(\))297
4608 y Fe(Weight)25 b(w)46 b Fd( )38 b Fe(run)24 b Ff(\()p
Fe(r)l(e)l(adSTR)l(ef)34 b(link)8 b Ff(\))297 4691 y
Fe(rs)45 b Fd( )38 b Fe(run)24 b Ff(\()p Fe(mapM)29 b(r)l(epr)l
(esentative)d(vars)6 b Ff(\))297 4774 y Fe(assert)26
b Ff(\()p Fe(w)17 b Ff(=)-13 b(=)25 b Fe(length)f Ff(\()p
Fe(\014lter)i Ff(\()-13 b(=)g(=)25 b Fe(r)8 b Ff(\))17
b Fe(rs)6 b Ff(\)\)\))-152 4924 y(This)30 b(prop)r(ert)n(y)d(is)j(not)e
(necessary)h(for)h(correctness,)g(but)e(it)h(is)g(for)-152
5007 y(e\016ciency)-6 b(.)36 b(Surprisingly)-6 b(,)27
b(when)f(w)n(e)h Fe(quickChe)l(ck)36 b Ff(it,)27 b(it)f(fails!)38
b(Af-)-152 5090 y(ter)26 b(a)g(few)h(tries)f(to)g(\014nd)e(a)i(small)g
(coun)n(ter-example,)f(w)n(e)h(\014nd)14 5245 y Fe(UnionFind)j
Fc(>)38 b Fe(quickChe)l(ck)27 b(pr)l(op)p 1049 5245 V
33 w(WeightInvariant)2206 -69 y(F)-6 b(alsi\014able)6
b Fc(;)30 b Fe(after)c Ff(3)18 b Fe(tests)29 b Ff(:)2206
14 y([)p Fe(NewElement)7 b Fc(;)14 b Fe(UnionElements)25
b Ff(0)17 b(0])2206 97 y(0)2040 249 y(This)23 b(tells)h(us)f(that)f
(the)g(w)n(eigh)n(t)i(of)f(elemen)n(t)f(0)h(is)g(wrong)h(after)f(it)g
(is)2040 332 y(unioned)28 b(with)g(itself.)43 b(Insp)r(ecting)27
b(the)h(co)r(de)g(of)h Fe(unionElements)7 b Ff(,)2040
415 y(w)n(e)23 b(quic)n(kly)e(see)i(wh)n(y:)33 b(w)n(e)23
b(forgot)g(to)g(consider)g(the)f(case)i(when)e(the)2040
498 y(t)n(w)n(o)i(argumen)n(ts)f Fe(ar)l(e)j(alr)l(e)l(ady)h(e)l
(quivalent)p Ff(.)35 b(In)23 b(that)h(case,)h(w)n(e)f(need)2040
581 y(do)31 b(nothing)g(|)f(and)h(in)f(particular,)k(the)c(w)n(eigh)n
(t)h(should)g(not)g(b)r(e)2040 664 y(up)r(dated.)50 b(Adding)30
b(this)h(sp)r(ecial)h(case)g(mak)n(es)e(all)i(prop)r(erties)g(go)2040
748 y(through.)2040 942 y Fh(12)89 b(T)-7 b(esting)110
b(a)g(Mo)r(del-based)h(Sp)r(eci\014cation)h(of)2217 1025
y(Union/Find)2040 1182 y Ff(Just)30 b(as)g(w)n(e)f(tested)h(queues)e
(using)i(a)f(sp)r(eci\014cation)i(based)e(on)h(an)2040
1265 y(abstract)35 b(mo)r(del,)h(w)n(e)f(can)f(test)g(the)g(Union/Find)
g(algorithm)h(in)2040 1348 y(the)e(same)g(w)n(a)n(y)-6
b(.)58 b(W)-6 b(e)33 b(shall)i(mo)r(del)e(elemen)n(ts)g(b)n(y)f
(natural)i(n)n(um-)2040 1431 y(b)r(ers)e(in)g(the)f(range)h(0)14
b Fc(:)f(:)g(:)g Fe(k)8 b Ff(,)34 b(and)d(the)g(state)i(b)n(y)d(a)i
(function)g Fe(r)l(epr)2040 1514 y Ff(from)26 b Fd(f)p
Ff(0)13 b Fc(:)g(:)h(:)f Fe(k)8 b Fd(g)26 b Ff(to)g(itself,)i(whic)n(h)
e(maps)f(elemen)n(ts)g(to)h(their)g(repre-)2040 1597
y(sen)n(tativ)n(e.)34 b(W)-6 b(e)24 b(can)h(con)n(v)n(enien)n(tly)f
(represen)n(t)g(suc)n(h)g(a)h(function)g(in)2040 1680
y(Hask)n(ell)h(b)n(y)f(a)h(list)h(\(so)f(w)n(e)g(apply)f(it)h(to)g(an)g
(elemen)n(t)f Fe(x)35 b Ff(b)n(y)25 b(writing)2040 1763
y Fe(r)l(epr)18 b Ff(!!)26 b Fe(x)10 b Ff(\).)39 b(W)-6
b(e)27 b(de\014ne)f(an)h(abstraction)i(function)e(to)h(reco)n(v)n(er)f
(the)2040 1846 y(abstract)f(state.)2206 1998 y Fe(abstr)l(act)201
b Ff(::)31 b([)p Fe(Element)25 b(a)e(b)5 b Ff(])39 b
Fd(!)f Fe(ST)27 b(a)c Ff([)p Fe(Int)7 b Ff(])2206 2081
y Fe(abstr)l(act)27 b(vars)i Ff(=)21 b Fe(mapM)29 b(abs)24
b(vars)2283 2164 y Fh(where)2360 2247 y Fe(abs)g(v)46
b Ff(=)39 b Fh(do)2745 2330 y Fe(r)47 b Fd( )38 b Fe(r)l(epr)l
(esentative)27 b(v)2745 2413 y(r)l(eturn)e Ff(\()p Fe(p)l(osition)f
(vars)g(r)8 b Ff(\))2040 2561 y(where)26 b Fe(p)l(osition)32
b Ff(returns)26 b(the)f(p)r(osition)i(of)f(an)g(elemen)n(t)f(in)g(a)h
(list.)2152 2644 y(The)19 b(abstract)g(state)g(m)n(ust)e(satisfy)i(an)g
(in)n(v)l(arian)n(t:)30 b Fe(r)l(epr)44 b Fd(\016)34
b Fe(r)l(epr)2040 2727 y Ff(m)n(ust)24 b(equal)i Fe(r)l(epr)9
b Ff(.)35 b(W)-6 b(e)25 b(write)2206 2879 y Fe(pr)l(op)p
2360 2879 V 34 w(Invariant)46 b Ff(=)38 b Fe(forA)n(l)t(lStates)24
b Ff(\()p Fc(\025)17 b Fe(vars)46 b Fd(!)2300 2962 y
Fh(do)2377 3045 y Fe(r)l(epr)h Fd( )39 b Fe(run)23 b
Ff(\()p Fe(abstr)l(act)k(vars)6 b Ff(\))2377 3128 y Fe(assert)26
b Ff(\()p Fe(r)l(epr)35 b Ff(=)-13 b(=)25 b Fe(map)d
Ff(\()p Fe(r)l(epr)c Ff(!!)-13 b(\))17 b Fe(r)l(epr)8
b Ff(\)\))2152 3280 y(No)n(w,)33 b(notice)e(that)f(\(as)h(far)g(as)g
(correctness)h(is)f(concerned\))f(it)2040 3363 y(do)r(es)39
b(not)f(matter)f(whether)h Fe(union)45 b Ff(mak)n(es)37
b(its)i(\014rst)f(argumen)n(t)2040 3446 y(p)r(oin)n(t)k(to)g(its)g
(second,)k(or)c(vice)g(v)n(ersa.)82 b(Rather)42 b(than)f(sp)r(ecify)
2040 3529 y(this)26 b(b)r(eha)n(viour)f(exactly)-6 b(,)26
b(w)n(e)g(shall)h(use)f Fe(r)l(elational)g Ff(sp)r(eci\014cations)2040
3612 y(whic)n(h)37 b(lea)n(v)n(e)h(some)e(freedom)h(to)g(the)g
(implemen)n(tor.)67 b(Th)n(us)37 b(w)n(e)2040 3695 y(sp)r(ecify)c(our)f
(op)r(erations)h(via)f(a)h Fe(pr)l(e)l(dic)l(ate)h Ff(whic)n(h)e(m)n
(ust)f(hold)h(on)2040 3778 y(the)24 b(inputs,)g(initial)h(state,)g
(output,)e(and)h(\014nal)g(state,)h(rather)f(than)2040
3861 y(b)n(y)36 b(giving)i(a)f(function)g(from)g(the)f(former)h(to)h
(the)e(latter.)69 b(The)2040 3945 y(sp)r(eci\014cations)27
b(of)g Fe(\014nd)33 b Ff(and)26 b Fe(union)31 b Ff(are)c(easy)e(to)h
(write:)2206 4097 y Fe(\014ndS)h(x)f(r)l(epr)g(y)e(r)l(epr)2825
4065 y Fb(0)2888 4097 y Ff(=)2283 4180 y Fe(r)l(epr)18
b Ff(=)-13 b(=)25 b Fe(r)l(epr)2709 4148 y Fb(0)2767
4180 y Fd(^)34 b Fe(y)f Ff(=)-13 b(=)25 b Fe(r)l(epr)18
b Ff(!!)26 b Fe(x)2206 4263 y(unionS)g(x)h(y)d(r)l(epr)i
Ff(\(\))17 b Fe(r)l(epr)2967 4231 y Fb(0)3029 4263 y
Ff(=)2300 4346 y Fh(let)2377 4429 y Fe(z)48 b Ff(=)38
b Fe(r)l(epr)2696 4397 y Fb(0)2728 4429 y Ff(!!)26 b
Fe(x)2300 4512 y Fh(in)2300 4595 y Ff(\()p Fe(z)35 b
Ff(=)-13 b(=)25 b Fe(r)l(epr)18 b Ff(!!)26 b Fe(x)44
b Fd(_)34 b Fe(z)i Ff(=)-13 b(=)25 b Fe(r)l(epr)18 b
Ff(!!)26 b Fe(y)7 b Ff(\))17 b Fd(^)2300 4678 y Fe(r)l(epr)2442
4646 y Fb(0)2491 4678 y Ff(=)-13 b(=)26 b([)17 b Fh(if)26
b Fe(z)2779 4646 y Fb(0)2811 4678 y Ff(=)-13 b(=)25 b
Fe(r)l(epr)18 b Ff(!!)26 b Fe(x)g Fd(_)35 b Fe(z)3350
4646 y Fb(0)3381 4678 y Ff(=)-13 b(=)26 b Fe(r)l(epr)17
b Ff(!!)27 b Fe(y)d Fh(then)2739 4761 y Fe(z)2662 4844
y Fh(else)2739 4927 y Fe(z)2779 4895 y Fb(0)2819 4927
y Fd(j)17 b Fe(z)2897 4895 y Fb(0)2942 4927 y Fc(<)k
Fd(\000)p Fe(r)l(epr)8 b Ff(])2040 5079 y(These)26 b(sp)r
(eci\014cations)h(closely)g(resem)n(ble)f(Z)f(sc)n(hemas)g([11)r(].)
2152 5162 y(W)-6 b(e)24 b(de\014ne)g(a)g(com)n(binator)g(expressing)h
(that)f(a)h(monadic)f(com-)2040 5245 y(putation)i(implemen)n(ts)d(suc)n
(h)j(a)g(sp)r(eci\014cation:)1921 5494 y(9)p eop
%%Page: 10 10
10 9 bop 14 -69 a Fe(implements)24 b(vars)g(m)f(s)45
b Ff(=)108 14 y Fh(do)185 97 y Fe(r)l(epr)j Fd( )38 b
Fe(run)24 b Ff(\()p Fe(abstr)l(act)i(vars)6 b Ff(\))185
180 y Fe(ans)45 b Fd( )38 b Fe(run)24 b(m)185 263 y(r)l(epr)327
232 y Fb(0)389 263 y Fd( )38 b Fe(run)24 b Ff(\()p Fe(abstr)l(act)j
(vars)6 b Ff(\))185 346 y Fe(assert)26 b Ff(\()p Fe(s)e(r)l(epr)i(ans)e
(r)l(epr)928 315 y Fb(0)951 346 y Ff(\))-40 484 y(No)n(w)48
b(it)f(only)f(remains)h(to)g(state)h(that)e Fe(\014ndElement)55
b Ff(and)-152 567 y Fe(unionElements)41 b Ff(implemen)n(t)32
b(the)h(sp)r(eci\014cations)i(ab)r(o)n(v)n(e,)h(for)f(all)-152
650 y(c)n(hoices)c(of)f(elemen)n(ts.)46 b(The)29 b(only)h(\(sligh)n
(t\))g(complication)g(is)g(that)-152 733 y(w)n(e)i(m)n(ust)e(con)n(v)n
(ert)h(elemen)n(ts)g(from)g(their)g(concrete)h(to)g(their)f(ab-)-152
817 y(stract)43 b(represen)n(tation)g(\(using)f Fe(p)l(osition)24
b(vars)7 b Ff(\))42 b(b)r(efore)h(w)n(e)g(can)-152 900
y(compare)26 b(implemen)n(tation)e(and)h(sp)r(eci\014cation.)14
1042 y Fe(pr)l(op)p 168 1042 24 4 v 34 w(Find)46 b Ff(=)38
b Fe(forA)n(l)t(lStates)24 b Ff(\()p Fc(\025)17 b Fe(vars)46
b Fd(!)108 1125 y Fh(do)185 1208 y Fe(v)h Fd( )38 b Fe(pickElement)25
b(vars)185 1291 y(implements)e(vars)374 1374 y Ff(\()p
Fe(liftM)28 b Ff(\()p Fe(p)l(osition)23 b(vars)6 b Ff(\))18
b(\()p Fe(\014ndElement)25 b(v)8 b Ff(\)\))374 1457 y(\()p
Fe(\014ndS)26 b Ff(\()p Fe(p)l(osition)e(vars)g(v)8 b
Ff(\)\)\))14 1567 y Fe(pr)l(op)p 168 1567 V 34 w(Union)44
b Ff(=)38 b Fe(forA)n(l)t(lStates)25 b Ff(\()p Fc(\025)16
b Fe(vars)46 b Fd(!)108 1650 y Fh(do)185 1733 y Ff(\()p
Fe(v)8 b Fc(;)13 b Fe(v)335 1701 y Fb(0)358 1733 y Ff(\))38
b Fd( )g Fe(two)23 b Ff(\()p Fe(pickElement)i(vars)6
b Ff(\))185 1816 y Fe(implements)23 b(vars)374 1899 y
Ff(\()p Fe(unionElements)h(v)h(v)1025 1867 y Fb(0)1048
1899 y Ff(\))374 1982 y(\()p Fe(unionS)h Ff(\()p Fe(p)l(osition)d(vars)
i(v)8 b Ff(\))17 b(\()p Fe(p)l(osition)24 b(vars)g(v)1746
1950 y Fb(0)1769 1982 y Ff(\)\)\))-40 2120 y(This)d(completes)f(the)f
(mo)r(del-based)g(sp)r(eci\014cation:)33 b(it)20 b(is)g(pleas-)-152
2203 y(ingly)33 b(simple.)54 b(Indeed,)34 b(mo)r(del-based)e(sp)r
(eci\014cations)h(are)g(often)-152 2286 y(simpler)f(than)g(pre-)g(and)g
(p)r(ostcondition)h(sp)r(eci\014cations)g(suc)n(h)f(as)-152
2369 y(w)n(e)24 b(ga)n(v)n(e)f(in)h(the)f(previous)g(section,)i(since)f
(the)e(latter)i(are)g(couc)n(hed)-152 2452 y(in)36 b(terms)e(of)i(the)f
(\(generally)h(more)f(complex\))f(implemen)n(tation)-152
2535 y(state.)59 b(So)33 b(wh)n(y)g(not)g(alw)n(a)n(ys)i(use)e(mo)r
(del-based)g(sp)r(eci\014cations?)-152 2618 y(Firstly)-6
b(,)22 b(it)f(is)g(useful)g(to)f(b)r(e)h Fe(able)f Ff(to)h(test)g(pre-)
e(and)h(p)r(ostconditions,)-152 2701 y(since)f(in)e(some)h(cases)g(one)
g(ma)n(y)f(just)h(wish)g(to)g(test)g(a)g(few)g(suc)n(h)f(prop-)-152
2784 y(erties)j(without)f(going)h(to)f(the)g(trouble)g(of)h(de\014ning)
e(a)i(complete)e(ab-)-152 2867 y(stract)k(mo)r(del.)33
b(Secondly)-6 b(,)22 b(b)r(ecause)g(the)f(pre-)g(and)g(p)r
(ost-condition)-152 2950 y(st)n(yle)34 b(is)h(expressed)f(en)n(tirely)g
(in)g(terms)g(of)g(the)g(implemen)n(tation)-152 3033
y(state,)g(these)d(prop)r(erties)h(can)g(often)g(b)r(e)f(tested)g(more)
g(e\016cien)n(tly)-152 3116 y(than)d(those)g(in)f(the)h(mo)r(del-based)
f(st)n(yle)h(\(although)g(sp)r(eed)g(is)g(not)-152 3199
y(a)e(problem)f(in)h(these)f(examples\).)-152 3392 y
Fh(13)89 b(A)45 b(General)h(Mo)r(del-Based)g(Sp)r(eci\014cation)h(F)-7
b(rame-)25 3475 y(w)n(ork)-152 3632 y Ff(F)h(ully)59
b(formal)h(sp)r(eci\014cations)h(can)f(b)r(ecome)f(quite)g(complex)-152
3715 y(\(whether)19 b(they)e(are)i(used)g(for)g(testing)g(or)g(an)n(y)f
(other)h(purp)r(ose\).)32 b(An)-152 3798 y(adv)l(an)n(tage)e(of)h
(represen)n(ting)f(them)f(in)h(a)g(language)i(lik)n(e)e(Hask)n(ell,)
-152 3881 y(with)c(p)r(o)n(w)n(erful)h(abstraction)g(mec)n(hanisms,)d
(is)j(that)e(w)n(e)h(can)g(hop)r(e)-152 3964 y(to)20
b(\014nd)e(\\higher-lev)n(el)i(com)n(binators")g(whic)n(h)f(mak)n(e)f
(sp)r(eci\014cations)-152 4047 y(easier)32 b(to)e(write.)48
b(In)29 b(this)h(section)h(w)n(e)f(sk)n(etc)n(h)f(an)h(initial)h(step)f
(in)-152 4130 y(this)24 b(direction:)34 b(a)23 b(library)h(for)g(mo)r
(del-based)f(sp)r(eci\014cation)i(of)f(im-)-152 4213
y(p)r(erativ)n(e)j(ADTs,)g(whic)n(h)f(w)n(e)h(apply)f(to)g(the)g(queue)
g(example)f(once)-152 4296 y(more.)-40 4379 y(The)32
b(library)f(is)g(based)g(on)g(t)n(w)n(o)g(abstract)h(t)n(yp)r(es,)g
(the)e(\014rst)h(of)-152 4462 y(whic)n(h)26 b(is)14 4604
y Fh(data)18 b Fe(A)l(ction)24 b(m)e(sp)l(e)l(c)h(impl)45
b Ff(=)38 b Fc(:)13 b(:)g(:)-152 4747 y Ff(An)29 b(elemen)n(t)g(of)i
(this)e(t)n(yp)r(e)g(represen)n(ts)h(a)g(concrete)g(op)r(eration)h(in)
-152 4830 y(the)26 b(monad)e Fe(m)6 b Ff(,)26 b(that)f(w)n(orks)h(on)g
(an)g(implemen)n(tation)e(t)n(yp)r(e)h Fe(impl)7 b Ff(,)-152
4913 y(and)21 b(has)g(an)f(abstract)h(functional)h(coun)n(terpart)e(of)
i(t)n(yp)r(e)d Fe(sp)l(e)l(c)6 b Ff(.)33 b(F)-6 b(or)-152
4996 y(example,)28 b(in)g(the)f(case)i(of)g(queues,)f
Fe(m)33 b Ff(is)28 b(the)g(monad)e Fe(ST)h(s)7 b Ff(,)28
b Fe(sp)l(e)l(c)-152 5079 y Ff(is)k(the)e(t)n(yp)r(e)g([)p
Fe(Int)7 b Ff(])q(,)32 b(and)e Fe(impl)38 b Ff(is)31
b(the)f(t)n(yp)r(e)g Fe(Queue)24 b(s)f(Int)7 b Ff(;)34
b(an)d(ac-)-152 5162 y(tion)26 b(migh)n(t)e(represen)n(t)h(the)g(op)r
(eration)h Fe(add)g Ff(23)q(.)34 b(Ho)n(w)n(ev)n(er,)25
b(an)h(ac-)-152 5245 y(tion)j(con)n(tains)h(b)r(oth)e(the)h(sp)r
(eci\014cation)h(and)e(implemen)n(tation)g(of)2040 -69
y(an)f(op)r(eration,)h(and)e(when)g(executed,)g(tests)h(if)g(the)f
(observ)l(ational)2040 14 y(outputs)36 b(of)h(the)f(action)h(are)f(the)
g(same.)66 b(In)36 b(the)g(queue)f(exam-)2040 97 y(ple,)e(w)n(e)e(c)n
(hec)n(k)g(that)f(all)i(calls)h(to)e(the)f(implemen)n(tation)g(of)i
Fe(fr)l(ont)2040 180 y Ff(pro)r(duce)27 b(the)g(same)g(answ)n(er)h(as)g
(the)f(sp)r(eci\014cation)h(|)f(this)h(is)g(our)2040
263 y(correctness)f(criterion.)2152 346 y(The)f(function)2206
494 y Fe(sameOutput)47 b Ff(::)40 b([)p Fe(A)l(ction)24
b(m)e(sp)l(e)l(c)h(impl)8 b Ff(])37 b Fd(!)h Fe(m)23
b(Bo)l(ol)2040 642 y Ff(executes)f(a)h(list)g(of)g(actions)g(in)f
(sequence,)h(th)n(us)e(c)n(hec)n(king)h(that)g(the)2040
725 y(observ)l(able)k(outputs)f(of)i(all)f(actions)h(are)f(the)f(same.)
2152 808 y(The)h(second)g(abstract)g(t)n(yp)r(e)f(is)2206
955 y Fh(data)18 b Fe(Metho)l(d)26 b(m)c(sp)l(e)l(c)h(impl)45
b Ff(=)38 b Fc(:)13 b(:)g(:)2040 1103 y Ff(A)32 b Fe(Metho)l(d)42
b Ff(represen)n(ts)32 b(an)h Fe(A)l(ction)39 b Ff(generator)33
b(|)g(for)g(example,)2040 1186 y(corresp)r(onding)25
b(to)f Fe(add)8 b Ff(,)25 b(from)e(whic)n(h)h(the)f Fe(A)l(ction)31
b(add)25 b Ff(23)g(can)f(b)r(e)2040 1269 y(generated.)33
b(Metho)r(ds)20 b(are)h(constructed)e(using)h(metho)r(d)f(com)n(bina-)
2040 1352 y(tors,)25 b(as)g(in)f(this)g(example,)g(whic)n(h)g(sp)r
(eci\014es)h(the)f(queue)f(metho)r(ds:)2206 1582 y Fe(metho)l(ds)p
2484 1582 V 35 w(Queue)45 b Ff(::)39 b([)p Fe(Metho)l(d)27
b Ff(\()p Fe(ST)f(s)6 b Ff(\))18 b([)p Fe(Int)7 b Ff(])18
b(\()p Fe(Queue)23 b(s)g(Int)7 b Ff(\)])2206 1665 y Fe(metho)l(ds)p
2484 1665 V 35 w(Queue)45 b Ff(=)2283 1748 y([)p Fe(name)23
b Ff(")p Fe(empty)7 b Ff(")19 b($)e Fe(metho)l(dInit)25
b Ff([)13 b(])18 b Fe(empty)7 b Fc(;)2304 1831 y Fe(name)23
b Ff(")p Fe(add)8 b Ff(")18 b($)g Fe(ar)l(g)25 b(arbitr)l(ary)g
Ff($)18 b Fc(\025)p Fe(x)47 b Fd(!)2493 1914 y Fe(metho)l(d)8
b Ff(1)18 b Fe(add)2910 1922 y Fa(S)2971 1914 y Fe(add)8
b Fc(;)2321 1997 y Fe(name)23 b Ff(")p Fe(fr)l(ont)7
b Ff(")19 b($)f Fe(metho)l(d)8 b Ff(1)18 b Fe(fr)l(ont)3300
2005 y Fa(S)3360 1997 y Fe(fr)l(ont)7 b Fc(;)2304 2080
y Fe(name)23 b Ff(")p Fe(r)l(emove)6 b Ff(")19 b($)2493
2163 y Fe(metho)l(d)8 b Ff(1)p Fe(Pr)l(e)25 b Ff(\()p
Fe(not)g Fc(:)17 b Fe(nul)t(l)8 b Ff(\))16 b Fe(r)l(emove)3532
2171 y Fa(S)3593 2163 y Fe(r)l(emove)6 b Ff(])2040 2311
y(Here,)35 b Fe(name)k Ff(sp)r(eci\014es)33 b(the)g(name)f(of)h(an)g
(op)r(erator)h(\(for)f(debug-)2040 2394 y(ging)27 b(output\).)37
b(The)27 b(metho)r(d)e(constructor)i Fe(metho)l(dInit)35
b Ff(sp)r(eci\014es)2040 2477 y(a)19 b(metho)r(d)f(that)h(creates)h(an)
f(ob)t(ject,)i Fe(metho)l(d)8 b Ff(1)21 b(sp)r(eci\014es)e(a)h(metho)r
(d)2040 2560 y(that)26 b(transforms)g(one)h(ob)t(ject,)g
Fe(metho)l(d)8 b Ff(1)p Fe(Pr)l(e)34 b Ff(sp)r(eci\014es)26
b(a)h(metho)r(d)2040 2643 y(that)33 b(has)f(a)i(precondition,)h(and)d
(there)g(are)i(other)e(metho)r(d)g(con-)2040 2726 y(structors.)i(The)24
b(metho)r(d)f(com)n(binator)g Fe(ar)l(g)32 b Ff(is)24
b(used)f(to)h(sp)r(ecify)h(an)2040 2809 y(argumen)n(t)g(to)h(a)g(metho)
r(d.)2152 2892 y(Giv)n(en)20 b(suc)n(h)f(a)h(list)g(of)g(metho)r(ds,)h
(w)n(e)f(can)f(generate)i(random)e(se-)2040 2975 y(quences)i(of)h
(actions)g(whic)n(h)f(corresp)r(ond)h(to)f(calls)h(of)g(the)f(metho)r
(ds.)2040 3058 y(This)26 b(is)h(done)e(b)n(y)g(the)g(generator)i
Fe(actions)7 b Ff(:)2206 3206 y Fe(actions)46 b Ff(::)39
b([)p Fe(Metho)l(d)26 b(m)d(sp)l(e)l(c)f(impl)8 b Ff(])38
b Fd(!)2924 3289 y Fe(Gen)24 b Ff([)p Fe(A)l(ction)g(m)e(sp)l(e)l(c)h
(impl)8 b Ff(])2040 3432 y(Note)34 b(that)f(the)h(list)g(of)h(the)e
(list)h(of)h(metho)r(ds)e(denotes)h(a)g Fe(choic)l(e)2040
3515 y Ff(of)27 b(metho)r(ds,)f(whereas)i(the)e(list)h(in)f(the)g(list)
h(of)g(actions)h(denotes)e(a)2040 3598 y Fe(se)l(quenc)l(e)i
Ff(of)e(actions.)2152 3681 y(Finally)-6 b(,)21 b(w)n(e)e(c)n(hec)n(k)f
(that)g(all)i(generated)f(action)g(sequences)g(pro-)2040
3764 y(duce)28 b(the)h(same)f(output)g(in)h(the)f(abstract)i(and)e
(concrete)i(seman-)2040 3847 y(tics.)35 b(This)27 b(is)f(done)f(b)n(y)g
(the)g(function)h Fe(c)l(ommutes)7 b Ff(:)2206 3995 y
Fe(c)l(ommutes)46 b Ff(::)39 b([)p Fe(Metho)l(d)26 b(m)d(sp)l(e)l(c)f
(impl)8 b Ff(])38 b Fd(!)g Fe(Pr)l(op)l(ertyM)31 b(m)23
b Ff(\(\))2206 4078 y Fe(c)l(ommutes)i(metho)l(ds)46
b Ff(=)2283 4161 y Fe(forA)n(l)t(lM)28 b Ff(\()p Fe(actions)c(metho)l
(ds)6 b Ff(\))19 b($)e Fc(\025)p Fe(acts)46 b Fd(!)2412
4244 y Fh(do)2489 4327 y Fe(b)d Fd( )38 b Fe(sameOutput)26
b(acts)2489 4410 y(assert)g(b)2040 4535 y Ff(Notice)21
b(that,)h(in)f(monadic)f(prop)r(erties,)j(w)n(e)e Fe(c)l(an)g
Ff(quan)n(tify)f(o)n(v)n(er)h(the)2040 4618 y(seman)n(tics)31
b(of)i(actions)f(|)f(the)g(\\rank-3")h(problem)f(discussed)h(in)2040
4701 y(section)27 b(6)f(is)g(a)n(v)n(oided.)2152 4784
y(Using)31 b(the)g(library)-6 b(,)32 b(a)g(full)f(correctness)h(sp)r
(eci\014cation)g(of)g(the)2040 4867 y(queue)25 b(example)g(lo)r(oks)h
(lik)n(e)g(this:)2206 5014 y Fe(pr)l(op)p 2360 5014 V
34 w(Queue)44 b Ff(=)38 b Fe(imp)l(er)l(ative)24 b Ff(\()p
Fe(c)l(ommutes)g(metho)l(ds)p 3765 5014 V 36 w(Queue)6
b Ff(\))2040 5162 y(T)-6 b(ogether)26 b(with)g(the)f(de\014nition)g(of)
h Fe(metho)l(ds)p 3375 5162 V 35 w(Queue)7 b Ff(,)25
b(this)h(is)g(only)2040 5245 y(a)g(few)h(lines.)1902
5494 y(10)p eop
%%Page: 11 11
11 10 bop -152 -69 a Fh(14)89 b(Related)30 b(W)-7 b(ork)-152
88 y Ff(There)38 b(are)g(t)n(w)n(o)g(other)f(automated)g(testing)h(to)r
(ols)h(for)f(Hask)n(ell.)-152 171 y(HUnit)19 b(is)h(a)g(unit)f(testing)
h(framew)n(ork)g(based)g(on)f(the)h(JUnit)f(frame-)-152
254 y(w)n(ork)25 b(for)g(Ja)n(v)l(a,)g(whic)n(h)g(p)r(ermits)f(test)g
(cases)i(to)e(b)r(e)h(structured)e(hi-)-152 337 y(erarc)n(hically)29
b(in)n(to)f(tests)g(whic)n(h)g(can)f(b)r(e)h(run)f(automatically)h([12)
q(].)-152 420 y(HUnit)36 b(allo)n(ws)j(the)d(programmer)g(to)h
(de\014ne)f(\\assertions",)43 b(but)-152 503 y(these)36
b(apply)f(only)g(to)g(a)h(particular)g(test)g(case,)j(and)c(so)h(do)f
(not)-152 586 y(mak)n(e)28 b(up)g(a)h(sp)r(eci\014cation.)45
b(There)29 b(is)g(no)g(automatic)g(generation)-152 670
y(of)e(test)f(cases.)-40 753 y(Auburn)45 b([18)q(])i(is)g(a)g(to)r(ol)g
(primarily)f(in)n(tended)g(for)h(b)r(enc)n(h-)-152 836
y(marking)54 b(abstract)g(data)g(t)n(yp)r(es.)119 b(Auburn)52
b(generates)j(ran-)-152 919 y(dom)26 b(\\datat)n(yp)r(e)g(usage)i
(graphs")f(\(dugs\),)g(corresp)r(onding)g(to)g(our)-152
1002 y(\\queue)32 b(programs")i(etc,)h(and)d(measures)g(the)h(time)f
(to)h(ev)l(aluate)-152 1085 y(them.)46 b(Auburn)29 b(can)h(pro)r(duce)f
(dug)h(generators)h(and)f(ev)l(aluators)-152 1168 y(automatically)-6
b(,)41 b(giv)n(en)d(the)f(signature)h(of)h(the)e(ADT.)g(It)h(a)n(v)n
(oids)-152 1251 y(generating)27 b(ill-formed)f(dugs)g(b)n(y)e(trac)n
(king)i(an)g(abstract)g(state,)g(or)-152 1334 y(\\shado)n(w",)h(for)e
(eac)n(h)g(v)l(alue)f(of)h(the)f(ADT,)h(and)f(c)n(hec)n(king)g(precon-)
-152 1417 y(ditions)f(expressed)g(in)f(terms)g(of)h(it)g(b)r(efore)g
(applying)g(an)f(op)r(erator.)-152 1500 y(Dug)27 b(generators)h(are)g
(parameterised)f(on)g(the)f(desired)i(frequency)-152
1583 y(of)21 b(the)e(di\013eren)n(t)g(op)r(erations,)k(size)d(of)h
(data)f(to)g(generate,)i(degree)e(of)-152 1666 y(sharing)25
b(etc,)g(so)g(that)g(b)r(enc)n(hmarking)e(corresp)r(onds)i(as)g
(closely)g(as)-152 1749 y(p)r(ossible)i(to)f(real)h(conditions.)35
b(Benc)n(hmarking)25 b(can)h(rev)n(eal)g(errors)-152
1832 y(in)33 b(the)e(ADT)h(implemen)n(tation,)h(but)f(since)h(there)f
(is)h(no)f(sp)r(eci\014-)-152 1915 y(cation)e(or)g(other)f(test)h
(oracle)h(then)d(they)h(are)h(disco)n(v)n(ered)f(only)g(if)-152
1998 y(they)c(lead)h(to)g(run-time)e(failure.)-40 2081
y(The)i(Hat)f(tracer)h(for)g(Hask)n(ell)g([25)q(])g(is)g(not)f(a)h
(testing)g(to)r(ol,)h(but)-152 2164 y(enables)19 b(the)f(programmer)f
(to)h(bro)n(wse)h(a)f(computation)g(once)g(it)g(has)-152
2247 y(failed.)36 b(W)-6 b(e)25 b(are)i(in)n(v)n(estigating)f(in)n
(tegrating)h(it)f(with)g Fg(QuickCheck)p Ff(,)-152 2330
y(so)47 b(that)f(the)g(tracer)h(w)n(ould)g(b)r(e)f(en)n(tered)g
(immediately)f(when)-152 2413 y Fg(QuickCheck)24 b Ff(disco)n(v)n(ers)i
(a)g(fault.)-40 2496 y(The)g(more)f(general)i(testing)f(literature)h
(is)f(v)n(oluminous.)-40 2579 y(Random)j(testing)h(dates)g(from)g(the)f
(1960s,)k(and)d(is)g(no)n(w)g(used)-152 2662 y(commercially)-6
b(,)39 b(esp)r(ecially)g(when)d(the)g(distribution)h(of)h(random)-152
2745 y(data)27 b(can)g(b)r(e)g(c)n(hosen)f(to)h(matc)n(h)f(that)g(of)i
(the)e(real)i(data.)38 b(It)26 b(com-)-152 2828 y(pares)41
b(surprisingly)g(fa)n(v)n(ourably)g(in)f(practice)h(with)g(systematic)
-152 2911 y(c)n(hoice)31 b(of)g(test)g(cases.)50 b(In)29
b(1984,)k(Duran)d(and)g(Ntafos)h(compared)-152 2994 y(the)22
b(fault)g(detection)g(probabilit)n(y)g(of)h(random)e(testing)h(with)g
(parti-)-152 3077 y(tion)i(testing,)h(and)e(disco)n(v)n(ered)h(that)f
(the)g(di\013erences)h(in)f(e\013ectiv)n(e-)-152 3160
y(ness)35 b(w)n(ere)h(small)f([6)q(].)62 b(Hamlet)34
b(and)h(T)-6 b(a)n(ylor)35 b(corrob)r(orated)h(the)-152
3243 y(original)f(results)e([10)q(].)56 b(Although)33
b(partition)g(testing)g(is)g(sligh)n(tly)-152 3326 y(more)e(e\013ectiv)
n(e)g(at)g(exp)r(osing)g(faults,)j(to)d(quote)f(Hamlet's)h(excel-)-152
3409 y(len)n(t)j(surv)n(ey)g([9)q(],)j Fe(\\By)f(taking)g(20\045)g(mor)
l(e)g(p)l(oints)g(in)f(a)h(r)l(andom)-152 3492 y(test,)28
b(any)g(advantage)h(a)e(p)l(artition)h(test)g(might)g(have)f(had)h(is)f
(wip)l(e)l(d)-152 3575 y(out.")49 b Ff(Our)29 b(philosoph)n(y)h(is)h
(to)f(apply)g(random)f(testing)i(at)f(a)g(\014ne)-152
3658 y(grain,)25 b(b)n(y)d(sp)r(ecifying)i(prop)r(erties)g(of)g(most)f
(functions)g(under)f(test.)-152 3741 y(So)e(ev)n(en)g(when)g
Fg(QuickCheck)e Ff(is)i(used)g(to)g(test)g(a)h(large)g(program,)g(w)n
(e)-152 3824 y(alw)n(a)n(ys)30 b(test)f(a)g(small)g(part)g(at)f(a)h
(time,)h(and)e(are)h(therefore)h(lik)n(ely)-152 3907
y(to)c(exercise)h(eac)n(h)e(part)h(of)g(the)g(co)r(de)g(thoroughly)-6
b(.)-40 3990 y(In)n(v)n(oking)34 b(sequences)h(of)h(op)r(erations)g(to)
f(test)g(abstract)h(data)-152 4073 y(t)n(yp)r(es)28 b(is)i(a)f
(standard)f(approac)n(h)h(\(ho)n(w)g(else)g(could)g(it)g(b)r(e)g
(done?\).)-152 4156 y(Generating)g(random)f(sequences)g(of)h(op)r
(erations,)h(while)f(still)h(ful-)-152 4239 y(\014lling)j(all)h
(preconditions,)g(is)f(not)f(so)h(common.)53 b(Our)32
b(test)h(data)-152 4322 y(generation)26 b(language,)h(em)n(b)r(edded)c
(in)i(Hask)n(ell,)h(mak)n(es)e(this)i(easy)-6 b(.)-152
4406 y(The)30 b(connection)g(w)n(e)g(ha)n(v)n(e)e(dra)n(wn)i(b)r(et)n
(w)n(een)f(random)g(sequences)-152 4489 y(of)23 b(op)r(erations)g(and)f
(the)f(de\014nition)g(of)i(observ)l(ational)g(equiv)l(alence)-152
4572 y(is)k(new.)-40 4655 y(Algebraic)22 b(sp)r(eci\014cations)h(ha)n
(v)n(e)d(b)r(een)h(used)f(b)n(y)g(man)n(y)g(authors)-152
4738 y(as)29 b(a)g(foundation)g(for)g(testing.)43 b(The)29
b(\014rst)f(system)g(based)g(on)h(this)-152 4821 y(idea)i(w)n(as)g(D)n
(AISTS)e([8)q(],)j(whic)n(h)e(tested)g(abstract)h(data)f(t)n(yp)r(es)g
(b)n(y)-152 4904 y(ev)l(aluating)j(and)f(comparing)g(the)g(left)h(and)e
(righ)n(t)i(hand)e(sides)i(of)-152 4987 y(equations)28
b(in)g(the)f(sp)r(eci\014cation,)j(in)d(test)h(cases)h(supplied)e(b)n
(y)g(the)-152 5070 y(user.)38 b(Although)26 b(the)g(language)i(used)e
(w)n(as)i(imp)r(erativ)n(e,)e(abstract)-152 5153 y(data)j(t)n(yp)r(e)e
(op)r(erations)j(w)n(ere)f(forbidden)f(to)h(side-e\013ect)f(their)h
(ar-)-152 5236 y(gumen)n(ts,)i(so)g(the)e(programs)i(to)f(b)r(e)g
(tested)g(w)n(ere)h(essen)n(tially)g(re-)2040 -69 y(stricted)26
b(to)g(b)r(e)f(functional.)2152 14 y(Later)40 b(w)n(ork)f(aims)g(to)h
(relax)f(this)g(restriction:)63 b(An)n(to)n(y)38 b(and)2040
97 y(Hamlet)20 b(describ)r(e)h(a)g(tec)n(hnique)f(for)i(testing)f(C++)g
(classes)h(against)2040 180 y(an)e(algebraic)i(sp)r(eci\014cation,)h
(whic)n(h)d(is)h(animated)e(in)h(order)h(to)f(pre-)2040
263 y(dict)28 b(the)f(correct)h(result)g([1)q(].)40 b(The)28
b(sp)r(eci\014cation)h(language)g(m)n(ust)2040 346 y(b)r(e)23
b(somewhat)g(restricted)h(in)e(order)i(to)f(guaran)n(tee)g(that)g(sp)r
(eci\014ca-)2040 429 y(tions)f Fe(c)l(an)g Ff(b)r(e)f(animated.)32
b(The)22 b(concrete)f(and)g(abstract)h(states)g(are)2040
512 y(related)29 b(b)n(y)e(a)h(programmer-de\014ned)e(abstraction)j
(function,)g(just)2040 596 y(as)22 b(in)g(this)g(pap)r(er.)33
b(An)n(to)n(y)20 b(and)i(Hamlet)f(do)g(not)h(address)g(test)g(case)2040
679 y(generation,)27 b(lea)n(ving)f(that)g(as)g(a)g(problem)f(for)h(a)g
(separate)h(to)r(ol.)2152 762 y(Bernot,)33 b(Gaudel,)f(and)e(Marre)i
(dev)n(elop)r(ed)e(a)h(theory)f(of)h(test-)2040 845 y(ing,)26
b(whic)n(h)g(formalises)g(the)f(assumptions)h(on)f(whic)n(h)g
(selection)i(of)2040 928 y(test)i(cases)h(is)g(based)f([2)q(].)45
b(They)29 b(dev)n(elop)r(ed)f(a)i(to)r(ol)g(for)g(test)f(case)2040
1011 y(selection)e(based)f(on)f(an)h(algebraic)i(sp)r(eci\014cation.)
2152 1094 y(One)19 b(un)n(usual)g(feature)h(of)g(the)f(algebraic)i(sp)r
(eci\014cations)g(in)e(this)2040 1177 y(pap)r(er)h(is)h(that)f(they)f
(relate)i(monadic)e(terms,)i(in)f(whic)n(h)g(the)g(under-)2040
1260 y(lying)e(state)f(is)h(implicit.)32 b(More)18 b(commonly)e(in)h
(algebraic)i(sp)r(eci\014ca-)2040 1343 y(tions,)24 b(the)e(state)h(is)g
(an)f(explicit)g(argumen)n(t)g(and)g(result.)33 b(\(P)n(erhaps)2040
1426 y(this)j(is)f(b)r(ecause)h(algebraic)h(sp)r(eci\014cation)g
(framew)n(orks)f(tend)e(to)2040 1509 y(b)r(e)25 b(\014rst)g(order.\))35
b(Relating)26 b Fe(pr)l(o)l(gr)l(ams)h Ff(rather)e(than)g
Fe(states)j Ff(lets)e(us)2040 1592 y(write)j(equations)g(whic)n(h)g
(apply)f(directly)g(to)h(the)f(imp)r(erativ)n(e)g(im-)2040
1675 y(plemen)n(tation.)39 b(W)-6 b(e)27 b(b)r(eliev)n(e)h(w)n(e)g(are)
g(the)f(\014rst)h(to)f(directly)h(v)n(erify)2040 1758
y(suc)n(h)g(equations)h(b)n(y)e(testing:)41 b(recall)29
b(that)g(D)n(AISTS)e(w)n(as)i(limited)2040 1841 y(to)24
b(testing)h(pure)e(functions,)i(and)f(An)n(to)n(y)f(and)h(Hamlet)f
(used)h(their)2040 1924 y(equational)k(sp)r(eci\014cation)g(to)g(deriv)
n(e)e(rewrite)j(rules,)f(rather)f(than)2040 2007 y(testing)f(the)g
(equations)f(in)h(it)g(directly)-6 b(.)2152 2090 y(Mo)r(del-based)20
b(sp)r(eci\014cations)g(ha)n(v)n(e)e(also)i(b)r(een)f(used)f(as)i(a)f
(foun-)2040 2173 y(dation)46 b(for)g(testing.)93 b(Sto)r(c)n(ks)45
b(and)g(Carrington)h(dev)n(elop)r(ed)f(a)2040 2256 y(framew)n(ork)36
b(for)h(deriving)f Fe(test)j(fr)l(ames)d Ff(\(c)n(haracterising)i(a)e
(class)2040 2339 y(of)27 b(test)g(cases\))h(from)e(a)h(Z)f(sp)r
(eci\014cation)i([24)q(].)37 b(They)27 b(deriv)n(ed)e(test)2040
2422 y(frames)38 b(man)n(ually)-6 b(,)40 b(but)d(Donat)g(has)h(dev)n
(elop)r(ed)g(an)g(automatic)2040 2505 y(to)r(ol)33 b(for)f(doing)g(so)g
([5].)52 b(Mo)r(del-based)33 b(sp)r(eci\014cations)f(ha)n(v)n(e)f(also)
2040 2588 y(b)r(een)i(used)g(as)h(test)g(oracles.)59
b(A)33 b(to)r(ol)h(for)h(instrumen)n(ting)d(C++)2040
2671 y(classes)42 b(to)e(c)n(hec)n(k)f(pre-)h(and)f(p)r(ost-conditions)
i(deriv)n(ed)e(from)h(a)2040 2754 y(mo)r(del-based)32
b(sp)r(eci\014cation)i(has)f(b)r(een)f(dev)n(elop)r(ed)g(b)n(y)g(Edw)n
(ards)2040 2837 y([7)q(].)k(Mueller)28 b(and)d(Korel)i(test)g(C)f(co)r
(de)h(against)g(a)g(formal)g(sp)r(eci\014-)2040 2920
y(cation)18 b(b)n(y)e(translating)j(the)d(sp)r(eci\014cation)j(in)n(to)
e(co)r(de)h(whic)n(h)f(c)n(hec)n(ks)2040 3003 y(the)26
b(results)g(of)h(the)f(test,)g(and)g(generating)h(test)f(cases)h
(either)f(ran-)2040 3086 y(domly)h(or)i(using)f(existing)g(test)h(case)
g(generators)g([19)q(].)42 b(The)29 b(case)2040 3169
y(studies)22 b(used)f(rather)h(small)g(though)g(|)f(the)h(most)f
(complex)g(is)h(the)2040 3252 y(C)k(string)g(cop)n(y)g(function.)2152
3335 y(All)40 b(of)g(this)g(w)n(ork)g(requires)f(some)h(prepro)r
(cessing)g(or)g(anal-)2040 3418 y(ysis)d(of)h(sp)r(eci\014cations)g(b)r
(efore)f(they)f(can)h(b)r(e)g(used)f(for)i(testing.)2040
3501 y Fg(QuickCheck)32 b Ff(is)i(unique)e(in)i(using)g(sp)r
(eci\014cations)h Fe(dir)l(e)l(ctly)p Ff(,)i(b)r(oth)2040
3584 y(for)26 b(test)f(case)g(generation)h(and)e(as)i(a)f(test)g
(oracle.)35 b(The)25 b(other)g(side)2040 3667 y(of)39
b(the)e(coin)h(is)g(that)g(the)f Fg(QuickCheck)e Ff(sp)r(eci\014cation)
k(language)2040 3750 y(is)31 b(necessarily)g(more)f(restrictiv)n(e)g
(than,)i(for)e(example,)h(predicate)2040 3833 y(calculus,)c(since)f
(prop)r(erties)g(m)n(ust)f(b)r(e)g(directly)h(testable.)2152
3916 y(Pitts')41 b Fe(evaluation)g(lo)l(gic)f Ff(b)r(ears)g(some)f
(resem)n(blance)h(to)g(our)2040 3999 y(monadic)35 b(prop)r(ert)n(y)h
(language)h([23)q(].)65 b(It)36 b(is)g(also)h(parameterised)2040
4082 y(on)22 b(a)g(monad,)h(and)e(p)r(ermits)h(prop)r(erties)g(to)g(b)r
(e)g(stated)h(whic)n(h)f(hold)2040 4165 y(after)28 b(a)f(computation.)
37 b(Pitts)27 b(writes)h([)p Fe(x)33 b Fd(\()23 b Fe(e)6
b Ff(])p Fe(P)34 b Ff(where)28 b(w)n(e)f(write)2040 4248
y Fe(run)d(e)14 b Fc(>)-38 b(>)-26 b Ff(=)8 b Fc(\025)17
b Fe(P)7 b Ff(.)34 b(Ho)n(w)n(ev)n(er,)22 b(the)g(t)n(w)n(o)g
(languages)h(di\013er)f(in)f(essen)n(tial)2040 4332 y(w)n(a)n(ys.)35
b(F)-6 b(or)26 b(example,)g(Pitts)g(can)g(write)h([)p
Fe(x)k Fd(\()21 b Fe(e)6 b Ff(])p Fe(P)25 b Fd(^)18 b
Ff([)p Fe(x)3702 4300 y Fb(0)3746 4332 y Fd(\()k Fe(e)3886
4300 y Fb(0)3908 4332 y Ff(])p Fe(P)3989 4300 y Fb(0)4011
4332 y Ff(,)2040 4415 y(meaning)29 b(that)f(if)i(w)n(e)f(compute)f
Fe(e)6 b Ff(,)30 b(then)e Fe(P)36 b Ff(will)31 b(hold,)f(but)e(if)h(w)n
(e)2040 4498 y(compute)h Fe(e)2398 4466 y Fb(0)2420 4498
y Ff(,)j(then)d Fe(P)2714 4466 y Fb(0)2767 4498 y Ff(will)i(hold.)50
b(W)-6 b(e)31 b(cannot)g(express)g(this)g(|)2040 4581
y(indeed,)d(w)n(e)g(ha)n(v)n(e)g(no)f(conjunction)h(op)r(erator,)i(but)
d(the)g(reason)i(is)2040 4664 y(deep)f(seated.)44 b(T)-6
b(o)29 b(test)g(this)g(prop)r(ert)n(y)-6 b(,)29 b(w)n(e)g(w)n(ould)g
(ha)n(v)n(e)f(to)h(com-)2040 4747 y(pute)22 b(b)r(oth)h
Fe(e)29 b Ff(and)23 b Fe(e)2643 4715 y Fb(0)2688 4747
y Fe(in)i(some)h(or)l(der)p Ff(!)35 b(But)23 b(Pitts')h(prop)r(ert)n(y)
e(talks)2040 4830 y(ab)r(out)32 b(the)g(state)g(after)h(computing)e
(one)i(or)f(the)g(other,)i Fe(but)g(not)2040 4913 y(b)l(oth)p
Ff(.)2152 4996 y Fg(QuickCheck)p Ff('s)26 b(main)h(limitation)g(as)h(a)
g(testing)g(to)r(ol)g(is)g(that)f(it)2040 5079 y(pro)n(vides)34
b(no)g(information)h(on)f(the)g(structural)h(co)n(v)n(erage)g(of)g(the)
2040 5162 y(program)g(under)f(test:)54 b(there)34 b(is)i(no)f(c)n(hec)n
(k,)i(for)f(example,)h(that)2040 5245 y(ev)n(ery)d(part)h(of)h(the)e
(co)r(de)h(is)h(exercised.)62 b(W)-6 b(e)34 b(lea)n(v)n(e)i(this)e(as)i
(the)1902 5494 y(11)p eop
%%Page: 12 12
12 11 bop -152 -69 a Ff(resp)r(onsibilit)n(y)33 b(of)f(an)g(external)f
(co)n(v)n(erage)i(to)r(ol.)53 b(Unfortunately)-6 b(,)-152
14 y(no)24 b(suc)n(h)g(to)r(ol)h(exists)g(for)g(Hask)n(ell!)34
b(It)24 b(is)h(p)r(ossible)g(that)f(Hat)g(could)-152
97 y(b)r(e)i(extended)e(to)i(pla)n(y)g(this)f(r^)-38
b(ole.)-152 293 y Fh(15)89 b(Conclusions)-152 450 y Ff(In)28
b(this)g(pap)r(er,)h(w)n(e)g(ha)n(v)n(e)e(sho)n(wn)h(ho)n(w)h
Fg(QuickCheck)d Ff(can)i(b)r(e)g(used)-152 533 y(for)20
b(sp)r(eci\014cation-based)g(testing)g(of)g(imp)r(erativ)n(e)f(op)r
(erations.)34 b(The)-152 616 y(main)25 b(con)n(tributions)h(are:)-66
759 y Fd(\017)42 b Ff(W)-6 b(e)18 b(ha)n(v)n(e)f(made)f(a)i(link)f(b)r
(et)n(w)n(een)h(testing)g(of)g(imp)r(erativ)n(e)f(co)r(de)14
842 y(and)26 b(the)f(concept)h(of)g(observ)l(ational)h(equiv)l(alence.)
-66 985 y Fd(\017)42 b Ff(W)-6 b(e)19 b(ha)n(v)n(e)e(sho)n(wn)i(ho)n(w)
g(equations)g(b)r(et)n(w)n(een)f(imp)r(erativ)n(e)g(co)r(de)14
1068 y(fragmen)n(ts)24 b(can)g(b)r(e)f(tested)h(directly)-6
b(,)24 b(b)n(y)e(running)h(eac)n(h)h(frag-)14 1151 y(men)n(t)30
b(in)h(the)g(same)h(con)n(text.)50 b(Represen)n(ting)32
b(con)n(texts)f(ex-)14 1234 y(plicitly)26 b(b)n(y)f(data)h(structures)g
(w)n(as)g(a)g(k)n(ey)f(step)h(here.)-66 1377 y Fd(\017)42
b Ff(W)-6 b(e)22 b(ha)n(v)n(e)g(de\014ned)f(and)h(giv)n(en)g(the)g
(seman)n(tics)g(of)h(a)f(new)h(kind)14 1460 y(of)j(monadic)f(prop)r
(erties,)h(parameterised)f(o)n(v)n(er)g(an)n(y)f(monad.)-66
1602 y Fd(\017)42 b Ff(W)-6 b(e)18 b(ha)n(v)n(e)g(sho)n(wn)h(that)f
(the)g Fg(QuickCheck)e Ff(prop)r(ert)n(y)i(language,)14
1685 y(despite)33 b(its)h(limitations,)i(is)d(su\016cien)n(tly)g(p)r(o)
n(w)n(erful)h(to)f(rep-)14 1768 y(resen)n(t)41 b(man)n(y)d(common)h(sp)
r(eci\014cation)i(formalisms)g(\(alge-)14 1851 y(braic)24
b(sp)r(eci\014cations,)i(functional)e(mo)r(dels,)h(relational)g(mo)r
(d-)14 1934 y(els,)i(pre-)e(and)g(p)r(ost-conditions\).)-66
2077 y Fd(\017)42 b Ff(W)-6 b(e)22 b(ha)n(v)n(e)f(sho)n(wn)i(that)e
(eac)n(h)h(formalism)g(so)h(represen)n(ted)f(can)14 2160
y(b)r(e)k(used)f(directly)h(for)g(testing)h(imp)r(erativ)n(e)e(co)r
(de.)-40 2303 y(It)33 b(will)i(b)r(e)e(exciting)h(to)f(form)n(ulate)g
(further)h(formal)f(systems)-152 2386 y(using)26 b Fg(QuickCheck)p
Ff(.)-152 2582 y Fh(References)-113 2739 y Ff([1])42
b(S.)18 b(An)n(to)n(y)e(and)g(R.)i(Hamlet.)i(Automatically)d(c)n(hec)n
(king)g(an)g(im-)9 2822 y(plemen)n(tation)24 b(against)i(its)f(formal)g
(sp)r(eci\014cation.)34 b(In)24 b Fe(Irvine)9 2905 y(Softwar)l(e)29
b(Symp)l(osium)p Ff(,)d(pages)h(29{48,)h(Marc)n(h)e(1992.)-113
3048 y([2])42 b(Gilles)23 b(Bernot,)f(Marie)g(Claude)f(Gaudel,)h(and)f
(Bruno)f(Marre.)9 3131 y(Soft)n(w)n(are)h(T)-6 b(esting)19
b(based)h(on)f(F)-6 b(ormal)19 b(Sp)r(eci\014cations:)32
b(a)20 b(the-)9 3214 y(ory)f(and)f(a)g(to)r(ol.)24 b
Fe(Softwar)l(e)e(Engine)l(ering)f(Journal)p Ff(,)g(6\(6\):387{)9
3297 y(405,)27 b(No)n(v)e(1991.)-113 3439 y([3])42 b(F.)24
b(W)-6 b(arren)22 b(Burton.)30 b(An)22 b(e\016cien)n(t)h(functional)h
(implemen)n(ta-)9 3522 y(tion)31 b(of)h(FIF)n(O)f(queues.)49
b Fe(Information)33 b(Pr)l(o)l(c)l(essing)h(L)l(etters)p
Ff(,)9 3605 y(14\(5\):205{206,)c(July)c(1982.)-113 3748
y([4])42 b(Ko)r(en)49 b(Claessen)i(and)d(John)h(Hughes.)103
b(Quic)n(k)n(c)n(hec)n(k:)79 b(a)9 3831 y(ligh)n(t)n(w)n(eigh)n(t)21
b(to)r(ol)g(for)f(random)f(testing)h(of)h(hask)n(ell)f(programs.)9
3914 y(In)41 b Fe(International)i(Confer)l(enc)l(e)g(on)f(F)-6
b(unctional)43 b(Pr)l(o)l(gr)l(am-)9 3997 y(ming)p Ff(,)26
b(pages)g(268{279.)j(A)n(CM,)d(2000.)-113 4140 y([5])42
b(M.)g(Donat.)82 b(Automating)41 b(F)-6 b(ormal)41 b(Sp)r
(eci\014cation)h(Based)9 4223 y(T)-6 b(esting.)48 b(In)29
b(M.)h(Bidoit)h(and)f(M.)g(Dauc)n(het,)g(editors,)i Fe(Pr)l(o)l(c.)9
4306 y(Conf.)50 b(on)h(The)l(ory)h(and)f(Pr)l(actic)l(e)h(of)e(Sw)g
(Development)9 4389 y(\(T)-6 b(APSOFT)41 b(97\))p Ff(,)j(v)n(olume)39
b(1214,)45 b(pages)40 b(833{847,)46 b(Lille,)9 4472 y(F)-6
b(rance,)26 b(1997.)i(Springer-V)-6 b(erlag,)26 b(Berlin.)-113
4615 y([6])42 b(J.)25 b(Duran)e(and)g(S.)h(Ntafos.)32
b(An)23 b(ev)l(aluation)h(of)g(random)f(test-)9 4698
y(ing.)35 b Fe(T)-6 b(r)l(ansactions)30 b(on)e(Softwar)l(e)h(Engine)l
(ering)p Ff(,)e(10\(4\):438{)9 4781 y(444,)g(July)f(1984.)-113
4924 y([7])42 b(Stephen)24 b(H.)h(Edw)n(ards.)35 b(A)24
b(framew)n(ork)i(for)g(practical,)h(auto-)9 5007 y(mated)35
b(blac)n(k-b)r(o)n(x)f(testing)i(of)g(comp)r(onen)n(t-base)f(soft)n(w)n
(are.)9 5090 y Fe(Softwar)l(e)44 b(T)-6 b(esting,)47
b(V)-6 b(eri\014c)l(ation)43 b(and)g(R)l(eliability)p
Ff(,)j(11\(2\),)9 5173 y(June)26 b(2001.)2078 -69 y([8])43
b(J.)21 b(Gannon,)h(R.)e(Hamlet,)h(and)f(P)-6 b(.)20
b(McMullin.)27 b(Data)20 b(abstrac-)2201 14 y(tion)26
b(implemen)n(tation,)e(sp)r(eci\014cation,)j(and)e(testing.)35
b Fe(T)-6 b(r)l(ans.)2201 97 y(Pr)l(o)l(g.)28 b(L)l(ang.)g(and)g
(Systems)p Ff(,)f(\(3\):211{223,)j(1981.)2078 240 y([9])43
b(D.)30 b(Hamlet.)47 b(Random)29 b(testing.)49 b(In)29
b(J.)i(Marciniak,)i(editor,)2201 323 y Fe(Encyclop)l(e)l(dia)h(of)e
(Softwar)l(e)h(Engine)l(ering)p Ff(,)h(pages)e(970{978.)2201
406 y(Wiley)-6 b(,)26 b(1994.)2040 548 y([10])43 b(R.)32
b(Hamlet)g(and)h(R.)f(T)-6 b(a)n(ylor.)56 b(P)n(artition)33
b(testing)h(do)r(es)f(not)2201 631 y(inspire)23 b(con\014dence.)28
b Fe(T)-6 b(r)l(ansactions)26 b(on)f(Softwar)l(e)g(Engine)l(er-)2201
714 y(ing)p Ff(,)h(16\(12\):1402{1411,)31 b(Decem)n(b)r(er)25
b(1990.)2040 856 y([11])43 b(I.)32 b(J.)g(Ha)n(y)n(es,)h(editor.)53
b Fe(Sp)l(e)l(ci\014c)l(ation)35 b(Case)e(Studies)p Ff(.)54
b(Pren-)2201 939 y(tice)23 b(Hall)g(In)n(ternational)f(Series)h(in)f
(Computer)f(Science,)j(2nd)2201 1022 y(edition,)i(1993.)2040
1165 y([12])43 b(Dean)54 b(Herington.)118 b(HUnit)52
b(1.0)j(User's)g(Guide,)61 b(2002.)2201 1248 y(h)n(ttp://h)n
(unit.sourceforge.net/HUnit-1.0/Guide.h)n(tml.)2040 1390
y([13])43 b(P)-6 b(.)32 b(Hudak.)83 b(Mo)r(dular)33 b(Domain)e(Sp)r
(eci\014c)h(Languages)h(and)2201 1473 y(T)-6 b(o)r(ols.)30
b(In)21 b Fe(Pr)l(o)l(c)l(e)l(e)l(dings)26 b(of)e(Fifth)g
(International)h(Confer)l(enc)l(e)2201 1556 y(on)d(Softwar)l(e)i(R)l
(euse)p Ff(.)41 b(IEEE)20 b(Computer)f(So)r(ciet)n(y,)i(Jun)f(1999.)
2040 1699 y([14])43 b(Simon)c(P)n(eyton)h(Jones.)78 b(T)-6
b(ac)n(kling)41 b(the)f(a)n(wkw)n(ard)h(squad:)2201 1782
y(monadic)f(input/output,)j(concurrency)-6 b(,)44 b(exceptions,)h(and)
2201 1865 y(foreign-language)26 b(calls)g(in)e(Hask)n(ell.)32
b(In)23 b(T)-6 b(on)n(y)23 b(Hoare,)j(Man-)2201 1948
y(fred)37 b(Bro)n(y)-6 b(,)41 b(and)36 b(Ralf)i(Stein)n(bruggen,)i
(editors,)h Fe(Engine)l(er-)2201 2031 y(ing)26 b(the)l(ories)i(of)d
(softwar)l(e)j(c)l(onstruction)p Ff(,)f(pages)e(47{96.)i(IOS)2201
2114 y(Press,)21 b(2001.)k(Presen)n(ted)19 b(at)g(the)f(2000)i(Marktob)
r(erdorf)g(Sum-)2201 2197 y(mer)25 b(Sc)n(ho)r(ol.)2040
2339 y([15])43 b(J.)29 b(Launc)n(h)n(bury)d(and)i(S.)g(P)n(eyton)g
(Jones.)43 b(State)29 b(in)f(Hask)n(ell.)2201 2422 y
Fe(Lisp)d(and)h(Symb)l(olic)f(Computation)p Ff(,)g(8\(4\):293{341,)j
(Decem-)2201 2505 y(b)r(er)e(1995.)2040 2647 y([16])43
b(S.)28 b(Liang,)i(P)-6 b(.)28 b(Hudak,)g(and)g(M.)h(Jones.)43
b(Monad)29 b(transform-)2201 2730 y(ers)e(and)g(mo)r(dular)f(in)n
(terpreters.)38 b(In)26 b Fe(Confer)l(enc)l(e)k(R)l(e)l(c)l(or)l(d)g
(of)2201 2813 y(POPL'95:)k(22nd)25 b(A)n(CM)g(SIGPLAN-SIGA)n(CT)g(Symp)
l(osium)2201 2896 y(on)34 b(Principles)g(of)g(Pr)l(o)l(gr)l(amming)h(L)
l(anguages)p Ff(,)i(pages)c(333{)2201 2979 y(343,)27
b(San)f(F)-6 b(rancisco,)27 b(California,)h(1995.)2040
3122 y([17])43 b(T)-6 b(om)140 b(Mo)r(ertel.)377 b(Sev)n(en)139
b(Lessons)j(from)2201 3205 y(the)267 b(ICFP)h(Programming)f(Con)n
(test.)2201 3288 y(h)n(ttp://www.kuro5hin.org/story/2001/7/3)q(1/)q
(010)q(2/)q(110)q(14)q(,)2201 3371 y(2001.)2040 3513
y([18])43 b(Graeme)e(E.)g(Moss)h(and)f(Colin)h(Runciman.)78
b(Automated)2201 3596 y(b)r(enc)n(hmarking)24 b(of)h(functional)h(data)
f(structures.)33 b(In)24 b Fe(Pr)l(acti-)2201 3679 y(c)l(al)g(Asp)l(e)l
(cts)i(of)e(De)l(clar)l(ative)h(L)l(anguages)p Ff(,)g(pages)d(1{15,)j
(1999.)2040 3822 y([19])43 b(C.)23 b(Mueller)g(and)e(B.)i(Korel.)29
b(Automated)20 b(ev)l(aluation)i(of)h(cots)2201 3905
y(comp)r(onen)n(ts.)47 b(In)29 b Fe(First)j(International)h(Workshop)g
(on)f(A)n(u-)2201 3988 y(tomate)l(d)43 b(Pr)l(o)l(gr)l(am)g(A)n
(nalysis,)i(T)-6 b(esting)42 b(and)g(V)-6 b(eri\014c)l(ation)p
Ff(,)2201 4071 y(Limeric)n(k,)45 b(Ireland,)h(2000.)84
b(In)41 b(conjunction)h(with)g(ICSE)2201 4154 y(2000.)2040
4296 y([20])h(Martin)29 b(Odersky)e(and)g(Konstan)n(tin)h(L\177)-38
b(aufer.)42 b(Putting)28 b(t)n(yp)r(e)2201 4379 y(annotations)33
b(to)g(w)n(ork.)54 b(In)32 b Fe(Confer)l(enc)l(e)j(R)l(e)l(c)l(or)l(d)g
(of)f(POPL)2201 4462 y('96:)55 b(The)38 b(23r)l(d)g(A)n(CM)f
(SIGPLAN-SIGA)n(CT)h(Symp)l(osium)2201 4545 y(on)c(Principles)h(of)f
(Pr)l(o)l(gr)l(amming)h(L)l(anguages,)i(St.)d(Peters-)2201
4628 y(b)l(er)l(g)25 b(Be)l(ach,)f(Florida)p Ff(,)f(pages)f(54{67,)i
(New)e(Y)-6 b(ork,)21 b(NY,)g(1996.)2040 4770 y([21])43
b(Chris)c(Ok)l(asaki.)70 b(An)37 b(Ov)n(erview)h(of)g(Edison.)71
b(In)37 b Fe(Haskel)t(l)2201 4853 y(Workshop)p Ff(,)27
b(pages)g(34{54,)h(Septem)n(b)r(er)c(2000.)2040 4996
y([22])43 b(S.)32 b(L.)g(P)n(eyton)f(Jones)i(and)f(P)-6
b(.)31 b(W)-6 b(adler.)53 b(Imp)r(erativ)n(e)31 b(F)-6
b(unc-)2201 5079 y(tional)33 b(programming.)53 b(In)31
b Fe(Pr)l(o)l(c)l(e)l(e)l(dings)36 b(1993)e(Symp)l(osium)2201
5162 y(Principles)58 b(of)e(Pr)l(o)l(gr)l(amming)j(L)l(anguages)p
Ff(,)68 b(Charleston,)2201 5245 y(N.Carolina,)28 b(1993.)1902
5494 y(12)p eop
%%Page: 13 13
13 12 bop -152 -69 a Ff([23])43 b(Andrew)31 b(M.)h(Pitts.)51
b(Ev)l(aluation)32 b(logic.)52 b(In)31 b(G.)h(Birt)n(wistle,)9
14 y(editor,)21 b Fe(Pr)l(o)l(c)l(e)l(e)l(dings)j(of)d(the)h(IVth)f
(Higher)h(Or)l(der)g(Workshop)p Ff(,)9 97 y(pages)27
b(162{189.)i(Springer-V)-6 b(erlag,)26 b(1990.)-152 240
y([24])43 b(Phil)33 b(Sto)r(c)n(ks)f(and)f(Da)n(vid)h(Carrington.)54
b(A)31 b(F)-6 b(ramew)n(ork)32 b(for)9 323 y(Sp)r(eci\014cation)27
b(Based)g(T)-6 b(esting.)37 b Fe(T)-6 b(r)l(ansactions)30
b(on)f(Softwar)l(e)9 406 y(Engine)l(ering)p Ff(,)e(22\(11\),)g(No)n(v)e
(1996.)-152 549 y([25])43 b(Malcolm)38 b(W)-6 b(allace,)42
b(Olaf)c(Chitil,)k(Thorsten)37 b(Brehm,)j(and)9 632 y(Colin)26
b(Runciman.)31 b(Multiple-View)25 b(T)-6 b(racing)26
b(for)f(Hask)n(ell:)34 b(a)9 715 y(New)20 b(Hat.)j(In)18
b Fe(Haskel)t(l)k(Workshop)p Ff(.)f(A)n(CM,)f(Septem)n(b)r(er)d(2001.)
1902 5494 y(13)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
