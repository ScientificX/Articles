%!PS-Adobe-2.0
%%Creator: dvips 5.497 Copyright 1986, 1992 Radical Eye Software
%%Title: popl94ip.dvi
%%CreationDate: Tue Nov  2 17:29:29 1993
%%Pages: 21
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%EndComments
%DVIPSCommandLine: dvips popl94ip.dvi
%DVIPSSource:  TeX output 1993.11.02:1727
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul add
.99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage userdict
/eop-hook known{eop-hook}if}N /@start{userdict /start-hook known{start-hook}
if pop /VResolution X /Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255
{IE S 1 string dup 0 3 index put cvn put}for 65781.76 div /vsize X 65781.76
div /hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N
/ruley 0 N /v{/ruley X /rulex X V}B /V{}B /RV statusdict begin /product where{
pop product dup length 7 ge{0 7 getinterval dup(Display)eq exch 0 4
getinterval(NeXT)eq or}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /QV{
gsave transform round exch round exch itransform moveto rulex 0 rlineto 0
ruley neg rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N
/tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{4 M}B
/w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{p 1 w}B /r{
p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p a}B /bos{/SS save
N}B /eos{SS restore}B end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/tmp_mnt/users/lang1/gls/popl94ip.dvi) @start /Fa 3 51 df<0F0030C06060606040
20C030C030C030C030C030C030C030C030C03040206060606030C00F000C137E9211>48
D<0C001C00EC000C000C000C000C000C000C000C000C000C000C000C000C000C000C000C00FFC0
0A137D9211>I<1F0060C06060F070F030603000700070006000C001C001800200040008101010
20207FE0FFE00C137E9211>I E /Fb 1 49 df<040E0E1C1C1C38383070706060C0C0070F7F8F
0A>48 D E /Fc 1 18 df<FFFFFFE0FFFFFFE00000000000000000000000000000000000000000
0000000000000000FFFFFFE0FFFFFFE00000000000000000000000000000000000000000000000
0000000000FFFFFFE0FFFFFFE01B147E9320>17 D E /Fd 8 87 df<00F000030C000E06041C07
04380708300708700790700790E003A0E003A0E003C0E00380E00380E00380600780601B883061
900F80E016127E911B>11 D<0001F000061800080C00100C00200E00400E00800E00801C01001C
010018010038020FF00210C0020FE0020030040030040030040038040038080070080070080070
0800E01800E01800C0140180140300230E0020F800200000200000400000400000400000400000
80000080000017257F9C17>I<381F004E61804681C04701C08F01C08E01C00E01C00E01C01C03
801C03801C03801C0380380700380700380700380700700E00300E00000E00000E00001C00001C
00001C00001C00003800003800003000121B7E9115>17 D<60F0F06004047C830C>58
D<60F0F0701010101020204080040C7C830C>I<01FFE0003C0000380000380000380000380000
700000700000700000700000E00000E00000E00000E00001C00001C00001C00001C00003800203
800203800203800407000407000C0700180700380E00F0FFFFF0171C7E9B1C>76
D<1FFFFFF01C03807030070030200700206007002040070020400E0020800E0020800E0020000E
0000001C0000001C0000001C0000001C0000003800000038000000380000003800000070000000
700000007000000070000000E0000000E0000000E0000000E0000001E000007FFF00001C1C7F9B
18>84 D<FFC00FF01E0003801C0003001C0002001C0004001E0004000E0008000E0008000E0010
000E0020000E0020000E0040000E0080000E0080000F0100000701000007020000070400000704
000007080000071800000710000007A0000003A0000003C0000003800000038000000300000003
0000001C1D7D9B18>86 D E /Fe 62 122 df<0001FC000703000C03001C07001C030018000038
0000380000380000380000700007FFFC00701C00701C00701C00E03800E03800E03800E03800E0
7001C07001C07001C07001C0E201C0E201C0E20380E40380640380380380000300000700000600
00C60000E40000CC00007000001825819C17>12 D<E0E0E070301018080508749C15>18
D<00C001E001E001E001C003C003C003800380038003000700070006000600060004000C000C00
080008000000000000000000000030007800F00060000B1E7C9D0D>33 D<183C3C3C0404080810
204080060C779C0D>39 D<00030006000800180030006000C000C0018003000300060006000C00
0C001C0018001800380030003000700070006000600060006000E000E000E000E000E000600060
0060006000600020003000100008000800102A7B9E11>I<001000100008000C00040006000600
0600060006000700070007000700070006000600060006000E000E000C000C001C001800180038
003000300060006000C000C001800300030006000C00180010006000C000102A809E11>I<1838
78380808101020404080050C7D830D>44 D<FFC0FFC0FFC00A037D890F>I<3078F06005047C83
0D>I<003C0000C6000183000303000603000603800E03800C03801C03801C0300380700380700
380700380700700E00700E00700E00700E00E01C00E01C00E01C00E03800E03800E03000C06000
E0600060C0007180001E0000111D7B9B15>48 D<00020006000C001C007C039C00380038003800
38007000700070007000E000E000E000E001C001C001C001C003800380038003800780FFF00F1C
7C9B15>I<003C0000C3000101800201800201C00441C00441C00841C00841C00841C010838010
83801107000E0600000C0000180000300000C00001000006000008000010010010020020020040
06007E0C00C7F80083F80080E000121D7C9B15>I<003E0000C1800101800200C00400C00440C0
0841C00841C00841C0088380070380000700000E0001F800003800000C00000C00000E00000E00
000E00000E00700E00E01C00801C0080380080300040600021C0001F0000121D7C9B15>I<0001
800001C0000380000380000380000300000700000700000600000E00000C00001C000018000018
0000300000300000600000400000C600018E00010E00020E00061C000C1C00181C003F1C0040F8
00803F0000380000380000700000700000700000700000E00000600012247E9B15>I<001E0000
61000081800180800300C00300C006018006018006018007030007860003CC0003F00001F00003
7800063C00081E00180E00300E00600600600600600600C00C00C00C00C0180060100060200030
C0000F0000121D7C9B15>56 D<003C0000C6000183000303000603000E03000C03801C03801C03
001C0300380700380700380700380F00380E00181E00181E000C6C00079C00001C000018000038
00003000006000E0C000E0C0008180008600007C0000111D7B9B15>I<060F0F06000000000000
000000003078F06008127C910D>I<030007800780030000000000000000000000000000000000
00000000180038007800380008000800100010002000400040008000091A7D910D>I<00001800
00001800000038000000380000007800000078000000B8000001B800000138000002380000023C
0000041C0000041C0000081C0000181C0000101C0000201C0000201C00007FFC0000401C000080
1C0001801C0001001C0002001C0002001C0004000E000C000E001C001E00FF00FFC01A1D7E9C1F
>65 D<0003F020001E0C60003002E000E003C001C001C0038001C0070000C00E0000801E000080
1C0000803C0000803C000000780000007800000078000000F0000000F0000000F0000000F00000
00F0000400F0000400F0000400F0000800700008007000100038002000180040000C0180000706
000001F800001B1E7A9C1E>67 D<01FFFE00003C0780003801C0003801C0003800E0003800E000
7000F00070007000700070007000F000E000F000E000F000E000F000E000F001C001E001C001E0
01C001E001C001C0038003C003800380038007800380070007000E0007001C0007003800070070
000E01C000FFFF00001C1C7D9B1F>I<01FFFFE0003C00E0003800600038004000380040003800
400070004000700040007020400070200000E0400000E0400000E0C00000FFC00001C0800001C0
800001C0800001C0800003810100038001000380020003800200070004000700040007000C0007
0018000E007800FFFFF0001B1C7D9B1C>I<01FFFFC0003C01C0003800C0003800800038008000
3800800070008000700080007020800070200000E0400000E0400000E0C00000FFC00001C08000
01C0800001C0800001C08000038100000380000003800000038000000700000007000000070000
00070000000F000000FFF000001A1C7D9B1B>I<0003F020001E0C60003002E000E003C001C001
C0038001C0070000C00E0000801E0000801C0000803C0000803C00000078000000780000007800
0000F0000000F0000000F001FFC0F0001E00F0001C00F0001C00F0001C00F0001C007000380070
00380038003800180078000C0090000707100001F800001B1E7A9C20>I<01FFCFFE003C01E000
3801C0003801C0003801C0003801C00070038000700380007003800070038000E0070000E00700
00E0070000FFFF0001C00E0001C00E0001C00E0001C00E0003801C0003801C0003801C0003801C
00070038000700380007003800070038000F007800FFE7FF001F1C7D9B1F>I<01FFC0003C0000
380000380000380000380000700000700000700000700000E00000E00000E00000E00001C00001
C00001C00001C0000380000380000380000380000700000700000700000700000F0000FFE00012
1C7E9B10>I<007FF0000780000700000700000700000700000E00000E00000E00000E00001C00
001C00001C00001C0000380000380000380000380000700000700000700000700060E000E0E000
C0C00081C0008380004700003C0000141D7B9B16>I<01FFE0003C000038000038000038000038
0000700000700000700000700000E00000E00000E00000E00001C00001C00001C00001C0000380
080380080380080380100700100700300700600700E00E03C0FFFFC0151C7D9B1A>76
D<01FE0007F8003E000780002E000F00002E001700002E001700002E002700004E002E00004E00
4E00004E004E00004E008E00008E011C00008E011C00008E021C00008E021C0001070438000107
043800010708380001071038000207107000020720700002072070000207407000040740E00004
0780E000040700E0000C0700E0001C0601E000FF861FFC00251C7D9B25>I<01FC03FE001C0070
003C0060002E0040002E0040002E00400047008000470080004700800043808000838100008381
00008181000081C1000101C2000101C2000100E2000100E2000200E40002007400020074000200
74000400380004003800040038000C0018001C001000FF8010001F1C7D9B1F>I<0007F000001C
1C0000700E0000E0070001C0038003800380070003800E0003C01E0003C01C0003C03C0003C03C
0003C0780003C0780003C0780003C0F0000780F0000780F0000780F0000F00F0000F00F0000E00
F0001E00F0003C0070003800700070007800E0003801C0001C0380000E0E000003F800001A1E7A
9C20>I<01FFFC00003C070000380380003801C0003801C0003801C0007003C0007003C0007003
C00070038000E0078000E0070000E00E0000E0380001FFE00001C0000001C0000001C000000380
0000038000000380000003800000070000000700000007000000070000000F000000FFE000001A
1C7D9B1C>I<01FFF800003C0E0000380700003803800038038000380380007007800070078000
70078000700F0000E00E0000E01C0000E0700000FFC00001C0C00001C0600001C0700001C07000
038070000380700003807000038070000700F0000700F0400700F0400700F0800F007880FFE079
0000001E001A1D7D9B1E>82 D<000F8400304C00403C0080180100180300180300180600100600
1006000007000007000003E00003FC0001FF00007F800007C00001C00001C00000C00000C02000
C02000C0600180600180600300600200F00400CC180083E000161E7D9C17>I<1FFFFFC01C0701
C0300E00C0200E0080600E0080400E0080401C0080801C0080801C0080001C0000003800000038
000000380000003800000070000000700000007000000070000000E0000000E0000000E0000000
E0000001C0000001C0000001C0000001C0000003C000007FFE00001A1C799B1E>I<FF803FC01C
000F001C0004001C0008001C0008001C0010001C0010001C0020001C0040001C0040001E008000
0E0080000E0100000E0200000E0200000E0400000E0400000E0800000E1800000E1000000E2000
00072000000740000007C0000007800000070000000700000006000000060000001A1D779B1F>
86 D<01FF81FE001E00F0001C0060001E0080000E0180000E0100000F02000007040000070800
000790000003A0000003C0000001C0000001C0000001E0000002E0000004E0000008F000001070
0000207000006038000040380000803C0001001C0002001C0006001E001E001E00FF80FFC01F1C
7E9B1F>88 D<00FFFF8000F0070001C00E0001801E0001001C0001003800020070000200E00002
01C0000001C0000003800000070000000E0000001C0000001C0000003800000070000000E00800
01C0100001C0100003801000070020000E0020001C0060003C00C0003801C00070078000FFFF80
00191C7D9B19>90 D<03CC063C0C3C181C3838303870387038E070E070E070E070E0E2C0E2C0E2
61E462643C380F127B9115>97 D<3F00070007000E000E000E000E001C001C001C001C0039C03E
60383038307038703870387038E070E070E070E060E0E0C0C0C1C0618063003C000D1D7B9C13>
I<01F007080C08181C3838300070007000E000E000E000E000E000E008E010602030C01F000E12
7B9113>I<001F80000380000380000700000700000700000700000E00000E00000E00000E0003
DC00063C000C3C00181C00383800303800703800703800E07000E07000E07000E07000E0E200C0
E200C0E20061E4006264003C3800111D7B9C15>I<01E007100C1018083810701070607F80E000
E000E000E000E000E0086010602030C01F000D127B9113>I<0003C0000670000C70001C60001C
00001C0000380000380000380000380000380003FF8000700000700000700000700000700000E0
0000E00000E00000E00000E00001C00001C00001C00001C00001C0000380000380000380000300
00030000070000C60000E60000CC00007800001425819C0D>I<00F3018F030F06070E0E0C0E1C
0E1C0E381C381C381C381C383830383038187818F00F700070007000E000E0C0C0E1C0C3007E00
101A7D9113>I<0FC00001C00001C0000380000380000380000380000700000700000700000700
000E78000E8C000F0E000E0E001C0E001C0E001C0E001C0E00381C00381C00381C003838007038
80703880707080707100E03200601C00111D7D9C15>I<01800380010000000000000000000000
000000001C002600470047008E008E000E001C001C001C0038003800710071007100720072003C
00091C7C9B0D>I<0006000E0006000000000000000000000000000000F0011802180218043804
3800380038007000700070007000E000E000E000E001C001C001C001C003800380C300E700CE00
78000F24819B0D>I<0FC00001C00001C000038000038000038000038000070000070000070000
0700000E0F000E11000E23800E43801C83001C80001D00001E00003F800039C00038E00038E000
70E20070E20070E20070E400E06400603800111D7D9C13>I<1F80038003800700070007000700
0E000E000E000E001C001C001C001C0038003800380038007000700070007000E400E400E400E4
0068003800091D7C9C0B>I<3C1E0780266318C04683A0E04703C0E08E0380E08E0380E00E0380
E00E0380E01C0701C01C0701C01C0701C01C070380380E0388380E0388380E0708380E0710701C
0320300C01C01D127C9122>I<3C3C002646004687004707008E07008E07000E07000E07001C0E
001C0E001C0E001C1C00381C40381C40383840383880701900300E0012127C9117>I<01E00718
0C0C180C380C300E700E700EE01CE01CE01CE018E038E030E06060C031801E000F127B9115>I<
07870004D98008E0C008E0C011C0E011C0E001C0E001C0E00381C00381C00381C0038180070380
0703000707000706000E8C000E70000E00000E00001C00001C00001C00001C00003C0000FF8000
131A7F9115>I<3C3C26C2468747078E068E000E000E001C001C001C001C003800380038003800
7000300010127C9112>114 D<01F006080C080C1C18181C001F001FC00FF007F0007800386030
E030C030806060C01F000E127D9111>I<00C001C001C001C00380038003800380FFE007000700
07000E000E000E000E001C001C001C001C00384038403840388019000E000B1A7D990E>I<1E03
00270700470700470700870E00870E000E0E000E0E001C1C001C1C001C1C001C1C003838803838
801838801839001C5900078E0011127C9116>I<1E06270E470E4706870287020E020E021C041C
041C041C0818083808181018200C4007800F127C9113>I<1E0183270387470387470383870701
8707010E07010E07011C0E021C0E021C0E021C0E04180C04181C04181C081C1C100C263007C3C0
18127C911C>I<070E0019910010E38020E38041C30041C00001C00001C0000380000380000380
00038000070200670200E70400CB04008B080070F00011127D9113>I<1E03270747074707870E
870E0E0E0E0E1C1C1C1C1C1C1C1C38383838183818381C7007F00070007000E0E0C0E1C0818047
003C00101A7C9114>I E /Ff 53 122 df<003FC00001F0300003C0380007C07C000F807C000F
807C000F8038000F8000000F8000000F8000000F800000FFFFFC00FFFFFC000F807C000F807C00
0F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C000F807C
000F807C000F807C007FE1FF807FE1FF80191D809C1B>12 D<FFE0FFE0FFE0FFE00B047F8A10>
45 D<03F8000F1E001C07003C07803803807803C07803C07803C0F803E0F803E0F803E0F803E0
F803E0F803E0F803E0F803E0F803E0F803E0F803E0F803E07803C07803C03803803C07801C0700
0F1E0003F800131B7E9A18>48 D<00600001E0000FE000FFE000F3E00003E00003E00003E00003
E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003
E00003E00003E00003E0007FFF807FFF80111B7D9A18>I<07F8001FFE00383F80780FC0FC07C0
FC07E0FC03E0FC03E07803E00007E00007C00007C0000F80001F00001E0000380000700000E000
0180600300600600600800E01FFFC03FFFC07FFFC0FFFFC0FFFFC0131B7E9A18>I<03F8001FFE
003C1F003C0F807C07C07E07C07C07C03807C0000F80000F80001E00003C0003F800001E00000F
800007C00007C00007E03007E07807E0FC07E0FC07E0FC07C0780F80781F001FFE0007F800131B
7E9A18>I<000180000380000780000F80001F80003F80006F8000CF80008F80018F80030F8006
0F800C0F80180F80300F80600F80C00F80FFFFF8FFFFF8000F80000F80000F80000F80000F8000
0F8001FFF801FFF8151B7F9A18>I<1801801FFF001FFE001FFC001FF8001FC000180000180000
18000018000019F8001E0E00180F801007800007C00007E00007E00007E07807E0F807E0F807E0
F807C0F007C0600F80381F001FFE0007F000131B7E9A18>I<007E0003FF000781800F03C01E07
C03C07C03C0380780000780000F80000F8F800FB0E00FA0780FC0380FC03C0F803E0F803E0F803
E0F803E07803E07803E07803C03C03C03C07801E0F0007FE0003F800131B7E9A18>I<6000007F
FFE07FFFE07FFFC07FFF807FFF80E00300C00600C00C00C0180000300000300000600000E00000
E00001E00001C00003C00003C00003C00003C00007C00007C00007C00007C00007C00007C00003
8000131C7D9B18>I<03F8000FFF001C07803003803001C07001C07801C07E01C07F83807FC300
3FF6001FFC000FFE0007FF801DFF80387FC0781FE0F007E0F003E0F001E0F001E0F001E07801C0
7803803E07801FFE0003F800131B7E9A18>I<03F8000FFE001E0F003C07807807807803C0F803
C0F803C0F803E0F803E0F803E0F803E07807E03807E03C0BE00E1BE003E3E00003E00003C00003
C03807C07C07807C0700780F00383C001FF8000FE000131B7E9A18>I<78FCFCFCFC7800000000
000078FCFCFCFC7806127D910D>I<0FF0303C601EF01FF81FF81F701F003E003C007000E001C0
0180018003000300030003000300000000000000000007800FC00FC00FC00FC00780101D7D9C17
>63 D<00038000000380000007C0000007C0000007C000000FE000000FE000001FF000001BF000
001BF0000031F8000031F8000061FC000060FC0000E0FE0000C07E0000C07E0001803F0001FFFF
0003FFFF8003001F8003001F8006000FC006000FC00E000FE00C0007E0FFC07FFEFFC07FFE1F1C
7E9B24>65 D<FFFFF800FFFFFF000FC01F800FC00FC00FC007C00FC007E00FC007E00FC007E00F
C007E00FC007E00FC007C00FC00F800FC03F000FFFFE000FC00F800FC007C00FC007E00FC003E0
0FC003F00FC003F00FC003F00FC003F00FC003F00FC007E00FC007E00FC01FC0FFFFFF00FFFFFC
001C1C7E9B22>I<001FE02000FFF8E003F80FE007C003E00F8001E01F0000E03E0000E03E0000
607E0000607C000060FC000000FC000000FC000000FC000000FC000000FC000000FC000000FC00
00007C0000607E0000603E0000603E0000C01F0000C00F80018007C0030003F80E0000FFFC0000
1FE0001B1C7D9B22>I<FFFFF800FFFFFF000FC01FC00FC007E00FC001F00FC001F80FC000F80F
C000FC0FC0007C0FC0007C0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E0FC0007E
0FC0007E0FC0007C0FC0007C0FC0007C0FC000F80FC000F80FC001F00FC007E00FC01FC0FFFFFF
00FFFFF8001F1C7E9B25>I<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC003800FC003
800FC181800FC181800FC181800FC180000FC380000FFF80000FFF80000FC380000FC180000FC1
80000FC180600FC180600FC000E00FC000C00FC000C00FC001C00FC001C00FC003C00FC00F80FF
FFFF80FFFFFF801B1C7E9B1F>I<FFFFFF00FFFFFF000FC01F000FC007000FC003000FC003800F
C003800FC001800FC181800FC181800FC180000FC180000FC380000FFF80000FFF80000FC38000
0FC180000FC180000FC180000FC180000FC000000FC000000FC000000FC000000FC000000FC000
00FFFF0000FFFF0000191C7E9B1E>I<FFFC3FFFFFFC3FFF0FC003F00FC003F00FC003F00FC003
F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FFFFFF00FFFFFF00FC003F00FC0
03F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00FC003F00F
C003F0FFFC3FFFFFFC3FFF201C7E9B25>72 D<FFFFFFFF07E007E007E007E007E007E007E007E0
07E007E007E007E007E007E007E007E007E007E007E007E007E007E007E007E0FFFFFFFF101C7F
9B12>I<FFC00003FFFFE00007FF0FE00007F00DF0000DF00DF0000DF00DF0000DF00CF80019F0
0CF80019F00C7C0031F00C7C0031F00C3E0061F00C3E0061F00C1F00C1F00C1F00C1F00C1F00C1
F00C0F8181F00C0F8181F00C07C301F00C07C301F00C03E601F00C03E601F00C01FC01F00C01FC
01F00C01FC01F00C00F801F00C00F801F0FFC0701FFFFFC0701FFF281C7E9B2D>77
D<FFE003FFFFE003FF0FF000300FF800300DFC00300CFE00300C7E00300C3F00300C1F80300C1F
C0300C0FE0300C07F0300C03F0300C01F8300C01FC300C00FE300C007F300C003F300C001FB00C
001FF00C000FF00C0007F00C0003F00C0001F00C0000F00C0000F0FFC00070FFC00030201C7E9B
25>I<003FE00001F07C0003C01E000F800F801F0007C01E0003C03E0003E07E0003F07C0001F0
7C0001F0FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F8FC0001F87C0001
F07E0003F07E0003F03E0003E03F0007E01F0007C00F800F8003C01E0001F07C00003FE0001D1C
7D9B24>I<FFFFF800FFFFFE000FC03F800FC00F800FC007C00FC007E00FC007E00FC007E00FC0
07E00FC007E00FC007C00FC007C00FC00F800FC03F000FFFFC000FC000000FC000000FC000000F
C000000FC000000FC000000FC000000FC000000FC000000FC000000FC00000FFFC0000FFFC0000
1B1C7E9B21>I<FFFFF00000FFFFFE00000FC03F00000FC00F80000FC007C0000FC007E0000FC0
07E0000FC007E0000FC007E0000FC007E0000FC007C0000FC00F80000FC03E00000FFFF000000F
C07C00000FC03E00000FC03F00000FC01F80000FC01F80000FC01F80000FC01F80000FC01F8000
0FC01F80000FC01F81800FC01F81800FC00FC180FFFC07C300FFFC01FE00211C7E9B24>82
D<07F8201FFEE03C07E07801E07000E0F000E0F00060F00060F80000FE0000FFE0007FFE003FFF
003FFF800FFFC007FFE0007FE00003F00001F00000F0C000F0C000F0C000E0E000E0F001C0FC03
C0EFFF0083FC00141C7D9B1B>I<7FFFFFE07FFFFFE0781F81E0701F80E0601F8060E01F8070C0
1F8030C01F8030C01F8030C01F8030001F8000001F8000001F8000001F8000001F8000001F8000
001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F8000001F80
0007FFFE0007FFFE001C1C7E9B21>I<FFFC01FF80FFFC01FF800FC000180007E000300007E000
300007F000700003F000600003F800E00001F800C00001FC00C00000FC01800000FC018000007E
030000007E030000007F070000003F060000003F8E0000001F8C0000001FCC0000000FD8000000
0FD800000007F000000007F000000007F000000003E000000003E000000001C000000001C00000
211C7F9B24>86 D<FFFC7FFE0FFCFFFC7FFE0FFC0FC007E000C00FC007F000C00FE003F001C007
E003F0018007E007F8018003F007F8030003F007F8030003F80CFC070001F80CFC060001F81CFE
060001FC187E0E0000FC187E0C0000FC387F0C00007E303F1800007E303F1800007F601FB80000
3F601FB000003FE01FF000003FC00FF000001FC00FE000001FC00FE000000F8007C000000F8007
C000000F0003C0000007000380000007000380002E1C7F9B31>I<0FF8001C1E003E0F803E0780
3E07C01C07C00007C0007FC007E7C01F07C03C07C07C07C0F807C0F807C0F807C0780BC03E13F8
0FE1F815127F9117>97 D<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F
00001F00001F3F801FE1E01F80701F00781F003C1F003C1F003E1F003E1F003E1F003E1F003E1F
003E1F003C1F003C1F00781F80701EC1E01C3F00171D7F9C1B>I<03FC000E0E001C1F003C1F00
781F00780E00F80000F80000F80000F80000F80000F800007800007801803C01801C03000E0E00
03F80011127E9115>I<000FF0000FF00001F00001F00001F00001F00001F00001F00001F00001
F00001F001F9F00F07F01C03F03C01F07801F07801F0F801F0F801F0F801F0F801F0F801F0F801
F07801F07801F03C01F01C03F00F0FFE03F9FE171D7E9C1B>I<01FC000F07001C03803C01C078
01C07801E0F801E0F801E0FFFFE0F80000F80000F800007800007C00603C00601E00C00F038001
FC0013127F9116>I<007F0001E38003C7C00787C00F87C00F83800F80000F80000F80000F8000
0F8000FFF800FFF8000F80000F80000F80000F80000F80000F80000F80000F80000F80000F8000
0F80000F80000F80000F80007FF8007FF800121D809C0F>I<03F8F00E0F381E0F381C07303C07
803C07803C07803C07801C07001E0F000E0E001BF8001000001800001800001FFF001FFFC00FFF
E01FFFF07801F8F00078F00078F000787000707800F01E03C007FF00151B7F9118>I<FF0000FF
00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F0FC01F31E01F40F01F
80F81F80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8FF
E7FFFFE7FF181D7F9C1B>I<1E003F003F003F003F001E00000000000000000000000000FF00FF
001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B1E7F9D0E>
I<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F0FF81F0F
F81F03801F07001F0C001F18001F70001FF8001FFC001FBC001F3E001F1F001F0F001F0F801F07
C01F03E0FFC7FCFFC7FC161D7F9C19>107 D<FF00FF001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B
1D7F9C0E>I<FF0FC07E00FF31E18F001F40F207801F80FC07C01F80FC07C01F00F807C01F00F8
07C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00F807C01F00
F807C01F00F807C0FFE7FF3FF8FFE7FF3FF825127F9128>I<FF0FC0FF31E01F40F01F80F81F80
F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F8FFE7FFFFE7
FF18127F911B>I<01FC000F07801C01C03C01E07800F07800F0F800F8F800F8F800F8F800F8F8
00F8F800F87800F07800F03C01E01E03C00F078001FC0015127F9118>I<FF3F80FFE1E01F80F0
1F00781F007C1F003C1F003E1F003E1F003E1F003E1F003E1F003E1F003C1F007C1F00781F80F0
1FC1E01F3F001F00001F00001F00001F00001F00001F0000FFE000FFE000171A7F911B>I<FE3E
00FE47001E8F801E8F801E8F801F07001F00001F00001F00001F00001F00001F00001F00001F00
001F00001F0000FFF000FFF00011127F9114>114 D<1FD830786018E018E018F000FF807FE07F
F01FF807FC007CC01CC01CE01CE018F830CFC00E127E9113>I<0300030003000300070007000F
000F003FFCFFFC1F001F001F001F001F001F001F001F001F001F0C1F0C1F0C1F0C0F08079803F0
0E1A7F9913>I<FF07F8FF07F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F01F80F01F80786FF01F8FF18127F911B>I<FFC1FCFFC1FC1F00601F
80E00F80C00FC0C007C18007C18003E30003E30001F60001F60001FE0000FC0000FC0000780000
780000300016127F9119>I<FF8FF8FEFF8FF8FE1F03E0301F03E0301F83E0700F83F0600F86F0
6007C6F0C007CEF8C007EC79C003EC7D8003F83D8001F83F0001F83F0001F01F0000F01E0000E0
0E0000E00E001F127F9122>I<FFC1FCFFC1FC1F00601F80E00F80C00FC0C007C18007C18003E3
0003E30001F70001F60000FE0000FC0000FC00007800007800003000003000007000706000F860
00F8C000F980007300003E0000161A7F9119>121 D E /Fg 80 125 df<60F0F0F0F0F0F0F0F0
F0F0F0F0F0F0F0600000000060F0F0600419779816>33 D<E038F078F078F078F078F078F078F0
78E038E03860300D0B7C9816>I<0387000387000387000387000387000387007FFFC0FFFFE0FF
FFE0070E00070E00070E000E1C000E1C000E1C000E1C00FFFFE0FFFFE07FFFC01C38001C38001C
38001C38001C38001C380013197F9816>I<03800007E0000FE0001E70001C70001C70001C7000
1C77E01CE7E01DE7E00FC7000F8E000F0E001E0E003F1C007F1C00739C00E3F800E1F800E0F1C0
E0F1C071F9C07FFFC03F9F801E070013197F9816>38 D<183C3E1E0E0E0E1E1C3C78F060070D79
9816>I<00E001E007C007000F001E003C0038007800700070007000F000E000E000E000E000E0
00E000E000F000700070007000780038003C001E000F00070007C001E000E00B217A9C16>I<E0
00F0007C001C001E000F000780038003C001C001C001C001E000E000E000E000E000E000E000E0
01E001C001C001C003C0038007800F001E001C007C00F000E0000B217C9C16>I<01C00001C000
01C00001C00071C700F9CF807FFF001FFC0007F00007F0001FFC007FFF00F9CF8071C70001C000
01C00001C00001C00011127E9516>I<01C00001C00001C00001C00001C00001C00001C00001C0
00FFFF80FFFF80FFFF8001C00001C00001C00001C00001C00001C00001C00001C00011137E9516
>I<387C7E7E3E0E1E3C7CF860070B798416>I<FFFF80FFFF80FFFF8011037E8D16>I<70F8F8F8
700505788416>I<03E0000FF8001FFC001E3C00380E00780F00700700700700E00380E00380E0
0380E00380E00380E00380E00380E00380F00780700700700700780F003C1E001E3C001FFC000F
F80003E00011197E9816>48 D<01800380038007800F807F80FF80738003800380038003800380
0380038003800380038003800380038003807FF87FFC7FF80E197C9816>I<07E0001FF8007FFE
00783F00F00F00F00780F00380F00380000380000380000780000700000F00001E00003C000078
0000F00003E0000780000F00001E03803C03807FFF80FFFF807FFF8011197E9816>I<07E0001F
FC007FFE00781F00780F00780700000700000F00000F00003E0007FC0007F80007FC00001E0000
0700000780000380000380F00380F00780F00700F81F007FFE003FFC0007E00011197E9816>I<
007C0000FC0000DC0001DC00039C00039C00071C000F1C000E1C001E1C003C1C00381C00781C00
F01C00FFFFE0FFFFE0FFFFE0001C00001C00001C00001C00001C0001FFC001FFC001FFC013197F
9816>I<3FFE003FFE003FFE003800003800003800003800003800003800003800003BF0003FFC
003FFE003C0F00300700000780000380600380F00380F00780F00F00F81F007FFE001FF80007E0
0011197E9816>I<00F80003FE000FFF001F0F003E0F003C0F00780600700000F00000F3F800EF
FE00FFFE00F80F00F00780F00780E00380F00380F00380700380780780780F003C1F001FFE000F
F80003E00011197E9816>I<E00000FFFF80FFFF80FFFF80E00F00E01E00001C00003800007800
00700000E00000E00001C00001C00001C000038000038000038000038000070000070000070000
070000070000070000070000111A7E9916>I<07F0001FFC003FFE007C1F00F00780E00380E003
80E003807007007C1F001FFC0007F0001FFC003C1E00700700F00780E00380E00380E00380F007
807007007C1F003FFE001FFC0007F00011197E9816>I<03E0000FF8003FFC007C1E00780F00F0
0700E00700E00780E00780E00380F00780F00780780F803FFF803FFB800FE38000078000070030
0F00780E00781E00787C007FF8003FE0000F800011197E9816>I<70F8F8F87000000000000000
0070F8F8F8700512789116>I<000180000780001F80003E0000F80001F00007C0000F80003E00
00FC0000F00000FC00003E00000F800007C00001F00000F800003E00001F800007800001801115
7E9616>60 D<7FFF00FFFF80FFFF80000000000000000000000000000000FFFF80FFFF807FFF00
110B7E9116>I<C00000F00000FC00003E00000F800007C00001F00000F800003E00001F800007
80001F80003E0000F80001F00007C0000F80003E0000FC0000F00000C0000011157E9616>I<00
F80003FE000FFF001F0F803E3F803C7F8078FFC071E7C0F1C3C0E3C3C0E381C0E381C0E381C0E3
81C0E381C0E3C3C0F1C38071E78078FF003C7E003E3C001F03C00FFFC003FF0000FC0012197E98
16>64 D<00E00001F00001F00001B00001B00003B80003B80003B800031800071C00071C00071C
00071C00071C000E0E000E0E000FFE000FFE001FFF001C07001C07001C07007F1FC0FF1FE07F1F
C013197F9816>I<7FF800FFFE007FFF001C0F001C07801C03801C03801C03801C07801C07001F
FF001FFE001FFE001C1F001C03801C03C01C01C01C01C01C01C01C01C01C03C01C07807FFF80FF
FF007FFC0012197F9816>I<01F18007FF800FFF801F0F803C0780780780780380700380F00000
E00000E00000E00000E00000E00000E00000E00000F000007003807803807803803C07801F0F00
0FFE0007FC0001F00011197E9816>I<7FFFC0FFFFC07FFFC01C01C01C01C01C01C01C01C01C00
001C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00E01C00E01C00E01C00
E01C00E07FFFE0FFFFE07FFFE013197F9816>69 D<FFFFE0FFFFE0FFFFE01C00E01C00E01C00E0
1C00E01C00001C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00001C0000
1C00001C00001C0000FF8000FFC000FF800013197F9816>I<7F1FC0FFBFE07F1FC01C07001C07
001C07001C07001C07001C07001C07001FFF001FFF001FFF001C07001C07001C07001C07001C07
001C07001C07001C07001C07007F1FC0FFBFE07F1FC013197F9816>72 D<FFFEFFFEFFFE038003
8003800380038003800380038003800380038003800380038003800380038003800380FFFEFFFE
FFFE0F197D9816>I<7F0FE0FF8FF07F0FE01C07801C0F001C0E001C1C001C3C001C78001CF000
1CE0001DF0001FF0001FF8001F38001E1C001C1C001C0E001C0E001C07001C07001C03807F07E0
FF8FF07F07E01419809816>75 D<FFC000FFC000FFC0001C00001C00001C00001C00001C00001C
00001C00001C00001C00001C00001C00001C00001C00001C00001C00401C00E01C00E01C00E01C
00E0FFFFE0FFFFE0FFFFE013197F9816>I<FC07E0FE0FE0FE0FE03A0B803B1B803B1B803B1B80
3B1B803B1B803BBB8039B38039B38039B38039B38039F38038E38038E380380380380380380380
380380380380FE0FE0FE0FE0FE0FE013197F9816>I<7E1FC0FF3FE07F1FC01D07001D87001D87
001D87001DC7001DC7001CC7001CC7001CE7001CE7001CE7001C67001C67001C77001C77001C37
001C37001C37001C17007F1F00FF9F007F0F0013197F9816>I<1FFC003FFE007FFF00780F00F0
0780E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E0
0380E00380F00780F00780780F007FFF003FFE001FFC0011197E9816>I<7FF800FFFE007FFF00
1C0F801C03801C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FF8001C0000
1C00001C00001C00001C00001C00001C00007F0000FF80007F000012197F9816>I<1FFC003FFE
007FFF00780F00F00780E00380E00380E00380E00380E00380E00380E00380E00380E00380E003
80E00380E00380E00380E0E380E1E380F0F780787F007FFF003FFE001FFC00001C00001E00000E
00000F00000700000700111F7E9816>I<7FE000FFF8007FFC001C1E001C0F001C07001C07001C
07001C07001C0F001C1E001FFC001FF8001FFC001C1C001C0E001C0E001C0E001C0E001C0E201C
0E701C0E707F07E0FF87E07F03C014197F9816>I<07E3001FFF007FFF00781F00F00F00E00700
E00700E00000F000007800007F80001FF00007FC0000FE00000F00000780000380000380E00380
E00380F00780F80F00FFFE00FFFC00C7F00011197E9816>I<7FFFE0FFFFE0FFFFE0E0E0E0E0E0
E0E0E0E0E0E0E000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E0
0000E00000E00000E00000E00007FC000FFE0007FC0013197F9816>I<7F07F0FF8FF87F07F01C
01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C
01C01C01C01C01C00E03800E038007070007FF0003FE0000F8001519809816>I<FE0FE0FF1FE0
FE0FE03803801C07001C07001C07001C07000E0E000E0E000E0E000E0E00060C00071C00071C00
071C00071C0003180003B80003B80003B80001B00001F00001F00000E00013197F9816>I<FC07
E0FE0FE0FC07E07001C07001C07001C030018038038038038038038038E38039F38039F38039B3
8019B30019B30019B30019B30019B30019B3001913001B1B000F1E000F1E000E0E0013197F9816
>I<7FFF80FFFF80FFFF80E00700E00F00E01E00E01C00003C0000780000700000F00001E00001
C00003C0000780000700000F00001E03801C03803C0380780380700380FFFF80FFFF80FFFF8011
197E9816>90 D<FFF0FFF0FFF0E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E000E000FFF0FFF0FFF00C20789C16>I<
C00000E00000E000007000007000003800003800001C00001C00000E00000E0000070000070000
03800003800001C00001C00000E00000E000007000007000003800003800001C00001C00000E00
000E0000070000070000038000038000018011207E9C16>I<FFF0FFF0FFF00070007000700070
007000700070007000700070007000700070007000700070007000700070007000700070007000
7000700070FFF0FFF0FFF00C207F9C16>I<FFFF80FFFF80FFFF8011037E7E16>95
D<0C1E3C7870F0E0E0E0F0F87830070D789B16>I<1FE0007FF8007FFC00783C00301E00000E00
000E0003FE001FFE007E0E00F00E00E00E00E00E00F01E00F83E007FFFE03FE7E00F83E013127E
9116>I<7E0000FE00007E00000E00000E00000E00000E00000E3E000EFF800FFFC00F83E00F01
E00E00F00E00F00E00700E00700E00700E00700E00F00F00E00F01E00F83C00FFFC00EFF00063C
001419809816>I<03F80FFE1FFE3C1E780C7000F000E000E000E000E000F000700778073E0F1F
FE0FFC03F010127D9116>I<003F00007F00003F0000070000070000070000070003C7000FF700
3FFF003C1F00780F00F00700F00700E00700E00700E00700E00700F00700F00F00781F007C3F00
3FFFE01FF7F007C7E014197F9816>I<03E00FF81FFC3C1E780E7007E007FFFFFFFFFFFFE000E0
00700778073C0F1FFE0FFC03F010127D9116>I<001F00007F8000FF8001E78001C30001C00001
C0007FFF00FFFF00FFFF0001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C0003FFE007FFF003FFE0011197F9816>I<03E3C00FFFE01FFFE01E3CC03C1E00
380E00380E00380E003C1E001E3C001FFC001FF8003BE0003800003800001FFC001FFF003FFFC0
7803C0F001E0E000E0E000E0E000E0F001E07C07C03FFF800FFE0003F800131C7F9116>I<7E00
00FE00007E00000E00000E00000E00000E00000E3C000EFF000FFF800F87800F03800F03800E03
800E03800E03800E03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01519809816
>I<018003C003C0018000000000000000007FC07FC07FC001C001C001C001C001C001C001C001
C001C001C001C001C07FFFFFFF7FFF101A7D9916>I<003000780078003000000000000000001F
F81FF81FF800380038003800380038003800380038003800380038003800380038003800380038
003800386070F0F0FFE07FC03F800D237E9916>I<7E0000FE00007E00000E00000E00000E0000
0E00000E7FE00E7FE00E7FE00E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F1E00
0E0E000E07000E07807F87F0FFCFF07F87F01419809816>I<FFC000FFC000FFC00001C00001C0
0001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C0
0001C00001C00001C00001C000FFFF80FFFF80FFFF8011197E9816>I<F9C380FFEFC0FFFFE03E
7CE03C78E03870E03870E03870E03870E03870E03870E03870E03870E03870E03870E0FE7CF8FE
7CF8FE3C781512809116>I<7E3C00FEFF007FFF800F87800F03800F03800E03800E03800E0380
0E03800E03800E03800E03800E03800E03807FC7F0FFE7F87FC7F01512809116>I<03E0000FF8
001FFC003C1E00780F00700700E00380E00380E00380E00380E00380F00780700700780F003C1E
001FFC000FF80003E00011127E9116>I<7E3E00FEFF807FFFC00F83E00F01E00E00F00E00F00E
00700E00700E00700E00700E00F00F00E00F01E00F83C00FFFC00EFF000E3C000E00000E00000E
00000E00000E00000E00007FC000FFE0007FC000141B809116>I<07C7001FF7003FFF007C3F00
781F00F00F00F00700E00700E00700E00700E00700F00700F00F00781F007C3F003FFF001FF700
07C700000700000700000700000700000700000700003FE0007FF0003FE0141B7E9116>I<FF0F
C0FF3FE0FF7FE007F04007E00007C0000780000780000700000700000700000700000700000700
00070000FFFC00FFFC00FFFC0013127F9116>I<0FEC3FFC7FFCF03CE01CE01CF0007F801FF007
FC003EE00EE00EF00EF81EFFFCFFF8C7E00F127D9116>I<030000070000070000070000070000
7FFF00FFFF00FFFF00070000070000070000070000070000070000070000070100070380070380
07078007878003FF0003FE0000F80011177F9616>I<7E1F80FE3F807E1F800E03800E03800E03
800E03800E03800E03800E03800E03800E03800E03800E07800F0F800FFFF007FFF803E3F01512
809116>I<7F1FC0FF1FE07F1FC01C07001E0F000E0E000E0E000E0E00071C00071C00071C0007
1C0003B80003B80003B80001F00001F00000E00013127F9116>I<FF1FE0FFBFE0FF1FE0380380
38038038038038038038E38019F30019F30019B3001DB7001DB7001DB7001DB7000F1E000F1E00
0F1E0013127F9116>I<7F1FC07F3FC07F1FC00F1C00073C0003B80003F00001F00000E00001E0
0001F00003B800073C00071C000E0E007F1FC0FF3FE07F1FC013127F9116>I<7F1FC0FF9FE07F
1FC01C07000E07000E0E000E0E00070E00071C00071C00039C00039C0003980001B80001B80000
F00000F00000F00000E00000E00000E00001C00079C0007BC0007F80003F00003C0000131B7F91
16>I<3FFFC07FFFC07FFFC0700780700F00701E00003C0000780001F00003E0000780000F0000
1E01C03C01C07801C0FFFFC0FFFFC0FFFFC012127F9116>I<E0E0E0E0E0E0E0E0E0E0E0E0E0E0
E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00320779C16>124 D E /Fh
82 125 df<007E1F0001C1B1800303E3C00703C3C00E03C1800E01C0000E01C0000E01C0000E01
C0000E01C0000E01C000FFFFFC000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E
01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C0000E01C000
7F87FC001A1D809C18>11 D<007E0001C1800301800703C00E03C00E01800E00000E00000E0000
0E00000E0000FFFFC00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C07F87F8151D809C17>I<007FC001C1C00303C00703
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFFFC00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C07FCFF8151D
809C17>I<003F07E00001C09C18000380F018000701F03C000E01E03C000E00E018000E00E000
000E00E000000E00E000000E00E000000E00E00000FFFFFFFC000E00E01C000E00E01C000E00E0
1C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00
E01C000E00E01C000E00E01C000E00E01C000E00E01C000E00E01C007FC7FCFF80211D809C23>
I<60F0F0F0F0F0F0F060606060606060606060606060000000000060F0F060041E7C9D0C>33
D<6060F0F0F8F86868080808080808101010102020404080800D0C7F9C15>I<60F0F868080808
1010204080050C7C9C0C>39 D<004000800100020006000C000C00180018003000300070006000
60006000E000E000E000E000E000E000E000E000E000E000E000E0006000600060007000300030
00180018000C000C00060002000100008000400A2A7D9E10>I<800040002000100018000C000C
000600060003000300038001800180018001C001C001C001C001C001C001C001C001C001C001C0
01C0018001800180038003000300060006000C000C00180010002000400080000A2A7E9E10>I<
60F0F0701010101020204080040C7C830C>44 D<FFE0FFE00B0280890E>I<60F0F06004047C83
0C>I<00030003000700060006000E000C001C0018001800380030003000700060006000E000C0
00C001C001800380030003000700060006000E000C000C001C0018001800380030007000600060
00E000C000C00010297E9E15>I<03C00C301818300C300C700E60066006E007E007E007E007E0
07E007E007E007E007E007E007E007E00760066006700E300C300C18180C3007E0101D7E9B15>
I<030007003F00C700070007000700070007000700070007000700070007000700070007000700
07000700070007000700070007000F80FFF80D1C7C9B15>I<07C01830201C400C400EF00FF80F
F807F8077007000F000E000E001C001C00380070006000C00180030006010C01180110023FFE7F
FEFFFE101C7E9B15>I<07E01830201C201C781E780E781E381E001C001C00180030006007E000
30001C001C000E000F000F700FF80FF80FF80FF00E401C201C183007E0101D7E9B15>I<000C00
000C00001C00003C00003C00005C0000DC00009C00011C00031C00021C00041C000C1C00081C00
101C00301C00201C00401C00C01C00FFFFC0001C00001C00001C00001C00001C00001C00001C00
01FFC0121C7F9B15>I<300C3FF83FF03FC020002000200020002000200023E024302818301C20
0E000E000F000F000F600FF00FF00FF00F800E401E401C2038187007C0101D7E9B15>I<00F003
0C06040C0E181E301E300C700070006000E3E0E430E818F00CF00EE006E007E007E007E007E007
600760077006300E300C18180C3003E0101D7E9B15>I<4000007FFF807FFF007FFF0040020080
040080040080080000100000100000200000600000400000C00000C00001C00001800001800003
8000038000038000038000078000078000078000078000078000078000030000111D7E9B15>I<
03E00C301008200C20066006600660067006780C3E083FB01FE007F007F818FC307E601E600FC0
07C003C003C003C00360026004300C1C1007E0101D7E9B15>I<03C00C301818300C700C600EE0
06E006E007E007E007E007E0076007700F300F18170C2707C700060006000E300C780C78187010
203030C00F80101D7E9B15>I<60F0F0600000000000000000000060F0F06004127C910C>I<60F0
F0600000000000000000000060F0F0701010101020204080041A7C910C>I<7FFFFFC0FFFFFFE0
0000000000000000000000000000000000000000000000000000000000000000FFFFFFE07FFFFF
C01B0C7E8F20>61 D<0FE03038401CE00EF00EF00EF00E000C001C0030006000C0008001800100
010001000100010001000000000000000000000003000780078003000F1D7E9C14>63
D<000600000006000000060000000F0000000F0000000F00000017800000178000001780000023
C0000023C0000023C0000041E0000041E0000041E0000080F0000080F0000180F8000100780001
FFF80003007C0002003C0002003C0006003E0004001E0004001E000C001F001E001F00FF80FFF0
1C1D7F9C1F>65 D<FFFFC00F00F00F00380F003C0F001C0F001E0F001E0F001E0F001E0F001C0F
003C0F00780F01F00FFFE00F00780F003C0F001E0F000E0F000F0F000F0F000F0F000F0F000F0F
001E0F001E0F003C0F0078FFFFE0181C7E9B1D>I<001F808000E0618001801980070007800E00
03801C0003801C00018038000180780000807800008070000080F0000000F0000000F0000000F0
000000F0000000F0000000F0000000F0000000700000807800008078000080380000801C000100
1C0001000E000200070004000180080000E03000001FC000191E7E9C1E>I<FFFFC0000F00F000
0F003C000F000E000F0007000F0007000F0003800F0003C00F0001C00F0001C00F0001E00F0001
E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001E00F0001C00F0001C00F0003C00F00
03800F0007800F0007000F000E000F001C000F007000FFFFC0001B1C7E9B20>I<FFFFFC0F003C
0F000C0F00040F00040F00060F00020F00020F02020F02000F02000F02000F06000FFE000F0600
0F02000F02000F02000F02010F00010F00020F00020F00020F00060F00060F000C0F003CFFFFFC
181C7E9B1C>I<FFFFF80F00780F00180F00080F00080F000C0F00040F00040F02040F02000F02
000F02000F06000FFE000F06000F02000F02000F02000F02000F00000F00000F00000F00000F00
000F00000F00000F8000FFF800161C7E9B1B>I<001F808000E0618001801980070007800E0003
801C0003801C00018038000180780000807800008070000080F0000000F0000000F0000000F000
0000F0000000F0000000F000FFF0F0000F80700007807800078078000780380007801C0007801C
0007800E00078007000B800180118000E06080001F80001C1E7E9C21>I<FFF3FFC00F003C000F
003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C00
0F003C000FFFFC000F003C000F003C000F003C000F003C000F003C000F003C000F003C000F003C
000F003C000F003C000F003C000F003C000F003C00FFF3FFC01A1C7E9B1F>I<FFF00F000F000F
000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F000F00
0F000F000F000F00FFF00C1C7F9B0F>I<1FFF00F8007800780078007800780078007800780078
00780078007800780078007800780078007800787078F878F878F878F0F040E021C01F00101D7F
9B15>I<FFF03FE00F000F000F000C000F0008000F0010000F0020000F0040000F0080000F0100
000F0200000F0400000F0E00000F1F00000F2F00000F2780000F4780000F83C0000F01E0000F01
E0000F00F0000F00F8000F0078000F003C000F003C000F001E000F001F000F001F80FFF07FF01C
1C7E9B20>I<FFF8000F80000F00000F00000F00000F00000F00000F00000F00000F00000F0000
0F00000F00000F00000F00000F00000F00000F00000F00080F00080F00080F00180F00180F0010
0F00300F00700F01F0FFFFF0151C7E9B1A>I<FF8000FF800F8000F8000F8000F8000BC0017800
0BC00178000BC001780009E002780009E002780008F004780008F004780008F004780008780878
0008780878000878087800083C107800083C107800083C107800081E207800081E207800081E20
7800080F407800080F40780008078078000807807800080780780008030078001C03007800FF83
07FF80211C7E9B26>I<FF007FC00F800E000F8004000BC0040009E0040009E0040008F0040008
F8040008780400083C0400083C0400081E0400080F0400080F0400080784000807C4000803C400
0801E4000801E4000800F40008007C0008007C0008003C0008003C0008001C0008000C001C000C
00FF8004001A1C7E9B1F>I<003F800000E0E0000380380007001C000E000E001C0007003C0007
8038000380780003C0780003C0700001C0F00001E0F00001E0F00001E0F00001E0F00001E0F000
01E0F00001E0F00001E0700001C0780003C0780003C0380003803C0007801C0007000E000E0007
001C000380380000E0E000003F80001B1E7E9C20>I<FFFF800F00E00F00780F003C0F001C0F00
1E0F001E0F001E0F001E0F001E0F001C0F003C0F00780F00E00FFF800F00000F00000F00000F00
000F00000F00000F00000F00000F00000F00000F00000F0000FFF000171C7E9B1C>I<FFFF0000
0F01E0000F0078000F003C000F001C000F001E000F001E000F001E000F001E000F001C000F003C
000F0078000F01E0000FFF00000F03C0000F00E0000F00F0000F0078000F0078000F0078000F00
78000F0078000F0078000F0078100F0078100F0038100F003C20FFF01C20000007C01C1D7E9B1F
>82 D<07E0801C1980300580700380600180E00180E00080E00080E00080F00000F800007C0000
7FC0003FF8001FFE0007FF0000FF80000F800007C00003C00001C08001C08001C08001C0C00180
C00180E00300D00200CC0C0083F800121E7E9C17>I<7FFFFFC0700F01C0600F00C0400F004040
0F0040C00F0020800F0020800F0020800F0020000F0000000F0000000F0000000F0000000F0000
000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F00
00000F0000000F0000001F800003FFFC001B1C7F9B1E>I<FFF07FC00F000E000F0004000F0004
000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F00
04000F0004000F0004000F0004000F0004000F0004000F0004000F0004000F0004000700080007
800800038010000180100000C020000070C000001F00001A1D7E9B1F>I<FFE00FF01F0003C00F
0001800F0001000F800300078002000780020003C0040003C0040003C0040001E0080001E00800
01F0080000F0100000F0100000F830000078200000782000003C4000003C4000003C4000001E80
00001E8000001F8000000F0000000F00000006000000060000000600001C1D7F9B1F>I<FFE0FF
E0FF1F001F003C1E001E00180F001F00100F001F00100F001F001007801F002007802780200780
27802003C027804003C043C04003C043C04003E043C04001E081E08001E081E08001E081E08000
F100F10000F100F10000F100F100007900FA00007A007A00007A007A00003E007C00003C003C00
003C003C00003C003C00001800180000180018000018001800281D7F9B2B>I<FFF007FC0F8001
E00780008007C0018003C0010003E0020001F0020000F0040000F8040000780800007C1800003C
1000001E2000001F2000000F4000000FC000000780000007800000078000000780000007800000
0780000007800000078000000780000007800000078000007FF8001E1C809B1F>89
D<FEFEC0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0FEFE07297C9E0C>91 D<08081010202040404040808080808080B0B0F8F8787830300D0C7A9C
15>I<FEFE06060606060606060606060606060606060606060606060606060606060606060606
060606FEFE0729809E0C>I<0810204040808080B0F87830050C7D9C0C>96
D<1FC000307000783800781C00301C00001C00001C0001FC000F1C00381C00701C00601C00E01C
40E01C40E01C40603C40304E801F870012127E9115>I<FC00001C00001C00001C00001C00001C
00001C00001C00001C00001C00001C00001C7C001D86001E03001C01801C01C01C00C01C00E01C
00E01C00E01C00E01C00E01C00E01C00C01C01C01C01801E030019060010F800131D7F9C17>I<
07E00C301878307870306000E000E000E000E000E000E00060007004300418080C3007C00E127E
9112>I<003F0000070000070000070000070000070000070000070000070000070000070003E7
000C1700180F00300700700700600700E00700E00700E00700E00700E00700E007006007007007
00300700180F000C370007C7E0131D7E9C17>I<03E00C301818300C700E6006E006FFFEE000E0
00E000E00060007002300218040C1803E00F127F9112>I<00F8018C071E061E0E0C0E000E000E
000E000E000E00FFE00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E007FE00F1D809C0D>I<00038003C4C00C38C01C3880181800381C00381C00381C00381C0018
18001C38000C300013C0001000003000001800001FF8001FFF001FFF803003806001C0C000C0C0
00C0C000C06001803003001C0E0007F800121C7F9215>I<FC00001C00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C7C001C87001D03001E03801C03801C03801C0380
1C03801C03801C03801C03801C03801C03801C03801C03801C03801C0380FF9FF0141D7F9C17>
I<18003C003C0018000000000000000000000000000000FC001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C00FF80091D7F9C0C>I<00C001E001E000C000000000
000000000000000000000FE000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000E060E0F0C0F1C061803E000B25839C0D>I<FC00001C00001C0000
1C00001C00001C00001C00001C00001C00001C00001C00001C3FC01C0F001C0C001C08001C1000
1C20001C40001CE0001DE0001E70001C78001C38001C3C001C1C001C0E001C0F001C0F80FF9FE0
131D7F9C16>I<FC001C001C001C001C001C001C001C001C001C001C001C001C001C001C001C00
1C001C001C001C001C001C001C001C001C001C001C001C00FF80091D7F9C0C>I<FC7E07E0001C
838838001D019018001E01E01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C00
1C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C001C01C01C
00FF8FF8FF8021127F9124>I<FC7C001C87001D03001E03801C03801C03801C03801C03801C03
801C03801C03801C03801C03801C03801C03801C03801C0380FF9FF014127F9117>I<03F0000E
1C00180600300300700380600180E001C0E001C0E001C0E001C0E001C0E001C060018070038030
03001806000E1C0003F00012127F9115>I<FC7C001D86001E03001C01801C01C01C00C01C00E0
1C00E01C00E01C00E01C00E01C00E01C01C01C01C01C01801E03001D06001CF8001C00001C0000
1C00001C00001C00001C00001C0000FF8000131A7F9117>I<03C1000C3300180B00300F007007
00700700E00700E00700E00700E00700E00700E00700600700700700300F00180F000C370007C7
00000700000700000700000700000700000700000700003FE0131A7E9116>I<FCE01D301E781E
781C301C001C001C001C001C001C001C001C001C001C001C001C00FFC00D127F9110>I<1F9030
704030C010C010E010F8007F803FE00FF000F880388018C018C018E010D0608FC00D127F9110>
I<04000400040004000C000C001C003C00FFE01C001C001C001C001C001C001C001C001C001C10
1C101C101C101C100C100E2003C00C1A7F9910>I<FC1F801C03801C03801C03801C03801C0380
1C03801C03801C03801C03801C03801C03801C03801C03801C07800C07800E1B8003E3F014127F
9117>I<FF07E03C03801C01001C01000E02000E020007040007040007040003880003880003D8
0001D00001D00000E00000E00000E00000400013127F9116>I<FF3FCFE03C0F03801C0701801C
0701001C0B01000E0B82000E0B82000E1182000711C4000711C4000720C40003A0E80003A0E800
03C0680001C0700001C0700001803000008020001B127F911E>I<7F8FF00F03800F0300070200
03840001C80001D80000F00000700000780000F800009C00010E00020E000607000403801E07C0
FF0FF81512809116>I<FF07E03C03801C01001C01000E02000E02000704000704000704000388
0003880003D80001D00001D00000E00000E00000E000004000004000008000008000F08000F100
00F300006600003C0000131A7F9116>I<7FFC70386038407040F040E041C003C0038007000F04
0E041C043C0C380870087038FFF80E127F9112>I<FFFFF01401808B15>I<FFFFFFFFFF80290180
8B2A>I E /Fi 20 122 df<FFFFFF8000FFFFFFF00007E000FC0003E0007E0003E0003F0003E0
001F8003E0000F8003E0000F8003E0000FC003E0000FC003E0000FC003E0000FC003E0000FC003
E0000F8003E0001F8003E0001F0003E0003E0003E0007C0003E001F80003FFFFE00003E000F800
03E0003E0003E0001F0003E0000F8003E00007C003E00007E003E00003E003E00003F003E00003
F003E00003F003E00003F003E00003F003E00003F003E00007E003E00007E003E0000FC003E000
1F8003E0003F0007E000FE00FFFFFFF800FFFFFFE00024297EA82A>66 D<0000FF00100007FFE0
30001FC07830003E000C7000F80006F001F00003F003E00001F007C00000F00F800000700F8000
00701F000000303F000000303E000000303E000000107E000000107E000000107C00000000FC00
000000FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000FC
000000007C000000007E000000007E000000103E000000103E000000103F000000101F00000020
0F800000200F8000006007C000004003E000008001F000018000F8000300003E000E00001FC038
000007FFE0000000FF8000242B7DA92B>I<FFFF80FFFF8007F00003E00003E00003E00003E000
03E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E000
03E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E00003E000
03E00003E00003E00003E00003E00007F000FFFF80FFFF8011297EA816>73
D<FFE0000003FFC0FFE0000003FFC007E0000003F80002F0000005F00002F0000005F000027800
0009F0000278000009F0000278000009F000023C000011F000023C000011F000021E000021F000
021E000021F000021E000021F000020F000041F000020F000041F0000207800081F00002078000
81F0000207800081F0000203C00101F0000203C00101F0000203E00201F0000201E00201F00002
01E00201F0000200F00401F0000200F00401F0000200F00401F0000200780801F0000200780801
F00002003C1001F00002003C1001F00002003C1001F00002001E2001F00002001E2001F0000200
0F4001F00002000F4001F00002000F4001F0000200078001F0000700078001F0000F80030003F8
00FFF803007FFFC0FFF803007FFFC032297EA837>77 D<01FC00000E0780001001C0003C00E000
3E00F0003E0078001C00780008007800000078000000780000007800007FF80003E078000F8078
001F0078003E0078007C00780078007820F8007820F8007820F8007820F800F8207C00F8203C01
3C401F063FC007F80F001B1A7E991E>97 D<07800000FF800000FF8000000F8000000780000007
800000078000000780000007800000078000000780000007800000078000000780000007800000
078000000783F000078C1C0007B0070007A0038007C003C0078001E0078001E0078000F0078000
F0078000F8078000F8078000F8078000F8078000F8078000F8078000F8078000F0078000F00780
01F0078001E0078001C007C003C00740078007200E0006181C000407E0001D2A7FA921>I<0000
0F000001FF000001FF0000001F0000000F0000000F0000000F0000000F0000000F0000000F0000
000F0000000F0000000F0000000F0000000F0000000F00003F0F0001C0CF0003802F000F001F00
1E001F001C000F003C000F007C000F0078000F0078000F00F8000F00F8000F00F8000F00F8000F
00F8000F00F8000F00F8000F0078000F0078000F003C000F003C000F001E001F000E002F000700
4F8001C18FF8007E0FF81D2A7EA921>100 D<007E0003C3800700E00E00F01C00703C00783C00
3878003C78003CF8003CF8003CFFFFFCF80000F80000F80000F80000F800007800007C00003C00
043C00041E00080E001007002001C0C0007F00161A7E991B>I<0000078001FC1840070721C00E
03C1C01E03C0803C01E0003C01E0007C01F0007C01F0007C01F0007C01F0007C01F0003C01E000
3C01E0001E03C0000E0380001707000011FC0000300000003000000030000000380000001C0000
001FFFC0000FFFF80007FFFC001C003E0030000F007000070060000380E0000380E0000380E000
0380E0000380700007007000070038000E000C0018000780F00000FF80001A287E9A1E>103
D<07000F801F801F800F80070000000000000000000000000000000000000007807F807F800F80
078007800780078007800780078007800780078007800780078007800780078007800780078007
80FFF8FFF80D297FA811>105 D<0780FF80FF800F800780078007800780078007800780078007
800780078007800780078007800780078007800780078007800780078007800780078007800780
07800780078007800780078007800780FFFCFFFC0E2A7FA911>108 D<0781F800FC00FF860E03
0700FF98070C03800FA0079003C007A003D001E007C003E001E007C003E001E0078003C001E007
8003C001E0078003C001E0078003C001E0078003C001E0078003C001E0078003C001E0078003C0
01E0078003C001E0078003C001E0078003C001E0078003C001E0078003C001E0078003C001E007
8003C001E0078003C001E0078003C001E0FFFC7FFE3FFFFFFC7FFE3FFF301A7F9933>I<0783F8
00FF8C1C00FF900E000FA0070007A0078007C0078007C007800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780078007800780078007
800780078007800780078007800780FFFCFFFCFFFCFFFC1E1A7F9921>I<007F000001C1C00007
0070000E0038001C001C003C001E003C001E0078000F0078000F00F8000F80F8000F80F8000F80
F8000F80F8000F80F8000F80F8000F80F8000F8078000F0078000F003C001E003C001E001E003C
000E0038000700700001C1C000007F0000191A7E991E>I<0783F000FF8C1C00FFB00F0007A007
8007C003C0078003E0078001E0078001F0078001F0078000F8078000F8078000F8078000F80780
00F8078000F8078000F8078000F0078001F0078001F0078001E0078003C007C003C007C0078007
A00E0007983C000787E00007800000078000000780000007800000078000000780000007800000
078000000780000007800000FFFC0000FFFC00001D267F9921>I<0787C0FF98E0FF91F00FA1F0
07C1F007C0E007C000078000078000078000078000078000078000078000078000078000078000
07800007800007800007800007800007800007C000FFFE00FFFE00141A7F9917>114
D<07F8401C06C03001C06000C06000C0E00040E00040F00040F800007E00007FF0003FFE000FFF
0003FF80003FC00007C08001E08001E0C000E0C000E0C000E0E000C0F001C0F80180C4070083F8
00131A7E9918>I<0080000080000080000080000180000180000180000380000380000780000F
80001FFF80FFFF8007800007800007800007800007800007800007800007800007800007800007
800007800007800007804007804007804007804007804007804007804003C08001C08000E10000
3E0012257FA417>I<07800780FF80FF80FF80FF800F800F800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780078007800780078007
800780078007800780078007800F8007800F800380178001C027C000E047FC003F87FC1E1A7F99
21>I<FFF00FF8FFF00FF80F8003C0078003800780010003C0020003C0020003E0020001E00400
01E0040000F0080000F0080000F818000078100000781000003C2000003C2000003E6000001E40
00001E4000000F8000000F80000007000000070000000700000002000000020000000400000004
0000000400000008000070080000F8100000F8100000F8200000F0400000608000001F0000001D
267F9920>121 D E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 392 101 a Fi(Building)19 b(In)n(terpreters)i(b)n(y)f(Comp)r(osing)e
(Monads)819 188 y Fh(Guy)c(L.)f(Steele)i(Jr.)684 255 y(Thinking)e(Mac)o
(hines)h(Corp)q(oration)832 304 y(245)f(First)h(Street)669
354 y(Cam)o(bridge,)e(Massac)o(h)o(usetts)29 b(02142)841 416
y(\(617\))14 b(234-2860)833 479 y Fg(gls@think.com)-75 664
y Ff(Abstract:)39 b Fh(W)m(e)25 b(exhibit)f(a)h(set)g(of)g(functions)f(co)q
(ded)i(in)-75 714 y(Hask)o(ell)12 b(that)g(can)g(b)q(e)g(used)h(as)f
(building)f(blo)q(c)o(ks)h(to)g(construct)-75 764 y(a)19 b(v)n(ariet)o(y)h
(of)f(in)o(terpreters)j(for)d(Lisp-lik)o(e)g(languages.)35
b(The)-75 813 y(building)21 b(blo)q(c)o(ks)h(are)g(joined)g(merely)f(through)
i(functional)-75 863 y(comp)q(osition.)28 b(Eac)o(h)18 b(building)f(blo)q(c)o
(k)g(con)o(tributes)i(co)q(de)g(to)-75 913 y(supp)q(ort)f(a)f(sp)q(eci\014c)i
(feature,)g(suc)o(h)f(as)g(n)o(um)o(b)q(ers,)f(con)o(tin)o(ua-)-75
963 y(tions,)c(functions)h(calls,)f(or)h(nondeterminism.)i(The)f(result)f(of)
-75 1013 y(comp)q(osing)g(some)g(n)o(um)o(b)q(er)g(of)h(building)e(blo)q(c)o
(ks)i(is)g(a)g(parser,)-75 1062 y(an)i(in)o(terpreter,)j(and)d(a)h(prin)o
(ter)g(that)f(supp)q(ort)h(exactly)g(the)-75 1112 y(expression)i(forms)e(and)
h(data)g(t)o(yp)q(es)h(needed)h(for)d(the)i(com-)-75 1162 y(bined)14
b(set)h(of)e(features,)i(and)e(no)h(more.)-38 1212 y(The)j(data)e(structures)
k(are)d(organized)g(as)g Fe(pseudomonads)p Fh(,)-75 1262 y(a)24
b(generalization)f(of)g(monads)f(that)i(allo)o(ws)f(comp)q(osition.)-75
1311 y(F)m(unctional)18 b(comp)q(osition)f(of)i(the)h(building)d(blo)q(c)o
(ks)j(implies)-75 1361 y(t)o(yp)q(e)14 b(comp)q(osition)e(of)i(the)g(relev)n
(an)o(t)g(pseudomonads.)-38 1411 y(Our)j(in)o(ten)o(t)g(w)o(as)f(that)h(the)g
(Hask)o(ell)f(t)o(yp)q(e)h(resolution)f(sys-)-75 1461 y(tem)j(ough)o(t)h(to)f
(b)q(e)i(able)f(to)f(deduce)j(the)e(approprate)h(data)-75 1511
y(t)o(yp)q(es)13 b(automatically)l(.)i(Unfortunately)d(there)h(is)f(a)g
(de\014ciency)-75 1561 y(in)i(curren)o(t)i(Hask)o(ell)e(implemen)o(tations)e
(related)j(to)f(recursiv)o(e)-75 1610 y(data)c(t)o(yp)q(es:)17
b(circularit)o(y)10 b(m)o(ust)f(b)q(e)i(re\015ected)i(statically)c(in)h(the)
-75 1660 y(t)o(yp)q(e)k(de\014nitions.)-38 1710 y(W)m(e)e(circum)o(v)o(en)o
(t)f(this)g(restriction)i(b)o(y)e(applying)f(a)i(purp)q(ose-)-75
1760 y(built)d(program)f(simpli\014er)g(that)h(p)q(erforms)g(partial)g(ev)n
(aluation)-75 1810 y(and)i(a)h(certain)g(amoun)o(t)d(of)i(program)f(algebra.)
17 b(W)m(e)11 b(construct)-75 1859 y(a)k(wide)g(v)n(ariet)o(y)f(of)h(in)o
(terpreters)i(in)e(the)h(st)o(yle)f(of)g(W)m(adler)f(b)o(y)-75
1909 y(starting)i(with)g(the)g(building)f(blo)q(c)o(ks)g(and)h(a)g(page)g(of)
f(b)q(oiler-)-75 1959 y(plate)10 b(co)q(de,)i(writing)e(three)h(lines)g(of)f
(co)q(de)h(\(one)g(to)f(sp)q(ecify)h(the)-75 2009 y(building)16
b(blo)q(c)o(ks)h(and)g(t)o(w)o(o)g(to)g(\(redundan)o(tly\))g(sp)q(ecify)h(t)o
(yp)q(e)-75 2059 y(comp)q(ositions\),)g(and)h(then)h(applying)e(the)h
(simpli\014er.)32 b(The)-75 2108 y(resulting)14 b(co)q(de)h(is)e(acceptable)i
(Hask)o(ell)f(co)q(de.)-38 2158 y(W)m(e)22 b(ha)o(v)o(e)f(tested)j(a)d(dozen)
i(di\013eren)o(t)g(in)o(terpreters)h(with)-75 2208 y(v)n(arious)14
b(com)o(binations)g(of)g(features.)23 b(In)15 b(this)h(pap)q(er)f(w)o(e)h
(dis-)-75 2258 y(cuss)i(the)f(o)o(v)o(erall)f(co)q(de)i(structuring)f
(strategy)m(,)h(exhibit)e(sev-)-75 2308 y(eral)h(building)e(blo)q(c)o(ks,)i
(brie\015y)h(describ)q(e)g(the)g(partial)d(ev)n(alu-)-75 2358
y(ator,)g(and)f(presen)o(t)j(a)e(n)o(um)o(b)q(er)f(of)g(automatically)e
(generated)-75 2407 y(in)o(terpreters.)-38 2519 y Fe(This)29
b(is)f(a)h(pr)n(eprint)f(of)g(a)h(p)n(ap)n(er)g(that)f(is)h(to)f(app)n(e)n
(ar)-75 2569 y(in)c(the)h(Pr)n(o)n(c)n(e)n(e)n(dings)f(of)g(the)h
(Twenty-\014rst)e(A)o(nnual)i(A)o(CM)-75 2619 y(SIGPLAN-SIGA)o(CT)19
b(Symp)n(osium)h(on)g(Principles)f(of)g(Pr)n(o-)-75 2669 y(gr)n(amming)c(L)n
(anguages,)g(January)h(1994.)1022 664 y Ff(1)48 b(In)o(tro)q(duction)1022
747 y Fh(I)19 b(really)g(lik)o(ed)f(Phil)g(W)m(adler's)h(w)o(ork)f(on)h
(monads)f([15)o(,)g(16].)1022 797 y(But)g(I)g(w)o(as)f(not)h(en)o(tirely)f
(satis\014ed)i(with)e(the)h(metho)q(dology)1022 847 y(for)13
b(constructing)h(new)g(in)o(terpreters)h(b)o(y)e(writing)f(a)h(single)g(in-)
1022 896 y(terpreter)h(and)c(then)i(plugging)d(in)i(v)n(arious)f(monads.)15
b(While)10 b(it)1022 946 y(w)o(as)i(not)g(necessary)j(to)d(mo)q(dify)d(the)k
(co)q(de)g(of)f(the)h(in)o(terpreter,)1022 996 y(it)j(w)o(as)f(necessary)j
(to)e(alter)f(\\b)o(y)h(hand")f(the)h(data)g(structure)1022
1046 y(de\014nitions)10 b(for)g(b)q(oth)f(the)i(input)e(expressions)j(and)d
(the)i(output)1022 1096 y(v)n(alues.)18 b(It)c(seemed)g(to)g(me)f(that)h
(this)g(could)f(b)q(e)i(automated.)1060 1145 y(Another)21 b(problem)f(w)o(as)
h(that,)h(while)e(there)i(w)o(ere)g(man)o(y)1022 1195 y(monads)16
b(to)h(c)o(ho)q(ose)i(from,)c(they)j(w)o(ere)h(one)e(to)g(a)g(customer.)1022
1245 y(Y)m(ou)g(could)g(ha)o(v)o(e)g(an)g(in)o(terpreter)i(with)e(state,)h
Fe(or)f Fh(an)g(in)o(ter-)1022 1295 y(preter)i(with)e(con)o(tin)o(uations,)f
(but)i(not)f(an)f(in)o(terpreter)j(with)1022 1345 y(con)o(tin)o(uations)14
b(and)f(state.)1060 1394 y(I)e(had)h(a)f(vision)g(of)g(building)g(blo)q(c)o
(ks,)g(lik)o(e)g(Legos)h(or)g(Tink)o(er-)1022 1444 y(to)o(ys,)19
b(that)f(could)g(b)q(e)h(used)g(in)o(terc)o(hangeably)g(and)f(in)f(com-)1022
1494 y(bination)h(to)g(build)g(in)o(terpreters.)34 b(It)19
b(seemed)g(that)g(if)e(they)1022 1544 y(could)d(b)q(e)h(com)o(bined)e(b)o(y)h
(functional)f(comp)q(osition,)f(then)i(the)1022 1594 y(Hask)o(ell)h([2)o(])g
(t)o(yp)q(e)g(system,)g(or)g(an)g(extension)h(of)e(it,)g(ough)o(t)h(to)1022
1644 y(b)q(e)d(able)g(to)f(deduce)i(the)f(relev)n(an)o(t)g(data)f(t)o(yp)q
(es)h(automatically)l(.)1060 1693 y(It)20 b(can)f(b)q(e)i(done.)36
b(With)19 b(the)h(function)g(de\014nitions)f(pre-)1022 1743
y(sen)o(ted)14 b(in)e(this)h(pap)q(er,)g(the)g(v)n(alue)f(of)g(the)i(Hask)o
(ell)e(expression)1022 1820 y Fg(complete)20 b(\(nondeterministic)f(\(cbv)i
(interpreter\)\))1022 1897 y Fh(is)27 b(in)f(fact)h(a)g(complete)f
(nondeterministic)g(call-b)o(y-v)n(alue)1022 1946 y(in)o(terpreter|indeed,)33
b(not)27 b(only)f(an)i(in)o(terpreter,)k(but)27 b(a)1022 1996
y(parser)15 b(and)f(a)g(prin)o(ter)g(as)g(w)o(ell.)j(Similarly)m(,)10
b(the)k(result)h(of)1022 2073 y Fg(complete)20 b(\(cbn)h(\(numbers)g
(interpreter\)\))1022 2150 y Fh(is)11 b(a)g(complete)g(call-b)o(y-name)e(n)o
(um)o(b)q(ers)i(in)o(terpreter;)i(and)e(the)1022 2199 y(expression)1022
2276 y Fg(complete)20 b(\(continuation)g(\(nondeterminist)o(ic)1066
2326 y(\(cbv)h(\(numbers)f(interpreter\)\)\)\))1022 2402 y
Fh(pro)q(duces)13 b(a)e(complete)f(con)o(tin)o(uation)g(nondeterministic)h
(call-)1022 2452 y(b)o(y-v)n(alue)i(n)o(um)o(b)q(ers)h(in)o(terpreter.)1022
2567 y Ff(2)48 b(Pseudomonads)1022 2650 y Fh(W)m(e)18 b(structure)j(our)e(in)
o(terpreter)h(building)d(blo)q(c)o(ks)i(b)o(y)f(using)1022
2700 y Fe(pseudomonads)p Fh(,)c(a)e(generalization)g(of)f(monads)g(that)h(p)q
(ermits)p eop
%%Page: 2 2
2 1 bop -87 -73 1027 2 v -87 1919 2 1993 v -75 4 a Fg(infixl)21
b(4)g(&)-75 54 y(infixl)g(1)g(<<,)g(#,)h(>>)-75 128 y(type)f(Unitfn)g(p)g(q)h
(=)f(p)h(->)f(q)-75 177 y(type)g(Bindfn)g(p)g(q)h(=)f(q)h(->)f(\(p)h(->)f
(q\))g(->)h(q)-75 255 y(type)f(Pseudobindfn)e(p)j(q)f(=)109
b(--)22 b(See)f(text)-31 305 y(Monad)f(q)i(r)g(->)f(q)g(->)h(\(p)f(->)h(r\))f
(->)g(r)-75 382 y(data)g(Monad)g(p)g(q)h(=)-31 432 y(Monad)e(\(Unitfn)h(p)g
(q\))h(\(Bindfn)e(p)i(q\))-75 509 y(unit)f(::)g(Monad)g(p)h(q)f(->)h(Unitfn)e
(p)i(q)-75 559 y(unit)f(\(Monad)g(u)g(b\))g(=)h(u)-75 630 y(bind)f(::)g
(Monad)g(p)h(q)f(->)h(Bindfn)e(p)i(q)-75 680 y(bind)f(\(Monad)g(u)g(b\))g(=)h
(b)-75 752 y(idmonad)e(::)i(Monad)e(p)i(p)-75 801 y(idmonad)e(=)i(Monad)f
(\(\\x)g(->)g(x\))h(\(\\z)f(k)g(->)h(k)f(z\))-75 873 y(data)g(Pseudomonad)e
(p)j(q)g(=)-31 923 y(Pseudomonad)d(\(Unitfn)h(p)i(q\))f(\(Pseudobindfn)f(p)h
(q\))-75 1000 y(pseudounit)f(::)h(Pseudomonad)f(p)h(q)h(->)f(Unitfn)g(p)g(q)
-75 1050 y(pseudounit)f(\(Pseudomonad)f(u)j(pb\))f(=)g(u)-75
1127 y(pseudobind)f(::)-31 1177 y(Pseudomonad)f(p)j(q)f(->)h(Pseudobindfn)d
(p)j(q)-75 1227 y(pseudobind)e(\(Pseudomonad)f(u)j(pb\))f(=)g(pb)-75
1304 y(data)g(Bindtemp)f(p)i(q)f(a)h(b)f(c)h(=)g(Bind2)e(\(p,)i(q\))448
1354 y(|)g(Bind3)e(\(a,)i(b,)f(c\))-75 1428 y(x)h(<<)f(y)h(=)f(Bind2)g(\(x,)g
(y\))-75 1505 y(\(Bind2)g(\(x,)g(y\)\))g(#)g(z)h(=)g(Bind3)e(\(x,)i(y,)f(z\))
-75 1582 y(\(Bind2)g(\(x,)g(y\)\))g(>>)g(f)h(=)f(bind)g(y)h(x)g(f)-75
1632 y(\(Bind3)f(\(x,)g(y,)g(z\)\))g(>>)h(f)f(=)h(pseudobind)e(z)h(y)h(x)f(f)
-75 1710 y(m&p)g(=)h(Monad)f(\(unit)f(m)i(.)f(pseudounit)f(p\))187
1759 y(\(\\z)h(k)g(->)h(z)f(<<m>>)g(\(\\w)g(->)383 1809 y(w)g(<<m#p>>)g
(k\)\))-53 1900 y Fh(Figure)14 b(1:)k(Hask)o(ell)c(co)q(de)g(for)g(supp)q
(orting)g(pseudomonads)p 938 1919 V -87 1921 1027 2 v -75 2045
a(comp)q(osition.)j(The)e(theory)g(of)e(pseudomonads)h(is)g(describ)q(ed)-75
2095 y(in)c(a)f(companion)f(pap)q(er)j([11)o(].)16 b(The)11
b(supp)q(ort)f(co)q(de)h(in)f(Figure)g(1)-75 2145 y(is)k(tak)o(en)g(v)o
(erbatim)e(from)g(that)i(pap)q(er.)-38 2195 y(In)k(order)h(to)f(con)o(v)o(ey)
h(necessary)h(t)o(yp)q(e)e(information,)e(it)i(is)-75 2244
y(con)o(v)o(enien)o(t)23 b(to)f Fe(r)n(eify)g Fh(monads)f(and)h
(pseudomonads.)43 b(W)m(e)-75 2294 y(represen)o(t)18 b(a)e(monad)e(in)h(Hask)
o(ell)g(as)h(an)g(algebraic)f(datat)o(yp)q(e)-75 2344 y Fg(Monad)i
Fh(encapsulating)i(the)g(unit)g(and)f(bind)g(op)q(erations)h(for)-75
2394 y(the)d(monad.)k(Note)c(that)f(w)o(e)g(use)h(the)g(name)e
Fg(Monad)g Fh(as)i(b)q(oth)-75 2444 y(a)c(t)o(yp)q(e)h(constructor)h(and)e(a)
g(data)g(constructor,)i(a)e(con)o(v)o(enien)o(t)-75 2493 y(pun)h(p)q
(ermitted)g(b)o(y)g(Hask)o(ell.)18 b(W)m(e)12 b(then)i(de\014ne)g(generic)h
Fg(unit)-75 2543 y Fh(and)f Fg(bind)f Fh(op)q(erations.)-38
2593 y(In)18 b(W)m(adler's)f(st)o(yle,)h(one)g(sp)q(eaks)h(of)e(the)i(t)o(yp)
q(e)f Fg(a)f Fh(and)h(the)-75 2643 y(t)o(yp)q(e)f Fg(M)22 b(a)16
b Fh(to)g(whic)o(h)g(the)h(t)o(yp)q(e)g(constructor)i Fg(M)d
Fh(maps)f Fg(a)p Fh(;)i(the)-75 2693 y(monad)8 b(in)i(question)h(is)f(not)g
(itself)g(an)g(ob)r(ject)h(of)f(the)h(language,)1022 -33 y(but)18
b(merely)e(the)h(conceptual)h(triple)f(\()p Fg(M)p Fd(;)7 b
Fg(unitM)n Fd(;)g Fg(bindM)o Fh(\).)27 b(In)1022 16 y(our)15
b(st)o(yle,)f(a)g(monad)e(is)j(an)f(ob)r(ject)h(of)e(t)o(yp)q(e)i
Fg(Monad)21 b(a)h(b)p Fh(,)13 b(the)1022 66 y(t)o(yp)q(e)j(of)e(monads)f
(that)i(map)e(t)o(yp)q(e)i Fg(a)g Fh(to)f(t)o(yp)q(e)i Fg(b)p
Fh(;)e(th)o(us)h Fg(b)g Fh(cor-)1022 116 y(resp)q(onds)h(to)d(W)m(adler's)g
(t)o(yp)q(e)i Fg(M)21 b(a)p Fh(.)1060 166 y(As)11 b(an)f(example,)g(the)h
(declaration)g(of)f Fg(idmonad)f Fh(in)h(Figure)h(1)1022 216
y(de\014nes)16 b(the)e(usual)g(iden)o(tit)o(y)f(monad.)1060
265 y(\(A)h(w)o(ord)g(ab)q(out)f(syn)o(tax:)19 b(W)m(adler)13
b(used)h(Hask)o(ell)g(in\014x)f(no-)1022 315 y(tation)d(for)g(the)g(v)n
(arious)g(monad)e(binding)h(op)q(erations,)i(writing)1022 365
y Fg(x)22 b(`bindM`)e(f)c Fh(instead)h(of)f Fg(bindM)k(x)i(f)p
Fh(.)j(Our)17 b(generic)g Fg(bind)1022 415 y Fh(op)q(eration)h(tak)o(es)f
Fe(thr)n(e)n(e)g Fh(argumen)o(ts:)24 b(a)18 b(monad,)d(an)j(ob)r(ject,)1022
465 y(and)11 b(a)g(function.)16 b(Ho)o(w)o(ev)o(er,)c(the)g(in\014x)e
(notation)g(is)h(quite)g(con-)1022 514 y(v)o(enien)o(t,)19
b(particularly)e(for)g(exhibiting)g(the)h(asso)q(ciativ)o(e)g(la)o(w)1022
564 y(for)d(monads,)f(so)h(w)o(e)h(ha)o(v)o(e)f(devised)h(a)e(kluge:)21
b(w)o(e)15 b(de\014ne)h(t)o(w)o(o)1022 614 y(Hask)o(ell)e(in\014x)f(op)q
(erators)i Fg(<<)f Fh(and)g Fg(>>)f Fh(so)h(that)g(w)o(e)h(ma)o(y)d(write)
1022 664 y Fg(bind)21 b(m)h(x)f(f)15 b Fh(as)g Fg(x)21 b(<<m>>)g(f)p
Fh(.)f(The)15 b(co)q(de)h(for)e(this)h(is)f(also)g(in)1022
714 y(Figure)g(1.\))1060 764 y(A)19 b(pseudomonad)g(is)h(only)f(a)g(sligh)o
(t)g(generalization)g(of)g(a)1022 813 y(monad.)33 b(A)19 b(pseudomonad)f
(encapsulates)j(t)o(w)o(o)e(op)q(erations)1022 863 y(called)e
Fg(pseudounit)e Fh(and)i Fg(pseudobind)p Fh(.)25 b(The)17 b
Fg(pseudounit)1022 913 y Fh(op)q(eration)22 b(is)g(iden)o(tical)f(in)g(its)h
(nature)g(to)g Fg(unit)p Fh(,)g(but)g(the)1022 963 y Fg(pseudobind)13
b Fh(op)q(eration)i(tak)o(es)g(an)f(extra)i(argumen)o(t,)d(b)q(efore)1022
1013 y(the)f(ob)r(ject)h(and)e(the)h(function)f(to)g(b)q(e)h(applied,)f(that)
h(is)f(itself)g(a)1022 1062 y(monad.)16 b(The)11 b(idea)g(is)g(that)g
Fg(pseudobind)e Fh(un)o(wraps)i(an)g(ob)r(ject)1022 1112 y(of)i(t)o(yp)q(e)i
Fg(q)p Fh(,)e(rev)o(ealing)g(an)g(ob)r(ject)i(of)e(t)o(yp)q(e)h
Fg(p)p Fh(.)k(This)c(ma)o(y)d(then)1022 1162 y(b)q(e)17 b(fed)g(to)g(the)g
(function,)f(but)h(the)g(function)f(need)i(not)e(pro-)1022
1212 y(duce)e(a)e(result)i(of)e(t)o(yp)q(e)h Fg(q)p Fh(;)f(instead,)h(it)f
(ma)o(y)f(pro)q(duce)j(a)e(result)1022 1262 y(of)18 b(some)f(other)h(t)o(yp)q
(e)h Fg(r)p Fh(.)30 b(The)18 b(monad)f(argumen)o(t)f(m)o(ust)h(b)q(e)1022
1311 y(of)12 b(t)o(yp)q(e)h Fg(Monad)21 b(q)g(r)p Fh(,)12 b(th)o(us)h(sp)q
(ecifying)g(a)f(w)o(a)o(y)f(to)i(tak)o(e)f(v)n(alues)1022 1361
y(of)17 b(t)o(yp)q(e)g Fg(q)g Fh(to)f(t)o(yp)q(e)i Fg(r)p Fh(.)26
b(The)17 b(motiv)n(ation)d(is)j(that)g(the)g(pseu-)1022 1411
y(dobinding)11 b(op)q(eration)g(migh)o(t)f(not)h(in)o(v)o(ok)o(e)g(the)h
(function)g(after)1022 1461 y(all,)g(in)i(whic)o(h)f(case)i(it)e(needs)i
(some)e(other)h(w)o(a)o(y)f(to)g(pro)q(duce)i(a)1022 1511 y(result)g(of)e(t)o
(yp)q(e)i Fg(r)p Fh(.)1060 1561 y(\(More)f(ab)q(out)g(syn)o(tax:)19
b(The)c(generic)g Fg(pseudobind)d Fh(op)q(era-)1022 1610 y(tion)d(tak)o(es)h
Fe(four)f Fh(argumen)o(ts.)16 b(W)m(e)8 b(de\014ne)j Fg(#)e
Fh(as)g(y)o(et)h(another)g(in-)1022 1660 y(\014x)i(op)q(erator)h(so)f(that)f
(w)o(e)i(ma)o(y)d(write)i Fg(pseudobind)19 b(p)j(m)g(x)f(f)1022
1710 y Fh(as)16 b Fg(x)21 b(<<m#p>>)f(f)p Fh(.)i(This)15 b(syn)o(tax)g(happ)q
(ens)h(to)f(b)q(e)h(used)g(only)1022 1760 y(once)g(in)f(the)g(co)q(de)h
(\014gures)g(in)f(this)g(pap)q(er,)h(in)f(the)g(de\014nition)1022
1810 y(of)f Fg(&)f Fh(in)h(Figure)g(1.\))1060 1859 y(In)g(short,)h(a)f
(pseudomonad)f(is)h(simply)f(a)h(monad)e(that)j(has)1022 1909
y(b)q(een)k(parameterized)f(b)o(y)g(another)g(monad,)e(in)i(exactly)f(the)
1022 1959 y(same)12 b(manner)h(that)g(W)m(adler)f(parameterized)h(an)g(in)o
(terpreter)1022 2009 y(b)o(y)h(a)g(monad.)1060 2059 y(Pseudomonads)j(are)i
(assumed)e(\(and)h(should)g(b)q(e)h(pro)o(v)o(ed\))1022 2108
y(to)14 b(ob)q(ey)g(three)i(la)o(ws)d(analogous)g(to)g(those)i(for)f(monads.)
j(The)1022 2158 y(monad)12 b(la)o(ws,)h(expressed)j(in)e Fe(unit)p
Fh(/)p Fe(bind)g Fh(form,)e(are:)1022 2241 y(Left)i(unit:)1066
2291 y Fg(unit)21 b(m)g(a)h(<<m>>)f(f)41 b Fc(\021)h Fg(f)21
b(a)1022 2353 y Fh(Righ)o(t)13 b(unit:)1066 2403 y Fg(x)21
b(<<m>>)g(unit)g(m)42 b Fc(\021)f Fg(x)1022 2465 y Fh(Asso)q(ciativ)o(e:)1153
2515 y Fg(x)22 b(<<m>>)e(\(\\a)i(->)f(f)h(a)43 b(<<m>>)21 b(g\))1057
2565 y Fc(\021)42 b Fg(\(x)22 b(<<m>>)42 b(\\a)22 b(->)f(f)h(a\))f(<<m>>)g(g)
1022 2648 y Fh(\(Remem)o(b)q(er)h(that)h Fg(<<...>>)f Fh(has)h(lo)o(w)o(er)g
(syn)o(tactic)g(prece-)1022 2698 y(dence)16 b(than)d(function)h
(application.\))p eop
%%Page: 3 3
3 2 bop -38 -33 a Fh(The)15 b(analogous)d(la)o(ws)i(for)f(pseudomonads)g
(are:)-75 44 y(Left)h(unit:)-31 93 y Fg(unit)21 b(p)g(a)h(<<m#p>>)e(f)41
b Fc(\021)h Fg(f)22 b(a)-75 156 y Fh(Righ)o(t)13 b(unit:)-31
205 y Fg(x)21 b(<<m#p>>)g(\(h)g(.)g(unit)g(p\))42 b Fc(\021)f
Fg(h)22 b(x)-75 268 y Fh(Asso)q(ciativ)o(e:)56 318 y Fg(x)152
b(<<m#p>>)20 b(\(\\a)i(->)f(f)h(a)43 b(<<m#p>>)20 b(g\))-40
367 y Fc(\021)42 b Fg(\(x)21 b(<<idmonad#p>>)41 b(\\a)22 b(->)f(f)h(a\))f
(<<m#p>>)f(g)-38 444 y Fh(The)e(comp)q(osition)e(op)q(erator)i
Fg(m&p)f Fh(comp)q(oses)g(a)g(monad)f Fg(m)-75 494 y Fh(and)d(a)h
(pseudomonad)e Fg(p)i Fh(to)f(pro)q(duce)i(what)e(migh)o(t)f(b)q(e)i(a)f(new)
-75 544 y(monad.)20 b(If)15 b(the)h(monad)d(ob)q(eys)j(the)f(three)i(monad)c
(la)o(ws)i(and)-75 594 y(the)k(pseudomonad)e(ob)q(eys)i(the)h(three)f
(pseudomonad)f(la)o(ws,)-75 644 y(then)12 b(the)h(comp)q(osition)d
(necessarily)j(ob)q(eys)f(the)h(left)e(unit)h(and)-75 693 y(righ)o(t)j(unit)g
(monad)f(la)o(ws.)22 b(A)16 b(separate)h(pro)q(of)e(m)o(ust)f(b)q(e)i(sup-)
-75 743 y(plied)g(that)h(the)g(resulting)g(monad)d(ob)q(eys)k(the)f(monad)e
(asso-)-75 793 y(ciativ)o(e)i(la)o(w)g(\(and)g(this)g(is)h(consisten)o(t)g
(with)f(the)h(exp)q(erience)-75 843 y(of)12 b(Moggi)g([6)o(])h(and)g(others)h
(that)f(monads)e(do)i(not)g(comp)q(ose)f(in)-75 893 y(general\).)-38
943 y(\(W)m(e)e(note)g(in)f(passing)h(that)g(there)h(is)f(in)f(fact)h(a)g
(more)e(general)-75 992 y(theory)13 b(of)f(pseudmonads)g(in)g(whic)o(h)g(the)
h(\014rst)g(argumen)o(t)f(to)g(a)-75 1042 y(pseudobind)17 b(op)q(eration)f
(is)h(a)f(pseudomonad)f(rather)i(than)g(a)-75 1092 y(monad.)f(The)d(comp)q
(osition)e(op)q(erator)i Fg(&)f Fh(then)h(com)o(bines)f(t)o(w)o(o)-75
1142 y(pseudomonads)h(to)h(pro)q(duce)h(a)f(third)g(pseudomonad:)-38
1219 y Fg(pb&pa)21 b(=)h(Pseudomonad)180 1269 y(\(pseudounit)e(mb)h(.)h
(pseudounit)d(pa\))180 1318 y(\(\\pz)i(x)h(f)f(->)h(x)f(<<pz#pb>>)f(\(\\w)h
(->)442 1368 y(w)g(<<pz&pb#pa>>)f(f\)\))-75 1445 y Fh(This)15
b(comp)q(osition)e(op)q(erator)i(is)g(asso)q(ciativ)o(e)g(\(here)h(w)o(e)f
(gloss)-75 1495 y(o)o(v)o(er)h(a)g(subtle)g(p)q(oin)o(t)f(ab)q(out)h
(in\014nite)g(regress)i(in)d(the)i(pro)q(of)s(\))-75 1545 y(and)h(its)h(left)
f(and)h(righ)o(t)f(iden)o(tities)h(are)g(the)g(iden)o(tit)o(y)f(pseu-)-75
1595 y(domonad.)g(This)c(more)g(general)h(theory)g(is)f(not)h(required)g(for)
-75 1645 y(the)21 b(remainder)f(of)g(this)g(pap)q(er)h(but)g(pro)o(vided)f
(substan)o(tial)-75 1694 y(theoretical)14 b(motiv)n(ation)d(along)i(the)h(w)o
(a)o(y)m(.\))-38 1744 y(\(But)20 b(hold)e(on,)i(here!)34 b(I)19
b(ha)o(v)o(e)g(pulled)f(a)h(fast)g(one!)33 b(The)-75 1794 y(t)o(yp)q(e)18
b(de\014nition)g(for)f Fg(Pseudobindfn)f Fh(in)h(Figure)h(1)f(is)h(not)g(a)
-75 1844 y(legitimate)e(Hask)o(ell)h(t)o(yp)q(e)i(declaration;)h(it)d(has)h
(a)g(free)h(t)o(yp)q(e)-75 1894 y(v)n(ariable.)28 b(T)m(rue)18
b(enough,)g(and)g(that)f(is)h(en)o(tirely)f(the)i(p)q(oin)o(t:)-75
1943 y(that)d(is)f(the)i(extra)f(hole,)g(the)g(escap)q(e)h(hatc)o(h)g(that)e
(allo)o(ws)g(an)-75 1993 y(arbitrary)e(monad)f(\(or)i(pseudomonad,)e(in)h
(the)h(more)e(general)-75 2043 y(theory\))g(to)g(b)q(e)g(plugged)f(in.)17
b(One)c(migh)o(t)c(try)j(to)g(\014x)f(the)i(prob-)-75 2093
y(lem)f(b)o(y)i(in)o(tro)q(ducing)g(an)f(extra)i(t)o(yp)q(e)f(v)n(ariable:)
-38 2170 y Fg(type)21 b(Pseudobindfn)f(p)h(q)h(r)f(=)h(...)-75
2247 y Fh(but)16 b(this)h(so)q(on)f(propagates)g(throughout)g(the)h(co)q(de)g
(and)f(b)q(e-)-75 2297 y(comes)10 b(messy)m(.)16 b(Moreo)o(v)o(er,)11
b(in)f(the)h(general)g(theory)f(it)g(requires)-75 2347 y(y)o(et)k(another)h
(t)o(yp)q(e)f(v)n(ariable)f Fg(s)p Fh(:)-38 2424 y Fg(type)21
b(Pseudobindfn)f(p)h(q)h(r)f(=)6 2474 y(\(Pseudomonad)e(q)j(r)f(s\))h(->)f(q)
h(->)f(\(p)h(->)f(r\))g(->)h(r)-75 2551 y Fh(and)14 b(one)h(gets)h(caugh)o(t)
e(in)g(an)h(in\014nite)f(regress.)22 b(This)15 b(regress)-75
2600 y(is)j(part)g(of)g(the)g(fundamen)o(tal)e(structure)k(of)e(the)g
(paradigm.)-75 2650 y(Another)e(idea)f(is)g(to)g(wimp)f(out)h(and)g(not)g(sa)
o(y)g(exactly)h(what)-75 2700 y(that)e(\014rst)h(argumen)o(t)d(is:)1060
-33 y Fg(type)21 b(Pseudobindfn)e(p)j(q)f(r)h(x)f(=)1496 16
y(x)g(->)h(q)f(->)g(\(p)h(->)f(r\))h(->)f(r)1022 99 y Fh(and)f(hop)q(e)g
(that)g(the)g(Hask)o(ell)f(t)o(yp)q(e)h(inference)h(system)e(will)1022
149 y(b)q(e)h(happ)o(y)e(with)g(that;)j(but)d(it)h(is)f(not.)32
b(The)19 b(b)q(est)h(solution)1022 199 y(is)15 b(existen)o(tial)g(t)o(yp)q(e)
h(v)n(ariables;)f(w)o(e)g(w)o(ould)f(lik)o(e)h(to)g(write)g(the)1022
249 y(\014rst)d(de\014nition)e(sho)o(wn)h(and)f(to)h(ha)o(v)o(e)f
Fg(r)h Fh(treated)h(existen)o(tially)m(.)1022 299 y(I)f(tried)h(this)f(out)g
(in)f(the)i(Chalmers)e(Hask)o(ell)g(implemen)o(tatio)o(n,)1022
348 y(whic)o(h)20 b(supp)q(orts)h(an)e(exp)q(erimen)o(tal)g(v)o(ersion)h(of)f
(existen)o(tial)1022 398 y(t)o(yp)q(e)14 b(v)n(ariables.)j(Unfortunately)m(,)
c(that)g(implemen)o(tation)d(im-)1022 448 y(p)q(oses)h(a)f(restriction)h(to)e
(the)i(e\013ect)g(that)f(existen)o(tial)g(t)o(yp)q(e)g(v)n(ari-)1022
498 y(ables)18 b(m)o(ust)e(not)h(\\escap)q(e";)i(but)f(this)f(application)f
(requires)1022 548 y(that)11 b(they)g(do)f(escap)q(e.)18 b(W)m(e)11
b(recommend)e(that)h(Hask)o(ell)g(imple-)1022 597 y(men)o(tors)g(consider)h
(full)e(supp)q(ort)h(for)g(unrestricted)i(existen)o(tial)1022
647 y(t)o(yp)q(e)k(v)n(ariables.)21 b(Our)16 b(use)g(of)f(a)f(program)g
(simpli\014er)g(for)g(the)1022 697 y(w)o(ork)j(rep)q(orted)i(here)f(circum)o
(v)o(en)o(ts)f(the)h(restrictions)h(of)d(the)1022 747 y(Hask)o(ell)e(t)o(yp)q
(e)g(system.\))1022 863 y Ff(3)48 b(T)l(o)o(w)o(ers)15 b(of)h(Data)f(T)o(yp)q
(es)1022 946 y Fh(An)h(in)o(terpreter)i(uses)f(ob)r(jects)g(of)f(t)o(w)o(o)f
(t)o(yp)q(es:)23 b Fe(terms)15 b Fh(\(input)1022 996 y(expressions\))j(and)d
Fe(values)h Fh(\(results\).)25 b(When)16 b(an)f(in)o(terpreter)1022
1046 y(is)i(extended)g(with)g(a)f(new)g(capabilit)o(y)m(,)f(b)q(oth)h(of)g
(these)i(t)o(yp)q(es)1022 1096 y(ma)o(y)11 b(require)j(mo)q(di\014cation.)i
(F)m(or)c(example,)f(to)i(add)g(n)o(umeric)1022 1145 y(pro)q(cessing)h(to)f
(an)f(in)o(terpreter,)j(the)e(v)n(alue)f(t)o(yp)q(e)i(m)o(ust)d(b)q(e)j(ex-)
1022 1195 y(tended)f(to)e(represen)o(t)j(n)o(um)o(b)q(ers)d(and)h(the)g(term)
f(t)o(yp)q(e)h(m)o(ust)e(b)q(e)1022 1245 y(extended)16 b(to)d(represen)o(t)k
(op)q(erations)d(suc)o(h)g(as)g(addition.)1060 1295 y(A)d(building)f(blo)q(c)
o(k)g(tak)o(es)i(an)f(in)o(terpreter)i(that)e(maps)f(terms)1022
1345 y(of)k(t)o(yp)q(e)g Fg(t)g Fh(to)g(v)n(alues)g(of)f(t)o(yp)q(e)i
Fg(v)f Fh(and)g(pro)q(duces)i(a)d(new)i(in)o(ter-)1022 1394
y(preter)22 b(that)f(maps)e(terms)i(of)f(t)o(yp)q(e)h Fg(t')f
Fh(to)g(v)n(alues)g(of)g(t)o(yp)q(e)1022 1444 y Fg(v')p Fh(.)36
b(It)20 b(do)q(es)h(this)f(through)g(the)g(use)h(of)f(t)o(w)o(o)f(pseudomon-)
1022 1494 y(ads,)j(one)f(of)f(t)o(yp)q(e)h Fg(Pseudomonad)e(t)j(t')e
Fh(and)g(one)h(of)e(t)o(yp)q(e)1022 1544 y Fg(Pseudomonad)h(v)h(v')p
Fh(.)g(The)15 b(same)f(pseudomonads)h(are)g(used)1022 1594
y(to)h(construct)i(a)e(new)h(parser)g(and)f(prin)o(ter.)26
b(A)16 b(parser)h(maps)1022 1644 y(strings)i(in)o(to)e(terms;)j(a)e(prin)o
(ter)h(maps)e(v)n(alues)h(in)o(to)f(strings.)1022 1693 y(The)d(old)e(parser)i
(is)f(extended)h(to)f(pro)q(duce)h(terms)f(of)f(the)i(new)1022
1743 y(t)o(yp)q(e)g Fg(t')p Fh(.)j(The)c(old)f(prin)o(ter)h(is)g(extended)h
(to)e(accept)i(v)n(alues)f(of)1022 1793 y(the)i(new)f(t)o(yp)q(e)h
Fg(v')p Fh(.)1060 1843 y(Comp)q(osing)i(m)o(ultiple)g(building)g(blo)q(c)o
(ks)i(results)i(in)d(com-)1022 1893 y(p)q(osing)h(m)o(ultiple)e
(pseudomonads.)33 b(The)19 b(result)h(is)f(to)g(con-)1022 1942
y(struct)d(t)o(w)o(o)f(to)o(w)o(ers)g(of)f(data)h(t)o(yp)q(es.)21
b(The)15 b(\014nal)f(parser)i(maps)1022 1992 y(strings)g(to)f(the)h(t)o(yp)q
(e)f(at)g(the)h(top)f(of)g(the)h(\\term")e(to)o(w)o(er;)h(the)1022
2042 y(\014nal)c(in)o(terpreter)i(maps)e(these)h(terms)g(to)f(the)h(t)o(yp)q
(e)g(at)f(the)h(top)1022 2092 y(of)j(the)i(\\v)n(alue")d(to)o(w)o(er;)j(and)e
(the)h(\014nal)f(prin)o(ter)i(prin)o(ts)f(these)1022 2142 y(v)n(alues.)i(See)
d(Figure)f(2.)1060 2192 y(So)d(far,)f(this)h(is)g(all)f(fairly)g(straigh)o
(tforw)o(ard.)16 b(The)c(\014nal)e(\014llip)1022 2241 y(is)17
b(that)f(w)o(e)h(wish)g(b)q(oth)g(the)g(\014nal)f(term)g(t)o(yp)q(e)h(and)f
(the)i(\014nal)1022 2291 y(v)n(alue)11 b(t)o(yp)q(e)g(to)g(b)q(e)h(recursiv)o
(e.)18 b(F)m(or)11 b(example,)f(w)o(e)h(w)o(an)o(t)g(a)g(term)1022
2341 y Fg(\(+)22 b Fe(x)g(y)p Fg(\))16 b Fh(to)h(b)q(e)g(able)f(to)h(con)o
(tain)f Fe(any)h Fh(t)o(w)o(o)g(terms)f Fe(x)h Fh(and)f Fe(y)p
Fh(,)1022 2391 y(and)k(these)h(terms)f(m)o(ust)f(b)q(e)i(of)e(the)i(topmost)d
(t)o(yp)q(e)j(in)e(the)1022 2441 y(to)o(w)o(er.)f(It)c(is)f(no)g(problem)e
(to)j(express)h(this)e(implicitly)l(,)d(but)j(it)1022 2490
y(causes)k(a)e(problem)f(in)h(the)g(Hask)o(ell)g(t)o(yp)q(e)h(c)o(hec)o(k)o
(er.)23 b(W)m(e)15 b(deal)1022 2540 y(with)f(this)g(problem)e(later.)p
eop
%%Page: 4 4
4 3 bop -87 -73 2125 2 v -87 1440 2 1514 v 603 -28 a Fh(term)519
b(v)n(alue)596 22 y(to)o(w)o(er)510 b(to)o(w)o(er)620 105 y
Fd(T)650 90 y Fb(00)1227 105 y Fd(V)1261 90 y Fb(00)640 232
y Fh(.)640 249 y(.)640 265 y(.)1249 232 y(.)1249 249 y(.)1249
265 y(.)101 626 y([)p Fe(This)14 b(\014gur)n(e)h(is)f(inc)n(omplete.)p
Fh(])41 b Fd(T)648 632 y Fa(2)1233 626 y Fd(V)1257 632 y Fa(2)203
987 y Fh([)p Fe(Se)n(e)15 b(the)g(pr)n(o)n(c)n(e)n(e)n(dings.)p
Fh(])41 b Fd(T)648 993 y Fa(1)1233 987 y Fd(V)1257 993 y Fa(1)-75
1349 y Fg(String)567 b Fd(T)648 1355 y Fa(0)1233 1349 y Fd(V)1257
1355 y Fa(0)1844 1349 y Fg(String)743 1421 y Fh(Figure)14 b(2:)j(T)m(o)o(w)o
(ers)d(of)f(t)o(yp)q(es)p 2035 1440 V -87 1442 2125 2 v -75
1566 a Ff(4)48 b(P)o(ac)o(k)m(ages)-75 1649 y Fh(In)11 b(e\013ect,)i(w)o(e)f
(need)g(to)g(comp)q(ose)e(not)i(just)f(functions)h(but)f(sets)-75
1699 y(of)k(functions.)25 b(Hask)o(ell)15 b(mo)q(dules)g(are)i(not)e
(\014rst-class)i(in)f(the)-75 1749 y(language,)10 b(so)i(w)o(e)f(had)h(to)f
(in)o(v)o(en)o(t)g(some)f(other)i(represen)o(tation)-75 1799
y(for)18 b(sets)h(of)e(functions.)31 b(W)m(e)18 b(use)g(a)g(simple)f(asso)q
(ciation-list)-75 1848 y(represen)o(tation)e(\(a)f(list)f(of)g
Fe(r)n(outines)p Fh(,)g(where)h(if)f(there)i(is)f(more)-75
1898 y(than)j(one)g(routine)h(of)e(the)i(same)e(t)o(yp)q(e,)i(the)g(one)f
(earliest)h(in)-75 1948 y(the)i(list)f(shado)o(ws)g(the)h(others.)35
b(W)m(e)19 b(call)f(this)i(structure)h(a)-75 1998 y Fe(p)n(ackage)p
Fh(.)-38 2048 y(\(W)m(e)11 b(use)g(an)f(asso)q(ciation)g(list)g(rather)h
(than,)g(sa)o(y)m(,)f(an)g(8-tuple)-75 2097 y(for)17 b(the)h(sak)o(e)f(of)g
(mo)q(dularit)o(y;)e(not)i(all)f(building)g(blo)q(c)o(ks)h(are)-75
2147 y(concerned)d(with)e(all)e(eigh)o(t)i(routine)g(t)o(yp)q(es.)19
b(The)12 b(asso)q(ciation-)-75 2197 y(list)e(structure)i(allo)o(ws)d(us)i(to)
f(add)g(new)h(routine)g(t)o(yp)q(es)g(without)-75 2247 y(mo)q(difying)g(all)i
(previously)g(written)i(building)d(blo)q(c)o(ks.\))-38 2297
y(The)h(necessary)i(co)q(de)e(for)f(pac)o(k)n(ages)g(is)h(sho)o(wn)f(in)g
(Figure)g(3.)-75 2347 y(In)i(this)g(\014gure)h Fg(t)f Fh(and)g
Fg(v)f Fh(stand)i(for)f(the)g(\\curren)o(t")h(term)f(and)-75
2396 y(v)n(alue)i(t)o(yp)q(es,)i(that)f(is,)g(the)h(t)o(yp)q(es)g(at)e(the)i
(lev)o(el)e(of)h(the)g(t)o(yp)q(e)-75 2446 y(to)o(w)o(er)h(to)f(whic)o(h)g
(the)h(pac)o(k)n(age)f(corresp)q(onds;)j Fg(t'')d Fh(and)g
Fg(v'')-75 2496 y Fh(stand)i(for)g(the)h(term)e(and)h(v)n(alue)f(t)o(yp)q(es)
i(at)f(the)h(top)f(of)f(the)-75 2546 y(to)o(w)o(er.)g(\(The)12
b(t)o(yp)q(e)g Fg(ve)g Fh(stands)g(for)g(the)g(t)o(yp)q(e)h(of)e(v)n(alues)h
(stored)-75 2596 y(in)20 b(the)i(en)o(vironmen)o(t.\))37 b(Th)o(us)21
b(the)h(in)o(terpreter)h(accepts)f(a)-75 2645 y(term)11 b(at)h(the)h(curren)o
(t)g(lev)o(el)f(of)f(the)h(t)o(yp)q(e)h(to)o(w)o(er)f(but)g(pro)q(duces)-75
2695 y(a)h(v)n(alue)g(at)g(the)h(top)f(of)g(the)h(t)o(yp)q(e)g(to)o(w)o(er.)k
(It)13 b(do)q(es)h(so)g(b)q(ecause)1022 1566 y(it)j(pro)q(duces)i(a)e(v)n
(alue)g(at)g(the)h(curren)o(t)g(lev)o(el)f(and)g(then,)i(one)1022
1616 y(w)o(a)o(y)12 b(or)g(another,)h(applies)f(the)h Fg(unit)e
Fh(op)q(eration)i(for)f(a)g(monad)1022 1666 y(that)h(will)e(pro)r(ject)j(the)
f(t)o(yp)q(e)g(to)f(the)h(top)g(of)f(the)h(to)o(w)o(er.)18
b(\(This)1022 1716 y(monad)8 b(is)i(constructed)i(as)e(a)g(comp)q(osition)e
(of)i(pseudomonads)1022 1765 y(as)k(the)h(building)d(blo)q(c)o(ks)i(are)g
(comp)q(osed.\))1060 1815 y(There)h(are)f(eigh)o(t)g(kinds)f(of)h(routines:)
1022 1898 y Fg(ParseR)168 b Fh(the)15 b(parser)1022 1948 y
Fg(InterpR)146 b Fh(the)15 b(in)o(terpreter)1022 1998 y Fg(ShowvalR)124
b Fh(the)15 b(prin)o(ter)1022 2048 y Fg(ComplainR)102 b Fh(signals)14
b(an)f(error)1022 2097 y Fg(MakenumR)124 b Fh(constructs)16
b(a)e(n)o(um)o(b)q(er)f(v)n(alue)1022 2147 y Fg(MakefunR)124
b Fh(constructs)16 b(a)e(function)f(v)n(alue)1022 2197 y Fg(ApplyR)168
b Fh(applies)14 b(a)g(function)1022 2247 y Fg(NameR)190 b Fh(a)14
b(string)g(that)g(names)f(the)h(in)o(terpreter)1022 2330 y(Not)h(ev)o(ery)g
(pac)o(k)n(age)f(will)f(con)o(tain)i(a)f(routine)h(of)f(ev)o(ery)h(kind.)1022
2380 y(F)m(or)j(example,)g(there)i(is)e(no)g Fg(MakenumR)f
Fh(routine)h(unless)h(the)1022 2430 y Fg(numbers)11 b Fh(building)f(blo)q(c)o
(k)i(has)g(b)q(een)h(included.)18 b(These)13 b(auxil-)1022
2479 y(iary)e(routines)h(pro)o(vide)f(a)g(w)o(a)o(y)f(for)h(one)g(building)f
(blo)q(c)o(k)h(to)g(use)1022 2529 y(facilities)i(pro)o(vided)h(b)o(y)f
(another.)19 b(F)m(or)13 b(example,)f(as)i(w)o(e)g(shall)1022
2579 y(see,)f(the)g Fg(continuations)c Fh(building)i(blo)q(c)o(k)h(uses)h(a)f
Fg(MakefunR)1022 2629 y Fh(routine)k(to)g(construct)h(a)e(function)h
(represen)o(ting)h(a)e(con)o(tin)o(u-)1022 2679 y(ation;)e(of)f(course,)i(it)
f(cannot)h(do)f(this)g(unless)h(the)g Fg(cbv)e Fh(or)i Fg(cbn)p
eop
%%Page: 5 5
5 4 bop -87 -73 1027 2 v -87 2166 2 2240 v -75 4 a Fg(data)21
b(Routine)f(t)i(v)f(t'')h(v'')f(ve)-53 54 y(=)g(ParseR)g(\(String)f(->)i
([\(t'',)e(String\)]\))-53 104 y(|)h(InterpR)g(\(t)g(->)g([\(String,)f(ve\)])
h(->)h(v''\))-53 153 y(|)f(ShowvalR)g(\(v)g(->)g(String\))-53
203 y(|)g(ComplainR)f(\(String)h(->)g(v''\))-53 253 y(|)g(MakenumR)g(\(Int)f
(->)i(v''\))-53 303 y(|)f(MakefunR)g(\(\(v'')f(->)i(v''\))f(->)g(ve\))-53
353 y(|)g(ApplyR)g(\(v'')g(->)g(v'')g(->)h(v''\))-53 402 y(|)f(NameR)g
(String)-75 480 y(data)g(Package)f(t)i(v)f(t'')h(v'')f(ve)-53
530 y(=)g(Package)g([Routine)f(t)h(v)h(t'')f(v'')g(ve])-75
607 y(update)g(\(Package)f(pkg\))h(new)g(=)-31 657 y(Package)f(\(new)h(++)g
(pkg\))-75 734 y(parser)g(\(Package)f(p\))h(=)h(parse')e(p)i(where)-31
784 y(parse')e(\(ParseR)g(f:_\))h(=)h(f)-31 834 y(parse')e(\(_:rest\))g(=)i
(parse')e(rest)-75 911 y(interpr)g(\(Package)g(p\))i(=)f(interp')g(p)g(where)
-31 961 y(interp')f(\(InterpR)g(f:_\))h(=)h(f)-31 1011 y(interp')e
(\(_:rest\))g(=)i(interp')e(rest)-75 1088 y(showvalr)g(\(Package)g(p\))i(=)f
(showval')f(p)i(where)-31 1138 y(showval')e(\(ShowvalR)g(f:_\))h(=)g(f)-31
1187 y(showval')f(\(_:rest\))g(=)h(showval')g(rest)-75 1259
y(complainr)f(\(Package)g(p\))h(=)h(complain')e(p)i(where)-31
1309 y(complain')e(\(ComplainR)f(f:_\))i(=)h(f)-31 1359 y(complain')e
(\(_:rest\))g(=)h(complain')f(rest)-75 1436 y(makenumr)g(\(Package)g(p\))i(=)
f(makenum')f(p)i(where)-31 1486 y(makenum')e(\(MakenumR)g(f:_\))h(=)g(f)-31
1536 y(makenum')f(\(_:rest\))g(=)h(makenum')g(rest)-75 1608
y(makefunr)f(\(Package)g(p\))i(=)f(makefun')f(p)i(where)-31
1658 y(makefun')e(\(MakefunR)g(f:_\))h(=)g(f)-31 1708 y(makefun')f
(\(_:rest\))g(=)h(makefun')g(rest)-75 1780 y(applyr)g(\(Package)f(p\))h(=)h
(apply')e(p)i(where)-31 1830 y(apply')e(\(ApplyR)g(f:_\))h(=)h(f)-31
1879 y(apply')e(\(_:rest\))g(=)i(apply')e(rest)-75 1957 y(namer)h(\(Package)f
(p\))h(=)h(name')f(p)g(where)-31 2006 y(name')f(\(NameR)h(x:_\))g(=)g(x)-31
2056 y(name')f(\(_:rest\))g(=)i(name')f(rest)97 2148 y Fh(Figure)14
b(3:)k(Supp)q(ort)c(co)q(de)h(for)e(pac)o(k)n(ages)p 938 2166
V -87 2168 1027 2 v -75 2292 a(building)e(blo)q(c)o(k)h(has)h(b)q(een)h
(included)f(to)f(pro)o(vide)h(a)f(de\014nition)-75 2342 y(of)h(suc)o(h)i(a)e
(routine.)-38 2392 y(The)20 b Fg(update)e Fh(function)h(adds)g(a)g(set)h(of)e
(new)i(routines)g(to)-75 2442 y(a)i(pac)o(k)n(age,)i(p)q(ossibly)e(shado)o
(wing)f(old)h(ones)h(of)f(the)h(same)-75 2491 y(t)o(yp)q(e.)34
b(The)20 b(v)n(arious)f(access)i(functions)e Fg(parser)p Fh(,)g
Fg(interpr)p Fh(,)-75 2541 y Fg(showvalr)p Fh(,)9 b(etc.,)i(extract)g(a)f
(routine)g(of)f(the)i(appropriate)f(t)o(yp)q(e)-75 2591 y(from)16
b(a)h(pac)o(k)n(age;)i(the)f(result)h(is)e(unde\014ned)i(if)e(the)h(pac)o(k)n
(age)-75 2641 y(con)o(tains)c(no)f(routine)i(of)e(the)h(required)h(t)o(yp)q
(e.)p 1010 -73 V 1010 766 2 840 v 1022 4 a Fg(data)21 b(TermZ)g(=)h(Bogon)
1022 81 y(data)f(ValueZ)g(=)g(Wrong)1022 159 y(interpreter)f(tmt)h(tmv)g(top)
g(=)h(Package)1109 208 y([ParseR)f(parseZ,)f(InterpR)h(interpZ,)1131
258 y(ShowvalR)f(showvalZ,)g(ComplainR)g(complainZ,)1131 308
y(NameR)h(nameZ])1044 358 y(where)1066 408 y(parseZ)f(s)i(=)g([\(unit)e(tmt)h
(Bogon,)g(s\)])1066 457 y(interpZ)f(Bogon)h(_)h(=)1109 507
y(complainr)e(top)i("invalid)e(expression")1066 557 y(complainZ)g(s)h(=)h
(unit)f(tmv)g(Wrong)1066 607 y(showvalZ)f(Wrong)h(=)g("<wrong>")1066
657 y(nameZ)g(=)g("interpreter")1141 748 y Fh(Figure)14 b(4:)k(The)c(base)h
(in)o(terpreter)h(prepac)o(k)n(age)p 2035 766 V 1010 768 1027
2 v 1022 893 a Ff(5)48 b(The)15 b(Base)h(In)o(terpreter)1022
976 y Fh(The)g(base)g(in)o(terpreter,)h(the)f(one)f(on)g(whic)o(h)g(all)f(v)n
(arian)o(ts)h(are)1022 1025 y(built)i(and)g(on)h(whic)o(h)f(the)h(to)o(w)o
(ers)g(of)f(t)o(yp)q(es)h(are)g(erected,)i(is)1022 1075 y(sho)o(wn)14
b(in)g(Figure)f(4.)18 b(It)c(is)g(a)f Fe(nul)r(l)i(interpr)n(eter)p
Fh(.)i(It)c(in)o(terprets)1022 1125 y(a)j(completely)e(b)q(oring)h(language:)
21 b(the)16 b(only)f(term)g(is)h Fg(Bogon)p Fh(.)1022 1175
y(Ev)o(ery)k(attempt)f(to)g(parse)h(a)f(string)h(fails)e(and)h(pro)q(duces)i
(a)1022 1225 y Fg(Bogon)p Fh(|actually)11 b(not)i Fg(Bogon)p
Fh(,)f(but)h Fg(Bogon)g Fh(pro)r(jected)h(to)f(the)1022 1275
y(top)19 b(of)f(the)h(term)f(t)o(yp)q(e)h(to)o(w)o(er.)33 b(An)18
b(attempt)g(to)h(in)o(terpret)1022 1324 y Fg(Bogon)10 b Fh(results)i(in)e(a)g
(complain)o(t.)15 b(Complaining)7 b(pro)q(duces)12 b(the)1022
1374 y(v)n(alue)j Fg(Wrong)p Fh(|actually)e(not)j Fg(Wrong)p
Fh(,)e(but)i Fg(Wrong)e Fh(pro)r(jected)1022 1424 y(to)19 b(the)g(top)f(of)g
(the)i(v)n(alue)e(t)o(yp)q(e)h(to)o(w)o(er.)32 b(The)19 b(v)n(alue)f
Fg(Wrong)1022 1474 y Fh(prin)o(ts)d(as)g(\\)p Fg(<wrong>)p
Fh(".)k(The)c(name)e(of)h(the)i(base)f(in)o(terpreter)1022
1524 y(is)f(\\)p Fg(interpreter)p Fh(".)1060 1573 y(Ho)o(w)22
b(are)g(t)o(yp)q(es)h(pro)r(jected)h(to)e(the)h(top)f(of)f(the)i(to)o(w)o
(er?)1022 1623 y(The)17 b Fg(interpreter)d Fh(function)j(tak)o(es)g(t)o(w)o
(o)f(monads)f(as)h(argu-)1022 1673 y(men)o(ts:)25 b Fg(tmt)17
b Fh(\(the)h(T)m(op)e(Monad)h(for)h(T)m(erms\))e(and)h Fg(tmv)g
Fh(\(the)1022 1723 y(T)m(op)c(Monad)h(for)f(V)m(alues\).)18
b(These)d(monads)e(are)h(constructed)1022 1773 y(as)i(building)e(blo)q(c)o
(ks)i(are)g(comp)q(osed)f(and)h(then)g(passed)h(bac)o(k)1022
1822 y(do)o(wn)10 b(to)g(all)e(lev)o(els)i(as)g(argumen)o(ts.)16
b(The)10 b Fg(unit)f Fh(op)q(erations)h(for)1022 1872 y(thse)15
b(monads)e(are)i(used)g(b)o(y)f Fg(parseZ)f Fh(and)h Fg(complainZ)e
Fh(to)i(lift)1022 1922 y(terms)g(and)g(v)n(alues,)f(resp)q(ectiv)o(ely)m(,)h
(to)g(the)g(top)g(of)g(the)g(to)o(w)o(er.)1060 1972 y(The)20
b Fg(interpreter)d Fh(function)j(tak)o(es)g(a)g(third)g(argumen)o(t,)1022
2022 y(whic)o(h)h(is)g(also)g(passed)h(bac)o(k)f(do)o(wn)g(from)e(the)j(top)f
(of)f(the)1022 2072 y(to)o(w)o(er.)j(This)16 b(is)f Fg(top)p
Fh(,)g(the)h(completed)f(top-lev)o(el)g(in)o(terpreter)1022
2121 y(pac)o(k)n(age.)30 b(Note)18 b(that)g Fg(interpZ)e Fh(do)q(es)j(not)f
(call)f Fg(complainZ)1022 2171 y Fh(directly;)e(it)f(calls)h(the)g(complain)o
(t)d(function)i(of)g(the)h(top-lev)o(el)1022 2221 y(pac)o(k)n(age.)30
b(If)18 b(an)o(y)g(of)f(the)i(building)d(blo)q(c)o(ks)i(should)g(shado)o(w)
1022 2271 y(the)i(complain)o(t)d(function)i(with)f(a)h(new)h(one,)g
Fg(interpZ)d Fh(will)1022 2321 y(use)e(the)g(new)f(one,)f(not)h
Fg(complainZ)p Fh(.)1022 2437 y Ff(6)48 b(Completing)13 b(the)i(In)o
(terpreter)1022 2520 y Fh(The)f Fg(interpreter)e Fh(function)h(sho)o(wn)g(in)
h(Figure)f(4)h(is)f(not)g(re-)1022 2570 y(ally)e(a)g(complete,)h(w)o(orking)e
(in)o(terpreter;)k(it)e(is)f(merely)g(a)h(func-)1022 2619 y(tion)17
b(that)g(needs)h(some)e(argumen)o(ts)g(to)h(pro)q(duce)h(a)e(pac)o(k)n(age)
1022 2669 y(of)d(routines.)18 b(W)m(e)13 b(call)f(suc)o(h)i(a)f(function)f(a)
h Fe(pr)n(ep)n(ackage)p Fh(;)g(giv)o(en)p eop
%%Page: 6 6
6 5 bop -87 -73 1027 2 v -87 766 2 840 v -75 4 a Fg(complete)20
b(prepkg)h(=)g(top)g(where)-31 54 y(top)g(=)g(prepkg)g(idmonad)f(idmonad)h
(top)-75 131 y(type)g(Term)g(=)h(TermZ)456 b(--**)-75 181 y(type)21
b(Value)g(=)g(ValueZ)413 b(--**)-75 231 y(interp_pkg)20 b(=)h(complete)f
(interpreter)107 b(--**)-75 308 y(parse)21 b(=)g(parser)g(interp_pkg)-75
358 y(interp)g(=)g(interpr)f(interp_pkg)-75 408 y(showval)g(=)i(showvalr)e
(interp_pkg)-75 457 y(complain)g(=)i(complainr)e(interp_pkg)-75
507 y(makenum)g(=)i(makenumr)e(interp_pkg)-75 557 y(makefun)g(=)i(makefunr)e
(interp_pkg)-75 607 y(apply)h(=)g(applyr)g(interp_pkg)-75 657
y(name)g(=)h(namer)e(interp_pkg)-57 748 y Fh(Figure)14 b(5:)k(Co)q(de)c(to)g
(complete)f(a)h(constructed)i(in)o(terpreter)p 938 766 V -87
768 1027 2 v -75 893 a(t)o(w)o(o)h(monads)g(and)g(a)h(top-lev)o(el)f(pac)o(k)
n(age)g(it)h(will)e(pro)q(duce)j(a)-75 942 y(new)g(pac)o(k)n(age)e(\(that)i
(ma)o(y)d(b)q(e)i(at)g(an)o(y)g(p)q(oin)o(t)g(in)f(the)i(to)o(w)o(er,)-75
992 y(p)q(ossibly)14 b(at)f(the)i(b)q(ottom)d(or)i(the)h(top\).)-38
1042 y(W)m(e)h(need)h(to)g(feed)f(three)i(appropriate)e(argumen)o(ts)g(to)g
(the)-75 1092 y(prepac)o(k)n(age.)37 b(It)21 b(is)f(also)f(handy)h(to)g(pull)
g(the)g(constructed)-75 1142 y(pac)o(k)n(age)9 b(apart)h(in)o(to)f
(individual)e(functions)j(with)f(the)h(custom-)-75 1192 y(ary)k(names.)j(The)
d(necessary)i(co)q(de)f(is)f(sho)o(wn)g(in)f(Figure)h(5.)-38
1241 y(The)j(function)f Fg(complete)f Fh(is)h(deceptiv)o(ely)h(simple.)24
b(Giv)o(en)-75 1291 y(a)15 b(prepac)o(k)n(age,)g(it)g(simply)e(caps)i(the)h
(to)o(w)o(er)f(and)g(returns)i(the)-75 1341 y(top-lev)o(el)c(pac)o(k)n(age)h
Fg(top)p Fh(.)k(Ho)o(w)c(is)g Fg(top)f Fh(computed?)18 b(By)c(feed-)-75
1391 y(ing)g(three)i(argumen)o(ts)e(to)h(the)g(giv)o(en)g(prepac)o(k)n(age.)
21 b(The)15 b(\014rst)-75 1441 y(t)o(w)o(o)c(argumen)o(ts)g(are)h(simply)d
(the)j(iden)o(tit)o(y)f(monad;)f(whatev)o(er)-75 1490 y(pac)o(k)n(age)h(is)g
(returned)j(b)o(y)d(the)h(prepac)o(k)n(age)g(will)e(already)h(b)q(e)h(at)-75
1540 y(the)17 b(top)f(of)g(the)g(to)o(w)o(er,)h(so)f(the)h(iden)o(tit)o(y)f
(monad)e(su\016ces)k(to)-75 1590 y(lift)e(terms)h(and)g(v)n(alues)h(of)e
(that)i(pac)o(k)n(age)f(to)g(the)h(top.)28 b(The)-75 1640 y(third)15
b(argumen)o(t)e(is)i Fg(top)p Fh(,)e(the)i(top-lev)o(el)f(pac)o(k)n(age.)20
b(It)15 b(should)-75 1690 y(no)o(w)c(b)q(e)h(apparen)o(t)g(that)g(w)o(e)f
(are)h(dep)q(ending)g(critically)f(on)g(the)-75 1739 y(fact)j(that)f(our)h
(implem)o(en)o(tation)d(language,)h(Hask)o(ell,)h(is)g(lazy)m(.)-75
1789 y(Computing)d(the)i(v)n(alue)f(of)g Fg(top)g Fh(requires)i(that)f
Fg(top)f Fh(b)q(e)i(passed)-75 1839 y(as)h(an)g(argumen)o(t.)-38
1889 y(The)j(result)f(of)f(the)i(expression)g Fg(complete)j(interpreter)-75
1939 y Fh(is)13 b(in)g(fact)g(a)g(complete)g(\(n)o(ull\))g(in)o(terpreter)i
(pac)o(k)n(age.)i(The)d(re-)-75 1989 y(maining)9 b(de\014nitions)j(simply)d
(name)i(the)h(individual)e(routines)-75 2038 y(in)j(this)h(pac)o(k)n(age.)-38
2088 y(Finally)m(,)8 b(it)i(is)f(necessary)j(to)e(mak)o(e)e(a)i(w)o(orking)e
(Hask)o(ell)i(main)-75 2138 y(program.)36 b(The)20 b(driv)o(er)h(co)q(de)g
(in)f(Figure)g(6)g(implemen)o(ts)e(a)-75 2188 y(read-ev)n(al-prin)o(t)11
b(lo)q(op)f(with)h(an)g(initial)e(friendly)i(greeting)h(and)-75
2238 y(a)i(prompt)g(b)q(efore)h(eac)o(h)g(in)o(teraction.)20
b(Note)15 b(that)g(the)g Fg(parse)-75 2287 y Fh(function,)g(according)h(to)g
(the)g(usual)f(Hask)o(ell)h(st)o(yle,)g(actually)-75 2337 y(pro)q(duces)24
b(a)f(list)f(of)g(p)q(ossible)h(parses;)28 b Fg(read_eval_print)-75
2387 y Fh(simply)12 b(uses)j(the)f(\014rst)h(parse)g(and)f(discards)g(an)o(y)
g(others.)-38 2437 y(When)j(w)o(e)g(apply)e(our)i(sp)q(ecial-purp)q(ose)g
(program)e(simpli-)-75 2487 y(\014er)20 b(\(more)e(ab)q(out)h(this)g(in)g
(Section)g(9\))g(to)g(all)f(the)h(co)q(de)h(in)-75 2536 y(Figures)14
b(1{5,)f(the)h(result)h(is)f(as)g(sho)o(wn)g(in)f(Figure)h(7.)-38
2586 y(Here)i(is)e(a)f(sample)g(in)o(teraction)h(with)g(this)g(in)o
(terpreter)i(\(all)-75 2636 y(sample)e(in)o(teractions)j(in)e(this)h(pap)q
(er)g(are)g(transcripts)h(of)f(ac-)-75 2686 y(tual)c(console)h(sessions)h
(with)e(running)g(co)q(de)i(using)e(the)h(driv)o(er)p 1010
-73 V 1010 627 2 701 v 1022 4 a Fg(data)21 b(Term)g(=)h(Bogon)1022
81 y(data)f(Value)g(=)h(Wrong)1022 159 y(parse)f(s)h(=)f([)h(\(Bogon,)e(s\))i
(])1022 236 y(interp)f(Bogon)g(_)g(=)h(complain)e("invalid)g(expression")1022
313 y(complain)g(s)i(=)g(Wrong)1022 390 y(showval)f(Wrong)f(=)i("<wrong>")
1022 468 y(name)f(=)h("interpreter")1022 559 y Fh(Figure)15
b(7:)20 b(Simpli\014ed)12 b(co)q(de)k(for)e(the)h(completed)g(base)g(in)o
(ter-)1022 609 y(preter)p 2035 627 V 1010 629 1027 2 v 1022
748 a(of)f(Figure)g(6\):)1022 825 y Fg(Welcome)21 b(to)g(the)g(interpreter!)
1022 875 y(>)h(3)1022 925 y(<wrong>)1022 975 y(>)g(\(2+3\))1022
1024 y(<wrong>)1022 1074 y(>)g(\\x.x)1022 1124 y(<wrong>)1022
1174 y(>)g(Krazy)f(Kat)1022 1224 y(<wrong>)1022 1301 y Fh(Ev)o(erything)14
b(is)g Fg(<wrong>)p Fh(!)j(Ho)o(w)c(b)q(oring!)1022 1416 y
Ff(7)48 b(The)15 b(Num)o(b)q(ers)g(Buildin)o(g)e(Blo)q(c)o(k)1022
1499 y Fh(The)g Fg(numbers)d Fh(building)g(blo)q(c)o(k)i(extends)h(the)g
(term)e(data)g(t)o(yp)q(e)1022 1549 y(to)k(include)f(n)o(umeric)g(constan)o
(ts)i Fg(Con)21 b Fe(n)15 b Fh(and)f(addition)f(op)q(er-)1022
1599 y(ations)f Fg(Add)21 b Fe(x)h(y)p Fh(,)12 b(where)g Fe(n)g
Fh(is)g(a)f(Hask)o(ell)h(in)o(teger)g(and)f Fe(x)h Fh(and)g
Fe(y)1022 1649 y Fh(are)j(top-lev)o(el)e(terms.)18 b(It)c(also)g(extends)h
(the)f(v)n(alue)g(data)f(t)o(yp)q(e)1022 1698 y(to)h(include)g(n)o(umeric)f
(v)n(alues)h Fg(Num)21 b Fe(n)p Fh(.)d(See)d(Figure)f(8.)1060
1748 y(In)h(the)g(de\014nition)g(of)f(the)i(t)o(yp)q(e)f Fg(TermN)p
Fh(,)f Fg(t'')g Fh(refers)j(to)d(the)1022 1798 y(top-lev)o(el)f(term)f(t)o
(yp)q(e)i(and)e Fg(t)h Fh(refers)h(to)f(the)h(term)e(t)o(yp)q(e)i(at)e(the)
1022 1848 y(next)19 b(lev)o(el)e(do)o(wn)g(from)f(the)j(n)o(um)o(b)q(ers)e
(pac)o(k)n(age.)29 b(Similarly)1022 1898 y(for)14 b Fg(v'')f
Fh(and)h Fg(v)f Fh(in)h(the)g(de\014nition)g(of)f Fg(ValueN)p
Fh(.)1060 1947 y(The)19 b(pseudomonad)f Fg(mTN)h Fh(is)g(used)h(to)f(map)e
(from)h(t)o(yp)q(e)h Fg(t)1022 1997 y Fh(to)c(the)g(t)o(yp)q(e)f
Fg(TermN)21 b(t'')g(t)p Fh(.)f(It)14 b(augmen)o(ts)f(the)i(t)o(yp)q(e)g
Fg(t)f Fh(with)1022 2047 y(new)h(p)q(ossibilities)e Fg(Con)21
b Fe(n)14 b Fh(and)g Fg(Add)21 b Fe(x)h(y)14 b Fh(for)g(terms.)1060
2097 y(The)g(pseudomonad)e Fg(mVN)h Fh(is)g(used)i(to)e(map)f(from)g(t)o(yp)q
(e)i Fg(v)f Fh(to)1022 2147 y(the)18 b(t)o(yp)q(e)g Fg(ValueN)j(v'')g(v)p
Fh(.)28 b(It)17 b(augmen)o(ts)g(the)g(t)o(yp)q(e)h Fg(v)f Fh(with)1022
2197 y(the)h(new)g(p)q(ossibilit)o(y)e Fg(Num)21 b Fe(n)p Fh(.)28
b(\(It)18 b(ma)o(y)d(seem)i(strange)h(that)1022 2246 y Fg(mVNbind)13
b Fh(is)g(not)h(co)q(ded)h(more)e(simply)f(as)1060 2324 y Fg(mVNbind)20
b(m)i(\(Num)f(x\))g(f)h(=)f(unit)g(m)h(\(Num)f(x\))1060 2374
y(mVNbind)f(m)i(\(OtherVN)e(x\))h(f)h(=)f(f)h(x)1022 2451 y
Fh(rather)14 b(than)e(using)h(the)g(in)o(termediate)e(name)h
Fg(qxfoo)p Fh(.)k(It)d(is)f(in)1022 2501 y(fact)k(strange)f(and)h(a)e(kluge.)
22 b(The)16 b(form)d(in)i(the)h(\014gure)f(tric)o(ks)1022 2551
y(the)g(program)e(simpli\014er)f(in)o(to)i(applying)e(a)i(certain)h
(transfor-)1022 2600 y(mation)d(at)i(just)g(the)g(righ)o(t)g(time.)i(It's)e
(a)g(hac)o(k.)k(I'm)12 b(sorry)m(.\))1060 2650 y(The)k(function)g
Fg(numbers)p Fh(,)f(unlik)o(e)h Fg(interpreter)p Fh(,)e(is)i
Fe(not)g Fh(a)1022 2700 y(prepac)o(k)n(age;)24 b(it)d(is)f(a)h(building)e
(blo)q(c)o(k.)38 b(A)21 b(building)e(blo)q(c)o(k)p eop
%%Page: 7 7
7 6 bop -87 -73 2125 2 v -87 493 2 567 v -75 7 a Fg(read_eval_print)19
b(s)i(=)h(showval)e(\(interp)h(exp)g([]\))g(where)-31 57 y(\(\(exp,)f(_\))i
(:)f(_\))g(=)h(parse)f(s)-75 134 y(main)g(=)h(appendChan)d(stdout)i
(\("Welcome)f(to)h(the)g(")h(++)f(name)g(++)h("!\\n>)e("\))i(abort)121
184 y(\(readChan)e(stdin)h(abort)g(\(\\)g(contents)f(->)h(process)g(\(lines)f
(contents\)\)\))g(where)165 234 y(process)g([])h(=)h(done)165
284 y(process)e(\(x:xs\))h(=)g(appendChan)f(stdout)g(\(read_eval_print)f(x\))
i(abort)557 334 y(\(appendChan)f(stdout)g("\\n>)h(")h(abort)601
384 y(\(process)e(xs\)\))527 475 y Fh(Figure)14 b(6:)k(Co)q(de)c(to)g(driv)o
(e)g(a)g(constructed)i(in)o(terpreter)p 2035 493 V -87 495
2125 2 v -75 620 a(tak)o(es)i(an)f(old)f(prepac)o(k)n(age)i(and)f(pro)q
(duces)i(a)e(new)h(prepac)o(k-)-75 669 y(age.)g(Th)o(us)d Fg(interpreter)d
Fh(is)h(a)h(suitable)g(\014rst)h(argumen)o(t)e(for)-75 719
y Fg(numbers)p Fh(;)19 b(the)g(result,)h(a)e(prepac)o(k)n(age,)i(is)e(a)h
(suitable)f(argu-)-75 769 y(men)o(t)e(to)g Fg(complete)p Fh(.)24
b(This)17 b(prepac)o(k)n(age)g(accepts)h(the)f(usual)-75 819
y(three)h(argumen)o(ts)d Fg(tmt)p Fh(,)h Fg(tmv)p Fh(,)g(and)g
Fg(top)f Fh(and)h(returns)i(a)e(new)-75 869 y(pac)o(k)n(age.)i(This)13
b(pac)o(k)n(age)h(is)f(pro)q(duced)i(b)o(y)f(up)q(dating)f(the)h(old)-75
918 y(pac)o(k)n(age)g(with)f(new)h(routines|\014v)o(e)h(of)e(them,)g(in)g
(this)h(case.)-38 968 y(And)h(where)g(did)e(this)h(\\old)f(pac)o(k)n(age")h
(come)f(from?)j(Ah,)e(it)-75 1018 y(m)o(ust)f(b)q(e)h(constructed)i(from)c
(the)i(old)f(prepac)o(k)n(age)h(originally)-75 1068 y(giv)o(en)19
b(to)g(the)h(building)d(blo)q(c)o(k.)34 b(The)20 b(old)e(prepac)o(k)n(age)i
(will)-75 1118 y(need)e(three)g(argumen)o(ts.)26 b(It)17 b(needs)h(a)f(monad)
e(that)h(will)g(lift)-75 1167 y(terms)k(of)g(the)i(old)e(pac)o(k)n(age)g(to)g
(the)i(top.)38 b(W)m(ell,)20 b Fg(tmt)g Fh(will)-75 1217 y(lift)e(terms)i
(from)e(the)i Fe(new)f Fh(pac)o(k)n(age)g(to)h(the)g(top;)i(and)d
Fg(mTN)-75 1267 y Fh(will)11 b(lift)h(terms)h(from)e(the)i(old)f(pac)o(k)n
(age)h(to)g(the)g(new)g(pac)o(k)n(age.)-75 1317 y(All)19 b(w)o(e)h(need)h(to)
f(do)g(is)g(comp)q(ose)g Fg(tmt)f Fh(and)h Fg(mTN)f Fh(with)h(the)-75
1367 y(pseudomonad)13 b(comp)q(osition)g(op)q(erator)h Fg(&)p
Fh(.)19 b Fe(V)m(oil\022)-21 b(a!)19 b Fh(Similarly)-75 1417
y(for)f Fg(tmv)g Fh(and)g Fg(mVN)p Fh(.)g(The)g(top-lev)o(el)g(pac)o(k)n(age)
g Fg(top)g Fh(is)h(passed)-75 1466 y(do)o(wn)14 b(unc)o(hanged.)-38
1516 y(All)j(this)h(structure)j(is)c(quite)h(stereot)o(ypical)h(and)f(app)q
(ears)-75 1566 y(more)f(or)h(less)g(unc)o(hanged)g(in)g(ev)o(ery)g(building)f
(blo)q(c)o(k.)29 b(No)o(w)-75 1616 y(let)16 b(us)g(examine)e(the)j
(particulars)e(of)h(the)g Fg(numbers)e Fh(building)-75 1666
y(blo)q(c)o(k.)-38 1715 y(The)d(parser)g(is)e(bulky)g(\(as)i(parsers)g(are)f
(w)o(on)o(t)f(to)h(b)q(e,)h(b)q(ecause)-75 1765 y(they)k(m)o(ust)f
(distinguish)g(bad)g(inputs)h(from)e(go)q(o)q(d\))h(but)h(quite)-75
1815 y(straigh)o(tforw)o(ard.)35 b(There)20 b(are)h(three)f(p)q(ossibilities)
f(parse)i(a)-75 1865 y(constan)o(t)16 b Fe(ddd)h Fh(to)f(pro)q(duce)h(the)f
(term)f Fg(Con)22 b Fe(n)p Fh(,)16 b(parse)g(an)g(ad-)-75 1915
y(dition)11 b(op)q(eration)i Fg(\()p Fe(x)p Fg(+)p Fe(y)p Fg(\))f
Fh(to)g(pro)q(duce)h(the)g(term)f Fg(Add)21 b Fe(x)h(y)p Fh(,)13
b(or)-75 1964 y(parse)k(the)g(w)o(a)o(y)e(the)i(old)f(pac)o(k)n(age)g
(parses.)26 b(In)16 b(the)h(\014rst)g(t)o(w)o(o)-75 2014 y(cases,)12
b(the)f(term)f(is)h(lifted)e(to)i(the)g(top)f(of)g(the)h(term)f(t)o(yp)q(e)h
(to)o(w)o(er)-75 2064 y(b)o(y)j(applying)e Fg(unit)21 b(tmt)p
Fh(.)-38 2114 y(The)h(in)o(terpreter)h Fg(interpN)d Fh(and)i(prin)o(ter)g
Fg(showvalN)d Fh(are)-75 2164 y(prett)o(y)29 b(m)o(uc)o(h)e(what)h(y)o(ou)g
(w)o(ould)f(exp)q(ect)j(after)f(reading)-75 2214 y(W)m(adler's)15
b(pap)q(er)h([16)o(].)22 b(In)o(terpreting)17 b(a)e(constan)o(t)h
Fg(Con)21 b Fe(n)16 b Fh(re-)-75 2263 y(sults)10 b(in)f(an)g(equiv)n(alen)o
(t)f(v)n(alue)h Fg(Num)21 b Fe(n)p Fh(,)10 b(lifted)f(to)g(the)h(top)f(of)g
(the)-75 2313 y(v)n(alue)16 b(t)o(yp)q(e)h(to)o(w)o(er)g(b)o(y)f(applying)f
Fg(unit)21 b(tmv)p Fh(.)26 b(The)17 b(co)q(de)g(for)-75 2363
y(in)o(terpreting)c(an)f Fg(Add)g Fh(op)q(eration)h(is)f(just)h(lik)o(e)f(W)m
(adler's,)f(with)-75 2413 y Fg(interpr)20 b(top)e Fh(in)g(place)g(of)g
Fg(interp)p Fh(,)g Fg(<<tmv>>)f Fh(in)h(place)g(of)-75 2463
y Fg(`bindM`)p Fh(,)10 b(and)h(sligh)o(tly)f(more)h(elab)q(orate)h
(complaining)c(when)-75 2512 y(not)14 b(b)q(oth)g(op)q(erands)h(are)f(n)o(um)
o(b)q(ers.)-38 2562 y(Finally)m(,)g(note)j(that)f(the)h(name)d(of)i(the)h(in)
o(terpreter)g(in)f(the)-75 2612 y(new)23 b(pac)o(k)n(age)g(is)g(constructed)i
(b)o(y)d(prep)q(ending)i(the)g(w)o(ord)-75 2662 y Fg(numbers)12
b Fh(to)i(the)h(name)d(of)i(the)g(old)f(pac)o(k)n(age.)1060
620 y(T)m(o)19 b(incorp)q(orate)h(the)h(n)o(um)o(b)q(ers)e(facilities)g(in)o
(to)g(an)h(in)o(ter-)1022 669 y(preter,)12 b(all)d(w)o(e)h(need)g(to)g(do)g
(is)f(replace)i(the)f(three)h(lines)f(mark)o(ed)1022 719 y(\\)p
Fg(**)p Fh(")j(in)h(Figure)g(5)f(with)h(the)g(follo)o(wing:)1060
802 y Fg(type)21 b(Term)g(=)g(TermN)g(Term)g(TermZ)1060 852
y(type)g(Value)f(=)i(ValueN)f(Value)f(ValueZ)1060 902 y(interp_pkg)f(=)j
(complete)e(\(numbers)g(interpreter\))1022 985 y Fh(When)d(w)o(e)g(then)h
(apply)d(our)i(program)e(simpli\014er)g(to)i(all)e(the)1022
1035 y(co)q(de)e(in)e(Figures)i(1{5)e(plus)h(Figure)g(8,)f(the)i(result)f(is)
g(as)g(sho)o(wn)1022 1084 y(in)i(Figure)g(9.)1060 1134 y(A)g(sample)e(in)o
(teraction)i(with)g(this)g(in)o(terpreter:)1022 1217 y Fg(Welcome)21
b(to)g(the)g(numbers)g(interpreter!)1022 1267 y(>)h(3)1022
1317 y(3)1022 1367 y(>)g(\(2+3\))1022 1417 y(5)1022 1466 y(>)g(\\x.x)1022
1516 y(<wrong>)1022 1566 y(>)g(Krazy)f(Kat)1022 1616 y(<wrong>)1022
1666 y(>)h(\(\(1+2\)+\(3+\(4+5\)\)\))1022 1715 y(15)1022 1798
y Fh(It)14 b(do)q(es)h(indeed)f(pro)q(cess)i(n)o(umerical)c(expressions)k
(and)e(reject)1022 1848 y(ev)o(erything)h(else.)1022 1964 y
Ff(8)48 b(Recursiv)o(e)14 b(T)o(yp)q(es)h(in)g(Hask)o(ell)1022
2048 y Fh(The)20 b Fg(complete)e Fh(function)i(is)f(where)i(the)f(knot)f(is)h
(tied,)g(re-)1022 2097 y(sulting)c(in)f(recursiv)o(e)j(term)d(and)h(v)n(alue)
f(t)o(yp)q(es;)i Fg(top)f Fh(is)g(a)f(\014x-)1022 2147 y(p)q(oin)o(t.)30
b(Unfortunately)m(,)18 b(existing)g(implemen)o(tations)d(of)i(the)1022
2197 y(Hask)o(ell)e(t)o(yp)q(e)g(system)f(c)o(hok)o(e)h(on)g(this)g
(circularit)o(y)m(.)20 b(The)15 b(lan-)1022 2247 y(guage)j(sp)q
(eci\014cation)h(is)f(hazy)m(,)g(so)g(it)g(is)g(hard)g(to)g(determine)1022
2297 y(whether)g(this)e(is)g(a)f(language)g(restriction)i(or)f(an)g
(implemen-)1022 2346 y(tation)d(de\014ciency)m(.)18 b(The)c(n)o(ub)f(of)f
(the)i(matter)e(is)h(that)g(Hask)o(ell)1022 2396 y(allo)o(ws)g(recursiv)o(e)i
(and)f(m)o(utually)e(recursiv)o(e)j(datat)o(yp)q(es,)f(pro-)1022
2446 y(vided)19 b(that)g(\\an)g(algebraic)f(datat)o(yp)q(e)h(in)o(terv)o
(enes")h([2)o(].)33 b(In)1022 2496 y(curren)o(t)18 b(implemen)o(tations)c
(this)i(is)h(apparen)o(tly)f(a)h(static)f(re-)1022 2546 y(quiremen)o(t;)23
b(that)e(is,)h(an)o(y)f(circularit)o(y)f(of)h(de\014nition)f(m)o(ust)1022
2595 y(b)q(e)15 b(textually)f(apparen)o(t)h(rather)h(than)e(deduced)i(b)o(y)e
(the)h(t)o(yp)q(e)1022 2645 y(mec)o(hanism.)k(If)c(the)g(program)f
(simpli\014er)f(is)i(not)g(used,)g(then)1022 2695 y(the)d(t)o(yp)q(e)g(c)o
(hec)o(k)o(er)h(disco)o(v)o(ers)f(only)e(dynamically)f(for)i(the)g(t)o(yp)q
(e)p eop
%%Page: 8 8
8 7 bop -87 -73 2125 2 v -87 2053 2 2127 v -75 7 a Fg(data)21
b(TermN)g(t'')g(t)g(=)h(Con)f(Int)g(|)h(Add)f(t'')g(t'')h(|)f(OtherTN)f(t)-75
79 y(data)h(ValueN)g(v'')g(v)g(=)h(Num)f(Int)g(|)h(OtherVN)e(v)-75
150 y(mTN)h(=)h(Pseudomonad)d(\(\\x)i(->)h(OtherTN)e(x\))i(mTNbind)e(where)
-31 200 y(mTNbind)g(m)i(\(Con)e(x\))i(f)f(=)h(unit)f(m)h(\(Con)f(x\))-31
250 y(mTNbind)f(m)i(\(Add)e(x)i(y\))f(f)h(=)g(unit)f(m)g(\(Add)g(x)h(y\))-31
300 y(mTNbind)e(m)i(\(OtherTN)e(x\))h(f)h(=)f(f)h(x)-75 371
y(mVN)f(=)h(Pseudomonad)d(\(\\x)i(->)h(OtherVN)e(x\))i(mVNbind)e(where)-31
421 y(mVNbind)g(m)i(=)f(qxfoo)g(where)12 471 y(qxfoo)g(\(Num)g(x\))g(f)h(=)f
(unit)g(m)h(\(Num)f(x\))12 521 y(qxfoo)g(\(OtherVN)f(x\))h(f)h(=)g(f)f(x)-75
598 y(numbers)f(oldprepkg)g(tmt)h(tmv)h(top)f(=)g(update)g(oldpkg)12
648 y([ParseR)g(parseN,)f(InterpR)g(interpN,)g(ShowvalR)g(showvalN,)g
(MakenumR)h(makenumN,)e(NameR)i(nameN])-53 698 y(where)-31
748 y(oldpkg)f(=)i(oldprepkg)e(\(tmt)h(&)g(mTN\))g(\(tmv)g(&)h(mVN\))f(top)
-31 797 y(parseN)f(s)i(=)f(\(pcon)g(s)h(++)f(psum)g(s)h(++)f(parser)g(oldpkg)
f(s\))h(where)12 847 y(psum)g(s)h(=)f([\(unit)g(tmt)g(\(Add)g(x)h(y\),)f
(s5\))g(|)h(\('\(':s1\))e(<-)h([dropWhile)f(isSpace)g(s],)819
897 y(\(x,)h(s2\))g(<-)g(parser)g(top)g(s1,)819 947 y(\('+':s3\))f(<-)h
([dropWhile)f(isSpace)g(s2],)819 997 y(\(y,)h(s4\))g(<-)g(parser)g(top)g(s3,)
819 1046 y(\('\)':s5\))f(<-)h([dropWhile)f(isSpace)g(s4]])12
1096 y(pcon)h(\(c:s\))g(|)g(\(c)h(>=)f('0')g(&&)h(c)f(<=)h('9'\))f(=)g(pcon')
g(s)h(\(ord)f(c)g(-)h(ord)f('0'\))g(where)56 1146 y(pcon')g(\(c:s\))f(n)i(|)f
(\(c)h(>=)f('0')g(&&)h(c)f(<=)h('9'\))f(=)g(pcon')g(s)h(\(10*n)e(+)i(\(ord)f
(c)h(-)f(ord)g('0'\)\))56 1196 y(pcon')g(s)g(n)h(=)f([\(unit)g(tmt)g(\(Con)g
(n\),)g(s\)])12 1246 y(pcon)g(_)h(=)f([])-31 1296 y(interpN)f(\(Con)h(x\))g
(_)h(=)f(unit)g(tmv)h(\(Num)f(x\))-31 1345 y(interpN)f(\(Add)h(x)g(y\))h(env)
f(=)h(interpr)e(top)h(x)h(env)f(<<tmv>>)f(\(\\u)h(->)492 1395
y(interpr)f(top)h(y)h(env)f(<<tmv>>)f(\(\\v)h(->)492 1445 y(case)g(\(u,)g
(v\))g(of)535 1495 y(\(Num)g(j,)h(Num)f(k\))g(->)g(unit)g(tmv)h(\(Num)f
(\(j+k\)\))535 1545 y(\(_,)g(_\))h(->)f(complainr)f(top)h(\("should)f(be)i
(numbers:)e(")h(++)862 1594 y(showvalr)f(top)h(\(unit)g(tmv)g(u\))h(++)f(",)g
(")h(++)862 1644 y(showvalr)e(top)h(\(unit)g(tmv)g(v\)\))492
1694 y(\)\))-31 1744 y(interpN)f(\(OtherTN)g(x\))h(env)h(=)f(interpr)g
(oldpkg)f(x)i(env)-31 1794 y(showvalN)e(\(Num)h(x\))g(=)h(show)f(x)-31
1843 y(showvalN)f(\(OtherVN)g(x\))h(=)h(showvalr)e(oldpkg)h(x)-31
1893 y(makenumN)f(x)h(=)h(unit)f(tmv)g(\(Num)g(x\))-31 1943
y(nameN)f(=)i("numbers)e(")i(++)f(namer)g(oldpkg)629 2034 y
Fh(Figure)14 b(8:)k(The)c(n)o(um)o(b)q(ers)g(building)e(blo)q(c)o(k)p
2035 2053 V -87 2055 2125 2 v -75 2179 a Fg(TermN)21 b(t'')g(t)f
Fh(that)g(in)g(actual)g(use)h Fg(t)f Fh(is)g Fg(TermZ)f Fh(and)i(that)-75
2229 y Fg(t'')d Fh(is)g Fg(TermN)j(t'')g(t)p Fh(.)31 b(This)18
b(last)g(disco)o(v)o(ery)h(pro)q(duces)h(an)-75 2279 y(\\o)q(ccurs)e(error")g
(in)f(b)q(oth)g(Chalmers)f(Hask)o(ell)h(and)g(Glasgo)o(w)-75
2329 y(Hask)o(ell,)11 b(despite)h(the)g(fact)g(that)f(an)g(algebraic)g(datat)
o(yp)q(e)h(\(dy-)-75 2378 y(namically\))i(in)o(terv)o(enes.)28
b(The)17 b(simpli\014er)e(reduces)k(the)e(t)o(yp)q(e)-75 2428
y(declarations)23 b(to)f(a)h(form)d(in)j(whic)o(h)f(the)h(circularities)g
(are)-75 2478 y(textually)15 b(manifest)g(\(see)i(Figure)f(9\),)g(th)o(us)h
(rendering)f(them)-75 2528 y(palatable)d(to)h(these)h(Hask)o(ell)e(implemen)o
(tations.)1022 2179 y Ff(9)48 b(The)15 b(Program)g(Simpli\014)o(er)1022
2262 y Fh(The)k(principal)f(activit)o(y)g(of)f(the)i(program)e(simpli\014er)g
(is)h(ju-)1022 2312 y(dicious)i(inlining)f(of)h(function)g(de\014nitions)g
(follo)o(w)o(ed)f(b)o(y)h Fd(\014)r Fh(-)1022 2362 y(reduction)12
b(of)e(b)q(oth)i(lam)o(b)q(da-expressions)e(and)h(Hask)o(ell)f
Fg(case)p Fh(-)1022 2412 y(expressions.)28 b(The)17 b(simpli\014er)e(also)h
(p)q(erforms)g Fd(\013)p Fh(-con)o(v)o(ersion)1022 2461 y(where)c(necessary)h
(and)e(tries)g(to)g(do)g(a)f(smart)g(job)g(of)g(it,)h(renam-)1022
2511 y(ing)g(v)n(ariables)g(b)o(y)h(adding)e(primes;)i(a)f(p)q(ost-pass)h
(heuristically)1022 2561 y(tries)17 b(to)e(minimi)o(ze)f(the)i(n)o(um)o(b)q
(er)f(of)g(primes)g(in)h(the)g(residual)1022 2611 y(co)q(de)f(while)e(main)o
(taining)e(readabilit)o(y)m(.)1060 2661 y(Ideally)20 b(the)h(necessary)i(t)o
(yp)q(es)e(could)g(b)q(e)g(deduced)h(com-)p eop
%%Page: 9 9
9 8 bop -87 -73 1027 2 v -87 1994 2 2068 v -75 7 a Fg(data)21
b(Term)g(=)h(Con)f(Int)g(|)g(Add)h(Term)f(Term)g(|)g(Bogon)-75
85 y(data)g(Value)g(=)g(Num)g(Int)h(|)f(Wrong)-75 162 y(parse)g(s)g(=)h(pcon)
f(s)g(++)h(psum)f(s)g(++)h([)f(\(Bogon,)g(s\))g(])-53 212 y(where)-31
262 y(psum)g(s')g(=)12 311 y([)h(\(Add)f(x)g(y,)h(s5\))12 361
y(|)g(\('\(')f(:)g(s1\))g(<-)h([)f(dropWhile)f(isSpace)h(s')g(],)56
411 y(\(x,)g(s2\))g(<-)g(parse)g(s1,)56 461 y(\('+')g(:)g(s3\))g(<-)h([)f
(dropWhile)f(isSpace)h(s2)g(],)56 511 y(\(y,)g(s4\))g(<-)g(parse)g(s3,)56
560 y(\('\)')g(:)g(s5\))g(<-)h([)f(dropWhile)f(isSpace)h(s4)g(])h(])-31
610 y(pcon)f(\(c)g(:)h(s'\))f(|)g(\(\(c)g(>=)h('0'\))f(&&)g(\(c)h(<=)f
('9'\)\))g(=)12 660 y(pcon')g(s')g(\(ord)g(c)h(-)f(ord)h('0'\))f(where)56
710 y(pcon')g(\(c')g(:)g(s''\))g(n)143 760 y(|)h(\(\(c')e(>=)i('0'\))f(&&)g
(\(c')g(<=)h('9'\)\))f(=)99 810 y(pcon')g(s'')230 859 y(\(\(10)g(*)h(n\))f(+)
h(\(ord)f(c')g(-)h(ord)f('0'\)\))56 909 y(pcon')g(s'')g(n)g(=)h([)f(\(Con)g
(n,)h(s''\))f(])-31 959 y(pcon)g(_)g(=)h([])-75 1036 y(interp)f(\(Con)g(x\))g
(_)g(=)h(Num)f(x)-75 1086 y(interp)g(\(Add)g(x)g(y\))g(env)h(=)-31
1136 y(case)f(\(interp)f(x)h(env,)g(interp)g(y)h(env\))f(of)12
1186 y(\(Num)g(j,)h(Num)f(k\))g(->)g(Num)h(\(j)f(+)h(k\))12
1236 y(\(_,)f(_\))h(->)56 1285 y(complain)e(\("should)g(be)h(numbers:)g(")g
(++)274 1335 y(showval)f(\(interp)g(x)i(env\))f(++)274 1385
y(",)g(")h(++)274 1435 y(showval)e(\(interp)g(y)i(env\)\))-75
1485 y(interp)f(Bogon)f(_)i(=)f(complain)g("invalid)f(expression")-75
1562 y(makenum)g(x)i(=)g(Num)f(x)-75 1630 y(complain)f(s)i(=)f(Wrong)-75
1707 y(showval)f(\(Num)h(x\))h(=)f(show)g(x)-75 1757 y(showval)f(Wrong)h(=)h
("<wrong>")-75 1834 y(name)f(=)h("numbers)e(interpreter")-75
1926 y Fh(Figure)i(9:)35 b(Simpli\014ed)20 b(co)q(de)j(for)f(the)h(complete)f
(n)o(um)o(b)q(ers)-75 1976 y(in)o(terpreter)p 938 1994 V -87
1996 1027 2 v -75 2110 a(pletely)c(automatically)l(,)d(but)j(for)f(this)h(w)o
(ork)f(w)o(e)h(settled)h(for)-75 2160 y(p)q(erforming)12 b(substitution)i
(and)f(simpli\014cation)e(on)j(explicitly)-75 2210 y(pro)o(vided)g(t)o(yp)q
(e)i(declarations)e(for)g Fg(Term)g Fh(and)h Fg(Value)p Fh(.)k(An)14
b(in-)-75 2259 y(teresting)j(wrinkle)f(is)g(that)g(when)g(t)o(w)o(o)g
(algebraic)f(datat)o(yp)q(es)-75 2309 y(are)f(nested:)-38 2382
y Fg(data)21 b(Foo)g(=)h(Bar)f(|)h(Baz)f(|)h(OtherFoo)e(Bletch)-38
2432 y(data)h(Bletch)g(=)g(Quux)g(|)h(Ztesch)-75 2505 y Fh(the)14
b(t)o(yp)q(e)h(simpli\014er)d(\015attens)j(them:)-38 2577 y
Fg(data)21 b(Foo)g(=)h(Bar)f(|)h(Baz)f(|)h(Quux)f(|)g(Ztesch)-75
2650 y Fh(and)10 b(arranges)h(for)f(the)h(co)q(de)g(simpli\014er)d(to)i
(eliminate)f(applica-)-75 2700 y(tions)j(of)g Fg(OtherFoo)e
Fh(and)i(to)h(\015atten)f(nested)i Fg(case)e Fh(constructs)1022
-33 y(as)g(appropriate.)17 b(\(This)11 b(transformation)e(can)j(b)q(e)g
(justi\014ed)f(b)o(y)1022 16 y(an)i(app)q(eal)f(to)g(category)h(theory;)g(w)o
(e)f(omit)f(the)i(details)f(here.\))1060 66 y(A)h(simple)f(heuristic)i(con)o
(trols)g(unrolling)d(of)i(recursiv)o(e)i(pro-)1022 116 y(cedures:)20
b(as)14 b(the)g(b)q(o)q(dy)f(of)g(a)g(pro)q(cedure)i(is)e(inlined,)f(an)o(y)h
(out-)1022 166 y(ermost)i Fg(case)g Fh(statemen)o(t)h(is)f(tagged)h(with)f
(the)h(name)e(of)h(the)1022 216 y(pro)q(cedure;)21 b(and)c(it)g(is)h
(forbidden)f(to)g(inline)g(within)g(a)g Fg(case)1022 265 y
Fh(statemen)o(t)f(for)g(a)g(pro)q(cedure)i(name)c(that)j(matc)o(hes)e(the)i
(tag.)1022 315 y(Th)o(us)f(unrolling)d(con)o(tin)o(ues)j(only)e(if)g(the)i
(gating)e Fg(case)g Fh(state-)1022 365 y(men)o(t)f(can)h(\014rst)h(b)q(e)g
(eliminated)c(b)o(y)j(partial)f(ev)n(aluation.)1060 415 y(The)k(simpli\014er)
e(uses)j(a)e(fast)h(and)g(fairly)e(e\013ectiv)o(e)j(prett)o(y-)1022
465 y(prin)o(ter)d(after)f(the)g(st)o(yle)g(of)g(W)m(aters)g([18)o(,)f(12].)
1022 581 y Ff(10)48 b(The)15 b(Nondetermini)o(sti)o(c)e(Buildin)o(g)g(Blo)q
(c)o(k)1022 664 y Fh(The)e Fg(nondeterministi)o(c)c Fh(building)h(blo)q(c)o
(k)i(extends)h(the)g(term)1022 714 y(data)g(t)o(yp)q(e)g(to)g(include)g(a)g
(c)o(hoice)g(construct)i Fg(Amb)21 b Fe(x)h(y)11 b Fh(\(surface)1022
764 y(syn)o(tax)17 b Fg(\()p Fe(x)p Fg(|)p Fe(y)p Fg(\))p Fh(\),)f(where)i
Fe(x)e Fh(and)h Fe(y)f Fh(are)h(top-lev)o(el)f(terms,)g(and)1022
813 y(a)g(failure)e(op)q(eration)i Fg(Fail)e Fh(\(surface)j(syn)o(tax)f
Fg(fail)p Fh(\).)22 b(It)16 b(also)1022 863 y(alters)k(the)f(v)n(alue)f(data)
h(t)o(yp)q(e)g(to)g(b)q(e)g(a)g(list)f(of)g(v)n(alues.)33 b(See)1022
913 y(Figure)14 b(10.)1060 963 y(Once)26 b(again)e(the)i(implemen)o(tation)c
(of)j(the)h(in)o(terpreter)1022 1013 y(closely)16 b(follo)o(ws)e(the)i(w)o
(ork)g(of)f(W)m(adler)g([16)o(].)23 b(F)m(ailure)15 b(results)1022
1062 y(in)g(a)f(list)h(of)f(no)h(v)n(alue,)f(but)h(lifted)f(to)h(the)g(top)g
(of)f(v)n(alue)g(t)o(yp)q(e)1022 1112 y(to)o(w)o(er.)27 b(Choice)16
b(in)o(v)o(olv)o(es)g(in)o(terpreting)h(eac)o(h)g(of)f(the)h(sub)q(ex-)1022
1162 y(pressions)j(and)e(then)h(app)q(ending)g(the)g(t)o(w)o(o)f(lists)g(of)g
(results.)1022 1212 y(The)j(di\013erence)i(here)f(from)d(W)m(adler's)h(in)o
(terpreter)i(is)f(that)1022 1262 y(the)13 b(v)n(alues)g(from)d(the)k
(recursiv)o(e)g(calls)e(to)g(the)h(in)o(terpreter)i(are)1022
1311 y(not)f(necessarily)h(lists;)f(they)h(are)f(of)g(the)g(top)g(v)n(alue)g
(t)o(yp)q(e)g(and)1022 1361 y(m)o(ust)k(b)q(e)h(lo)o(w)o(ered)f(bac)o(k)h(to)
f(the)h(lev)o(el)f(of)g(lists)h(b)q(efore)g(con-)1022 1411
y(catenation.)26 b(This)16 b(is)h(ac)o(hiev)o(ed)f(b)o(y)h(using)f(the)h
(monad)d(bind)1022 1461 y(op)q(eration)19 b Fg(<<tmv>>)p Fh(.)30
b(The)19 b(bind)f(op)q(eration)g(requires)i(that)1022 1511
y(the)14 b(result)g(then)g(b)q(e)g(lifted)f(bac)o(k)h(to)f(the)h(top)f(v)n
(alue)g(t)o(yp)q(e)h(\(us-)1022 1561 y(ing)g Fg(unit)20 b(tmv)p
Fh(\),)13 b(whic)o(h)h(is)g(exactly)g(what)g(w)o(e)g(w)o(an)o(t)f(an)o(yw)o
(a)o(y)m(.)1060 1610 y(W)m(e)j(c)o(ho)q(ose)i(to)e(prin)o(t)h(the)g(m)o
(ultiple)e(v)n(alues)h(one)h(p)q(er)h(line,)1022 1660 y(follo)o(w)o(ed)d(b)o
(y)h(the)h(line)e(\\)p Fg(That's)21 b(all!)p Fh(".)i(The)17
b(name)e(of)g(the)1022 1710 y(in)o(terpreter)k(is)d(the)h(name)e(from)f(the)j
(old)f(pac)o(k)n(age)g(preceded)1022 1760 y(b)o(y)e(the)g(w)o(ord)g
Fg(nondeterministic)p Fh(.)1060 1810 y(W)m(e)9 b(can)i(mak)o(e)e(a)g
(nondeterministic)h(in)o(terpreter)i(in)e(exactly)1022 1859
y(the)k(same)e(manner)f(as)i(w)o(e)g(made)f(a)g(n)o(um)o(b)q(ers)h(in)o
(terpreter;)h(all)1022 1909 y(w)o(e)g(need)h(do)f(is)g(to)f(replace)i(the)g
(three)g(lines)f(mark)o(ed)e(\\)p Fg(**)p Fh(")h(in)1022 1959
y(Figure)h(5)g(with)f(the)i(follo)o(wing:)1060 2042 y Fg(type)21
b(Term)g(=)g(TermL)g(Term)g(TermZ)1060 2092 y(type)g(Value)f(=)i(ValueL)f
(Value)f(ValueZ)1060 2142 y(interp_pkg)f(=)j(complete)1103
2192 y(\(nondeterministic)d(interpreter\))1022 2275 y Fh(Ho)o(w)o(ev)o(er,)e
(it)f(is)g(ev)o(en)h(more)f(in)o(teresting)h(to)f(mak)o(e)f(an)h(in)o(ter-)
1022 2324 y(preter)g(that)e(is)f(nondeterministic)h Fe(and)g
Fh(has)g(n)o(um)o(b)q(ers:)1060 2407 y Fg(type)21 b(Term)g(=)g(TermL)g(Term)g
(\(TermN)f(Term)h(TermZ\))1060 2457 y(type)g(Value)f(=)1103
2507 y(ValueL)h(Value)g(\(ValueN)f(Value)h(ValueZ\))1060 2557
y(interp_pkg)e(=)j(complete)1103 2607 y(\(nondeterministic)d(\(numbers)h
(interpreter\)\))p eop
%%Page: 10 10
10 9 bop -87 -73 2125 2 v -87 1511 2 1585 v -75 7 a Fg(data)21
b(TermL)g(t'')g(t)g(=)h(Fail)f(|)h(Amb)f(t'')g(t'')g(|)h(OtherTL)e(t)-75
79 y(type)h(ValueL)g(v'')g(v)g(=)h([v])-75 156 y(mTL)f(=)h(Pseudomonad)d
(\(\\x)i(->)h(OtherTL)e(x\))i(mTLbind)e(where)-31 206 y(mTLbind)g(m)i(Fail)e
(f)i(=)g(unit)f(m)g(Fail)-31 256 y(mTLbind)f(m)i(\(Amb)e(x)i(y\))f(f)h(=)g
(unit)f(m)g(\(Amb)g(x)h(y\))-31 306 y(mTLbind)e(m)i(\(OtherTL)e(x\))h(f)h(=)f
(f)h(x)-75 377 y(mVL)f(=)h(Pseudomonad)d(\(\\x)i(->)h([x]\))f(mVLbind)f
(where)-31 427 y(mVLbind)g(m)i(x)f(f)h(=)f(foldr)g(c)h(\(unit)e(m)i([]\))f([)
h(f)f(a)h(|)f(a)h(<-)f(x)h(])g(where)12 477 y(c)g(x)f(y)h(=)g(x)f(<<m>>)g
(\(\\q)g(->)g(y)h(<<m>>)f(\(\\r)g(->)g(unit)g(m)h(\(q)f(++)h(r\)\)\))-75
554 y(nondeterministic)c(oldprepkg)i(tmt)i(tmv)f(top)g(=)h(update)e(oldpkg)12
604 y([ParseR)h(parseL,)f(InterpR)g(interpL,)g(ShowvalR)g(showvalL,)g(NameR)h
(nameL])-53 654 y(where)-31 704 y(oldpkg)f(=)i(oldprepkg)e(\(tmt)h(&)g(mTL\))
g(\(tmv)g(&)h(mVL\))f(top)-31 753 y(parseL)f(s)i(=)f(\(pfail)g(s)g(++)h
(pchoice)e(s)i(++)f(parser)g(oldpkg)f(s\))i(where)12 803 y(pfail)f(s)h(=)f
([\(unit)g(tmt)g(Fail,)g(s1\))g(|)g(\('f':'a':'i':'l':s1)o(\))e(<-)i
([dropWhile)f(isSpace)g(s]])12 853 y(pchoice)h(s)g(=)h([\(unit)e(tmt)h(\(Amb)
g(x)h(y\),)f(s5\))g(|)h(\('\(':s1\))e(<-)h([dropWhile)f(isSpace)g(s],)884
903 y(\(x,)h(s2\))g(<-)h(parser)e(top)h(s1,)884 953 y(\('|':s3\))f(<-)h
([dropWhile)f(isSpace)g(s2],)884 1002 y(\(y,)h(s4\))g(<-)h(parser)e(top)h
(s3,)884 1052 y(\('\)':s5\))f(<-)h([dropWhile)f(isSpace)g(s4]])-31
1102 y(interpL)g(Fail)h(_)g(=)h(unit)f(tmv)g([])-31 1152 y(interpL)f(\(Amb)h
(x)g(y\))h(env)f(=)h(interpr)e(top)h(x)h(env)f(<<tmv>>)f(\(\\u)h(->)492
1202 y(interpr)f(top)h(y)h(env)f(<<tmv>>)f(\(\\v)h(->)492 1252
y(unit)g(tmv)g(\(u)g(++)h(v\))f(\)\))-31 1301 y(interpL)f(\(OtherTL)g(x\))h
(env)h(=)f(interpr)g(oldpkg)f(x)i(env)-31 1351 y(showvalL)e(m)h(=)h(unlines)e
([)i(showvalr)e(oldpkg)h(x)g(|)h(x)f(<-)h(m])f(++)g("That's)g(all!")-31
1401 y(nameL)f(=)i("nondeterministic)c(")k(++)f(namer)g(oldpkg)544
1492 y Fh(Figure)14 b(10:)k(The)c(nondeterministic)f(building)g(blo)q(c)o(k)p
2035 1511 V -87 1513 2125 2 v -75 1637 a(When)k(w)o(e)g(then)g(apply)f(our)h
(program)e(simpli\014er)g(to)i(all)e(the)-75 1687 y(co)q(de)g(in)f(Figures)g
(1{5)g(plus)g(Figures)g(8)g(and)g(10,)f(the)i(result)g(is)-75
1737 y(as)g(sho)o(wn)g(in)f(Figure)h(11.)20 b(\(T)m(o)14 b(sa)o(v)o(e)h
(space,)g(w)o(e)g(ha)o(v)o(e)g(c)o(hosen)-75 1786 y(to)g(elide)g(the)h
(parser)h(from)c(this)i(\014gure.)23 b(The)16 b(parsers)h(follo)o(w)-75
1836 y(a)d(v)o(ery)g(predictable)g(pattern)h(an)o(yw)o(a)o(y)m(.\))-38
1886 y(A)f(sample)f(in)o(teraction)h(with)f(this)h(in)o(terpreter:)-75
1953 y Fg(Welcome)20 b(to)i(the)f(nondeterministic)d(numbers)-75
2003 y(interpreter!)-75 2052 y(>)k(\(2+3\))-75 2102 y(5)-75
2152 y(That's)f(all!)-75 2202 y(>)h(\(2|3\))-75 2252 y(2)-75
2301 y(3)-75 2351 y(That's)f(all!)-75 2401 y(>)h(\(\(2+3\)|\(5+7\)\))-75
2451 y(5)-75 2501 y(12)-75 2551 y(That's)f(all!)-75 2600 y(>)h
(\(\(2|3\)|\(5|7\)\))-75 2650 y(2)-75 2700 y(3)1022 1637 y(5)1022
1687 y(7)1022 1737 y(That's)f(all!)1022 1786 y(>)h(\(\(2|3\)+\(5|7\)\))1022
1836 y(7)1022 1886 y(9)1022 1936 y(8)1022 1986 y(10)1022 2035
y(That's)f(all!)1022 2118 y Fh(\(Note)13 b(that)f(the)h(t)o(w)o(o)e(pairs)h
(of)g(v)n(alues)g(in)o(teracted)h(to)f(pro)q(duce)1022 2168
y(four)i(distinct)g(sums.\))1022 2251 y Fg(>)22 b(\(fail|5\))1022
2301 y(5)1022 2351 y(That's)f(all!)1022 2401 y(>)h(fail)1022
2451 y(That's)f(all!)1022 2500 y(>)h(\(\(2|3\)+\(fail|7\)\))1022
2550 y(9)1022 2600 y(10)1022 2650 y(That's)f(all!)p eop
%%Page: 11 11
11 10 bop -87 -73 1027 2 v -87 2090 2 2164 v -75 7 a Fg(data)21
b(Term)g(=)h(Fail)e(|)i(Amb)f(Term)g(Term)143 57 y(|)h(Con)f(Int)g(|)g(Add)h
(Term)f(Term)g(|)g(Bogon)-75 134 y(type)g(Value)g(=)g([)h(Value')e(])-75
184 y(data)h(Value')g(=)g(Num)g(Int)g(|)h(Wrong)-75 262 y(parse)f(s)g(=)h
(...)-75 339 y(interp)f(Fail)g(_)g(=)h([])-75 389 y(interp)f(\(Amb)g(x)g(y\))
g(env)h(=)-31 439 y(interp)e(x)i(env)f(++)g(interp)g(y)g(env)-75
488 y(interp)g(\(Con)g(x\))g(_)g(=)h([)g(Num)f(x)g(])-75 538
y(interp)g(\(Add)g(x)g(y\))g(env)h(=)-31 588 y(foldr)e(\(++\))99
638 y([])99 688 y([)i(foldr)f(\(++\))274 737 y([])274 787 y([)g(case)g(\(a,)g
(a'\))h(of)361 837 y(\(Num)f(j,)g(Num)g(k\))h(->)404 887 y([)g(Num)f(\(j)h(+)
f(k\))h(])361 937 y(\(_,)f(_\))g(->)404 986 y(complain)404
1036 y(\("should)g(be)g(numbers:)f(")426 1086 y(++)426 1136
y(showval)h([)g(a)h(])f(++)426 1186 y(",)h(")f(++)426 1236
y(showval)g([)g(a')h(]\))274 1285 y(|)f(a')h(<-)f(interp)g(y)g(env)g(])99
1335 y(|)h(a)g(<-)f(interp)f(x)i(env)f(])-75 1385 y(interp)g(Bogon)f(_)i(=)f
(complain)g("invalid)f(expression")-75 1462 y(makenum)g(x)i(=)g([)f(Num)g(x)h
(])-75 1534 y(complain)e(s)i(=)f([)h(Wrong)f(])-75 1611 y(showval)f(m)i(=)-31
1661 y(unlines)e([)i(case)e(x)i(of)230 1711 y(Num)f(x')h(->)f(show)g(x')230
1761 y(Wrong)g(->)g("<wrong>")143 1810 y(|)h(x)f(<-)g(m)h(])g(++)-31
1860 y("That's)e(all!")-75 1928 y(name)h(=)h("nondeterminist)o(ic)d(numbers)h
(interpreter")-75 2020 y Fh(Figure)d(11:)25 b(Simpli\014ed)15
b(co)q(de)j(for)f(the)h(complete)f(nondeter-)-75 2069 y(ministic)12
b(n)o(um)o(b)q(ers)i(in)o(terpreter)h(\(parser)g(elided\))p
938 2090 V -87 2092 1027 2 v -75 2216 a Ff(11)47 b(The)16 b(Call-By-V)l(alue)
e(Buildin)o(g)f(Blo)q(c)o(k)-75 2299 y Fh(It)g(is)f(of)g(particular)h(in)o
(terest)h(that)f(what)f(w)o(e)h(usually)f(think)g(of)-75 2349
y(as)j(the)g(v)o(ery)g(soul)g(of)f(an)g(in)o(terpreter,)j(the)e(handling)f
(of)g(v)n(ari-)-75 2399 y(ables)i(and)f(lam)o(b)q(da-binding)e(and)i
(function)h(calls,)f(is)g(in)h(fact)-75 2449 y(just)h(another)h(set)g(of)f
(features)h(that)g(can)f(b)q(e)h(separated)h(out)-75 2499 y(in)o(to)d(a)g
(building)e(blo)q(c)o(k.)25 b(The)17 b Fg(cbv)e Fh(building)g(blo)q(c)o(k)h
(extends)-75 2548 y(the)d(term)e(data)h(t)o(yp)q(e)h(to)f(include)g(v)n
(ariable)f(references)k Fg(Var)21 b Fe(v)p Fh(,)-75 2598 y(lam)o(b)q(da)13
b(expressions)j Fg(Lam)21 b Fe(v)h(x)p Fh(,)15 b(and)g(function)g
(applications)-75 2648 y Fg(App)21 b Fe(x)h(y)p Fh(,)17 b(where)h
Fe(v)e Fh(is)h(a)f(string)g(and)h Fe(x)f Fh(and)h Fe(y)f Fh(are)h(top-lev)o
(el)-75 2698 y(terms.)30 b(It)18 b(also)f(extends)j(the)e(v)n(alue)g(data)f
(t)o(yp)q(e)i(to)f(include)1022 -33 y(functional)13 b(v)n(alues)h
Fg(Fun)21 b Fe(f)p Fh(,)13 b(where)i Fe(f)e Fh(is)h(a)f(function;)g(the)i
(func-)1022 16 y(tion)g(maps)f(v)n(alues)h(at)g(the)g(curren)o(t)i(lev)o(el)e
(of)f(the)i(t)o(yp)q(e)g(to)o(w)o(er)1022 66 y(in)o(to)d(v)n(alues)h(at)g
(the)g(top)g(of)f(the)i(t)o(yp)q(e)f(to)o(w)o(er.)k(See)d(Figure)f(12.)1060
116 y(Once)26 b(again)e(the)i(implemen)o(tation)c(of)j(the)h(in)o(terpreter)
1022 166 y(closely)19 b(follo)o(ws)e(the)i(w)o(ork)g(of)f(W)m(adler)g([16)o
(].)32 b(Ho)o(w)o(ev)o(er,)20 b(w)o(e)1022 216 y(c)o(ho)q(ose)c(to)e(nest)h
(the)h(de\014nition)e(of)g Fg(lookup)f Fh(within)g(the)j(de\014-)1022
265 y(nition)d(of)h(one)g(case)g(of)g Fg(interpCBV)p Fh(.)1060
315 y(Note)g(that)f Fg(makefunCBV)e Fh(accepts)16 b(a)d(function)g
Fg(f)g Fh(and)g(com-)1022 365 y(p)q(oses)i(it)f(with)g Fg(unit)20
b(tmv)p Fh(.)e(This)c(is)g(b)q(ecause)h(a)f(call-b)o(y-v)n(alue)1022
415 y Fg(Fun)k Fh(v)n(alue)g(m)o(ust)g(b)q(e)h(of)f(t)o(yp)q(e)h
Fg(v)j(->)f(v'')d Fh(but)h(a)g Fg(MakefunR)1022 465 y Fh(routine)d(tak)o(es)g
(an)f(argumen)o(t)g(of)g(t)o(yp)q(e)h Fg(v'')21 b(->)g(v'')p
Fh(.)i(There)1022 514 y(is)17 b(a)f(reason)h(for)g(this)f(di\013erence:)26
b(as)17 b(w)o(e)f(will)g(see,)i(the)f(call-)1022 564 y(b)o(y-name)h(building)
f(blo)q(c)o(k)i(uses)h Fg(Fun)e Fh(v)n(alues)h(of)f(a)h(di\013eren)o(t)1022
614 y(t)o(yp)q(e,)26 b(but)d(the)h Fg(MakefunR)d Fh(in)o(terface)i(remains)g
(constan)o(ts.)1022 664 y(This)d(allo)o(ws)f(suc)o(h)i(clien)o(ts)g(of)e(the)
i Fg(MakefunR)d Fh(in)o(terface)j(as)1022 714 y(the)16 b Fg(continuation)d
Fh(building)h(blo)q(c)o(k)i(to)f(b)q(e)h(com)o(bined)e(with)1022
764 y(either)25 b(the)f(call-b)o(y-v)n(alue)e(or)h(the)h(call-b)o(y-name)d
(building)1022 813 y(blo)q(c)o(k.)1060 863 y(W)m(e)9 b(parse)h(the)g(surface)
g(syn)o(tax)g(\\)p Fg(\\)p Fe(v)p Fg(.)p Fe(x)p Fh(")e(for)i(lam)o(b)q(da)d
(expres-)1022 913 y(sions)k(and)g Fg(\()p Fe(f)21 b(x)p Fg(\))11
b Fh(for)f(application)f(of)i(function)f Fe(f)g Fh(to)h(argumen)o(t)1022
963 y Fe(x)p Fh(.)19 b(W)m(e)13 b(prin)o(t)h(functional)f(v)n(alues)g(as)h
(\\)p Fg(<function>)p Fh(".)1060 1013 y(T)m(o)i(add)h(the)h(call-b)o(y-v)n
(alue)e(features)i(in)o(to)f(our)g(nondeter-)1022 1062 y(ministic)12
b(n)o(um)o(b)q(ers)i(in)o(terpreter,)h(w)o(e)f(write)h(this)e(co)q(de:)1060
1145 y Fg(type)21 b(Term)g(=)g(TermCBV)g(Term)1103 1195 y(\(TermL)g(Term)g
(\(TermN)f(Term)h(TermZ\)\))1060 1245 y(type)g(Value)f(=)i(ValueCBV)e(Value)
1103 1295 y(\(ValueL)h(Value)f(\(ValueN)h(Value)f(ValueZ\)\))1060
1345 y(interp_pkg)f(=)j(complete)e(\(cbv)1103 1394 y(\(nondeterministic)f
(\(numbers)h(interpreter\)\)\))1060 1478 y Fh(A)14 b(sample)e(in)o(teraction)
i(with)g(this)g(in)o(terpreter:)1022 1561 y Fg(Welcome)21 b(to)g(the)g
(call-by-value)e(nondeterministic)1022 1610 y(numbers)i(interpreter!)1022
1660 y(>)h(\\x.x)1022 1710 y(<function>)1022 1760 y(>)g(\(\(\\x.\\y.\(x+y\))d
(3\))i(4\))1022 1810 y(7)1022 1859 y(That's)g(all!)1022 1909
y(>)h(\(\(\\f.\\x.\(f)e(\(f)h(\(f)g(x\)\)\))g(\\q.\(q+q\)\))f(3\))1022
1959 y(24)1022 2009 y(That's)h(all!)1022 2092 y Fh(Currying)14
b(and)g(functional)f(argumen)o(ts)g(w)o(ork)g(\014ne.)1022
2175 y Fg(>)22 b(\(\(\\x.\\y.\(x+y\))d(\(2|3\)\))i(\(5|7\)\))1022
2225 y(7)1022 2275 y(9)1022 2324 y(8)1022 2374 y(10)1022 2424
y(That's)g(all!)1022 2507 y Fh(So)14 b(far,)f(so)h(go)q(o)q(d)f
Fd(:)7 b(:)g(:)1022 2590 y Fg(>)22 b(\(\(\\x.x|\\y.\(y+y\)\))c(3\))1022
2640 y(3)1022 2690 y(That's)j(all!)p eop
%%Page: 12 12
12 11 bop -87 47 2125 2 v -87 2578 2 2531 v -75 128 a Fg(data)21
b(TermCBV)f(t'')h(t)h(=)g(Var)f(String)f(|)i(Lambda)f(String)f(t'')h(|)h(App)
f(t'')g(t'')g(|)h(OtherTCBV)e(t)-75 205 y(data)h(ValueCBV)f(v'')h(v)h(=)f
(Fun)h(\(ValueCBV)e(v'')h(v)g(->)h(v''\))f(|)g(OtherVCBV)f(v)-75
277 y(mTCBV)h(=)g(Pseudomonad)f(\(\\x)h(->)g(OtherTCBV)f(x\))i(mTCBVbind)e
(where)-31 327 y(mTCBVbind)g(m)h(\(Var)g(x\))g(f)h(=)g(unit)f(m)g(\(Var)g
(x\))-31 376 y(mTCBVbind)f(m)h(\(Lambda)f(v)i(x\))f(f)h(=)g(unit)f(m)g
(\(Lambda)f(v)i(x\))-31 426 y(mTCBVbind)e(m)h(\(App)g(x)h(y\))f(f)h(=)f(unit)
g(m)h(\(App)f(x)g(y\))-31 476 y(mTCBVbind)f(m)h(\(OtherTCBV)f(x\))h(f)h(=)f
(f)h(x)-75 548 y(mVCBV)f(=)g(Pseudomonad)f(\(\\x)h(->)g(OtherVCBV)f(x\))i
(mVCBVbind)e(where)-31 597 y(mVCBVbind)g(m)h(=)h(qxfoo)e(where)12
647 y(qxfoo)h(\(Fun)g(x\))g(f)h(=)f(unit)g(m)h(\(Fun)f(x\))12
697 y(qxfoo)g(\(OtherVCBV)f(x\))h(f)h(=)f(f)h(x)-75 774 y(cbv)f(oldprepkg)f
(tmt)h(tmv)g(top)h(=)f(update)g(oldpkg)12 824 y([ParseR)g(parseCBV,)e
(InterpR)i(interpCBV,)f(ShowvalR)g(showvalCBV,)34 874 y(MakefunR)g
(makefunCBV,)g(ApplyR)g(applyCBV,)g(NameR)h(nameCBV])f(where)-31
924 y(oldpkg)g(=)i(oldprepkg)e(\(tmt)h(&)g(mTCBV\))g(\(tmv)g(&)g(mVCBV\))g
(top)-31 974 y(parseCBV)f(s)h(=)h(\(pvar)f(s)g(++)h(plambda)e(s)i(++)f(papp)g
(s)g(++)h(parser)e(oldpkg)h(s\))g(where)12 1023 y(pvar)g(\(c:s\))g(|)g(c)h
(`elem`)f("abcdefghijklmno)o(pqrs)o(tuvwx)o(yz")e(=)i(pvar')g(s)h([c])f
(where)56 1073 y(pvar')g(\(c:s\))f(v)i(|)f(c)h(`elem`)f("abcdefghijklmn)o
(opqrs)o(tuvwx)o(yz")e(=)i(pvar')g(s)h(\(v)f(++)g([c]\))56
1123 y(pvar')g(_)g(v)h(=)f([\(unit)g(tmt)g(\(Var)g(v\),)g(s\)])12
1173 y(pvar)g(_)h(=)f([])12 1223 y(plambda)g(s)g(=)h([\(unit)e(tmt)h
(\(Lambda)g(v)g(x\),)h(s4\))f(|)g(\('\\\\':s1\))f(<-)i([dropWhile)d(isSpace)i
(s],)949 1272 y(\(Var)g(v,)h(s2\))f(<-)g(pvar)g(s1,)949 1322
y(\('.':s3\))f(<-)i([dropWhile)e(isSpace)g(s2],)949 1372 y(\(x,)h(s4\))h(<-)f
(parser)g(top)g(s3])12 1422 y(papp)g(s)h(=)f([\(unit)g(tmt)g(\(App)g(x)h
(y\),)f(s5\))g(|)h(\('\(':s1\))e(<-)h([dropWhile)f(isSpace)g(s],)819
1472 y(\(x,)h(\(c:s2\)\))f(<-)h(parser)g(top)g(s1,)819 1522
y(isSpace)f(c,)819 1571 y(s3)h(<-)g([dropWhile)f(isSpace)g(s2],)819
1621 y(\(y,)h(s4\))g(<-)g(parser)g(top)g(s3,)819 1671 y(\('\)':s5\))f(<-)h
([dropWhile)f(isSpace)g(s4]])-31 1721 y(interpCBV)g(\(Var)g(v\))i(env)f(=)h
(lookup)e(v)i(env)f(where)12 1771 y(lookup)g(v)g(\(\(w,z\):_\))f(|)i(\(v)f
(==)h(w\))f(=)h(unit)f(tmv)g(z)12 1820 y(lookup)g(v)g(\(_:e\))g(=)h(lookup)e
(v)i(e)12 1870 y(lookup)f(v)g([])h(=)f(complainr)f(top)h(\("unbound)f
(variable:)g(")i(++)f(v\))-31 1920 y(interpCBV)f(\(Lambda)g(v)h(x\))h(env)f
(=)h(unit)f(tmv)g(\(Fun)g(\(\\z)g(->)g(interpr)g(top)g(x)g
(\(\(v,z\):env\)\)\))-31 1970 y(interpCBV)f(\(App)g(x)i(y\))f(env)h(=)f
(interpr)g(top)g(x)g(env)g(<<tmv>>)g(\(\\u)g(->)535 2020 y(interpr)g(top)g(y)
g(env)g(<<tmv>>)g(\(\\v)g(->)535 2069 y(applyr)g(top)g(u)h(v)f(\)\))-31
2119 y(interpCBV)f(\(OtherTCBV)f(x\))j(env)f(=)g(interpr)g(oldpkg)f(x)i(env)
-31 2169 y(applyCBV)e(\(Fun)h(f\))g(x)h(=)f(f)h(x)-31 2219
y(applyCBV)e(u)h(_)h(=)f(complainr)f(top)i(\("should)e(be)h(function:)f(")i
(++)644 2269 y(showvalr)e(top)h(\(unit)g(tmv)g(u\)\))-31 2319
y(showvalCBV)e(\(Fun)i(x\))h(=)f("<function>")-31 2368 y(showvalCBV)e
(\(OtherVCBV)h(x\))h(=)h(showvalr)e(oldpkg)h(x)-31 2418 y(makefunCBV)e(f)j(=)
f(Fun)h(\(f)f(.)h(unit)f(tmv\))-31 2468 y(nameCBV)f(=)i("call-by-value)c(")k
(++)f(namer)g(oldpkg)582 2559 y Fh(Figure)14 b(12:)k(The)c(call-b)o(y-v)n
(alue)e(building)g(blo)q(c)o(k)p 2035 2578 V -87 2580 2125
2 v eop
%%Page: 13 13
13 12 bop -75 -33 a Fh(That's)14 b(strange)g Fd(:)7 b(:)g(:)19
b Fh(wh)o(y)14 b(didn't)f(it)g(also)g(prin)o(t)h(the)g(v)n(alue)f
Fg(6)p Fh(?)-75 49 y Fg(>)22 b(\(\\x.x|\\y.\(y+y\)\))-75 99
y(<function>)-75 181 y Fh(Ooh,)14 b(w)o(eird!)21 b(T)m(rying)14
b(to)g(c)o(ho)q(ose)h(a)g(function)f(pro)q(duces)i(only)-75
231 y(the)f(\014rst)h(one!)21 b(And)15 b(it)f(didn't)g(ev)o(en)h(prin)o(t)g
(\\)p Fg(That's)20 b(all!)p Fh("!)-75 281 y(\(It)14 b(didn't)f(prin)o(t)h(it)
g(when)g(w)o(e)g(tried)g(\\)p Fg(\\x.x)p Fh(",)e(either.\))-38
330 y(But)18 b(this)f(is)g(en)o(tirely)g(correct.)29 b(W)m(e)16
b(c)o(hose)i(to)f(add)g(in)f(the)-75 380 y(call-b)o(y-v)n(alue)e(building)h
(blo)q(c)o(k)g Fe(after)g Fh(adding)g(in)h(the)g(nonde-)-75
430 y(terministic)c(building)g(blo)q(c)o(k.)18 b(So)13 b(the)h
(nondeterminism)e(go)o(v-)-75 480 y(erns)19 b(n)o(um)o(b)q(er)e(v)n(alues)g
Fg(Num)k Fe(n)d Fh(but)g(it)f(do)q(esn't)h(go)o(v)o(ern)g(func-)-75
530 y(tional)c(v)n(alues)h Fg(Fun)22 b Fe(f)p Fh(.)g(Let's)16
b(lo)q(ok)e(at)h(just)h(the)g(de\014nition)f(of)-75 579 y(the)f
Fg(Value)f Fh(t)o(yp)q(e)i(pro)q(duced)g(b)o(y)e(the)i(program)d
(simpli\014er:)-75 662 y Fg(data)21 b(Value)g(=)g(Fun)g(\(Value)g(->)g
(Value\))165 712 y(|)g(OtherVCBV)f([)i(Value')e(])-75 811 y(data)h(Value')g
(=)g(Num)g(Int)g(|)h(Wrong)-75 894 y Fh(Sure)d(enough,)g(y)o(ou)e(can)h
(represen)o(t)j(a)d(list)f(of)h(n)o(um)o(b)q(ers)f(but)-75
943 y(not)d(a)f(list)h(of)f(functions.)-38 993 y(The)j(moral)e(is)h(that)h
(while)f(y)o(ou)g(can)h(comp)q(ose)f(an)o(y)h(build-)-75 1043
y(ing)e(blo)q(c)o(ks)h(y)o(ou)g(lik)o(e,)e(it)i(matters)g(in)f(what)h(order)g
(y)o(ou)g(do)f(it.)-75 1093 y(This)f(is)h(not)f(to)h(sa)o(y)f(that)h(the)g
(call-b)o(y-v)n(alue)e(nondeterminis-)-75 1143 y(tic)i(n)o(um)o(b)q(ers)f(in)
o(terpreter)i(is)f(\\incorrect")g(in)f(an)o(y)h(sense;)h(it)e(is)-75
1192 y(a)f(p)q(erfectly)h(legitimate,)d(w)o(orking)h(com)o(bination)e(of)j
(the)g(sp)q(ec-)-75 1242 y(i\014ed)j(building)f(blo)q(c)o(ks)h(in)o(to)g(a)g
(w)o(orking)f(in)o(terpreter.)24 b(It)15 b(just)-75 1292 y(ma)o(y)10
b(not)i(b)q(e)h(the)f(in)o(terpreter)i(w)o(e)e(w)o(an)o(t)g(for)g(a)f(giv)o
(en)h(purp)q(ose.)-75 1342 y(P)o(erhaps)18 b(w)o(e)g(w)o(ould)f(prefer)h(the)
g(nondeterministic)f(call-b)o(y-)-75 1392 y(v)n(alue)c(n)o(um)o(b)q(ers)h(in)
o(terpreter:)-38 1474 y Fg(type)21 b(Term)g(=)h(TermL)f(Term)6
1524 y(\(TermCBV)f(Term)h(\(TermN)g(Term)g(TermZ\)\))-38 1574
y(type)g(Value)g(=)h(ValueL)e(Value)6 1623 y(\(ValueCBV)g(Value)h(\(ValueN)f
(Value)h(ValueZ\)\))-38 1673 y(interp_pkg)f(=)i(complete)e(\(nondeterministi)
o(c)6 1723 y(\(cbv)h(\(numbers)f(interpreter\)\)\))-75 1805
y Fh(When)d(w)o(e)g(then)g(apply)f(our)h(program)e(simpli\014er)g(to)i(all)e
(the)-75 1855 y(relev)n(an)o(t)9 b(co)q(de,)i(the)f(result)g(is)f(as)h(sho)o
(wn)f(in)g(Figure)g(13.)16 b(\(Again)-75 1905 y(w)o(e)e(elide)g(the)g
(parser.\))-38 1955 y(A)g(sample)f(in)o(teraction)h(with)f(this)h(in)o
(terpreter:)-75 2037 y Fg(Welcome)20 b(to)i(the)f(nondeterministic)d
(call-by-value)-75 2087 y(numbers)i(interpreter!)-75 2137 y(>)i(\\x.x)-75
2187 y(<function>)-75 2236 y(That's)f(all!)-75 2319 y Fh(Ah,)14
b(that's)f(b)q(etter!)-75 2401 y Fg(>)22 b(\(\(\\x.\\y.\(x+y\))d(3\))i(4\))
-75 2451 y(7)-75 2501 y(That's)g(all!)-75 2551 y(>)h(\(\(\\f.\\x.\(f)d(\(f)j
(\(f)f(x\)\)\))g(\\q.\(q+q\)\))f(3\))-75 2600 y(24)-75 2650
y(That's)h(all!)-75 2700 y(>)h(\(\(\\x.\\y.\(x+y\))d(\(2|3\)\))h(\(5|7\)\))
1022 -33 y(7)1022 16 y(9)1022 66 y(8)1022 116 y(10)1022 166
y(That's)h(all!)1022 246 y Fh(All)13 b(this)h(stu\013)h(w)o(orks)f(as)g(b)q
(efore.)1022 326 y Fg(>)22 b(\(\(\\x.x|\\y.\(y+y\)\))c(3\))1022
376 y(3)1022 426 y(6)1022 476 y(That's)j(all!)1022 525 y(>)h
(\(\\x.x|\\y.\(y+y\)\))1022 575 y(<function>)1022 625 y(<function>)1022
675 y(That's)f(all!)1022 755 y Fh(And)14 b(no)o(w)g(w)o(e)g(can)g(also)f(ha)o
(v)o(e)h(c)o(hoices)h(of)e(functions.)1022 835 y Fg(>)22 b(\(\\x.\(x+x\))e
(\(2|3\)\))1022 885 y(4)1022 935 y(6)1022 985 y(That's)h(all!)1022
1065 y Fh(This)10 b(last)f(exc)o(hange)h(indicates)f(that)h(it)f(is)g(truly)g
(call-b)o(y-v)n(alue:)1022 1115 y(the)18 b(t)o(w)o(o)e(references)k(to)d
Fg(x)g Fh(in)f(the)i(b)q(o)q(dy)f(of)g Fg(\\x.\(x+x\))e Fh(b)q(oth)1022
1165 y(get)g(the)f(same)f(v)n(alue,)g(either)i(b)q(oth)f Fg(2)f
Fh(or)h(b)q(oth)g Fg(3)p Fh(.)1022 1280 y Ff(12)48 b(The)15
b(Call-By-Name)h(Buildi)o(ng)d(Blo)q(c)o(k)1022 1363 y Fh(The)j(call-b)o
(y-name)d(building)g(blo)q(c)o(k)i(is)g(quite)h(similar)c(to)j(the)1022
1413 y(call-b)o(y-v)n(alue)e(building)g(blo)q(c)o(k,)h(with)h(only)f(some)g
(subtle)h(dif-)1022 1463 y(ferences)f(in)d(the)h(use)h(of)d(the)j(monads)d
(\(the)i(\014v)o(e)g(lines)f(di\013ering)1022 1513 y(other)k(than)f(in)g(the)
h(names)e(of)g(v)n(ariables)h(from)e(those)j(in)f(Fig-)1022
1563 y(ure)f(12)e(are)h(mark)o(ed)f Fg(##)p Fh(\).)17 b(But)12
b(this)g(mak)o(es)e(all)h(the)h(di\013erence)1022 1612 y(in)i(the)g(w)o
(orld.)k(See)c(Figure)g(14.)1060 1662 y(W)m(e)26 b(can)g(sp)q(ecify)h(the)g
(nondeterministic)e(call-b)o(y-name)1022 1712 y(n)o(um)o(b)q(ers)14
b(in)o(terpreter:)1060 1792 y Fg(type)21 b(Term)g(=)g(TermL)g(Term)1103
1842 y(\(TermCBN)f(Term)h(\(TermN)g(Term)g(TermZ\)\))1060 1892
y(type)g(Value)f(=)i(ValueL)f(Value)1103 1942 y(\(ValueCBN)f(Value)h
(\(ValueN)f(Value)h(ValueZ\)\))1060 1992 y(interp_pkg)e(=)j(complete)e
(\(nondeterministic)1103 2041 y(\(cbn)h(\(numbers)f(interpreter\)\)\))1022
2122 y Fh(\(W)m(e)14 b(foreb)q(ear)h(to)e(sho)o(w)h(the)h(simpli\014ed)d(co)q
(de;)i(as)g(y)o(ou)f(migh)o(t)1022 2171 y(exp)q(ect,)f(it)d(di\013ers)h(in)f
(exactly)h(\014v)o(e)g(places)g(from)e(the)i(simpli\014ed)1022
2221 y(call-b)o(y-v)n(alue)i(co)q(de)j(in)e(Figure)h(13.\))1060
2271 y(A)g(sample)e(in)o(teraction)i(with)g(this)g(in)o(terpreter:)1022
2351 y Fg(Welcome)21 b(to)g(the)g(nondeterministic)e(call-by-name)1022
2401 y(numbers)i(interpreter!)1022 2451 y(>)h(\\x.x)1022 2501
y(<function>)1022 2551 y(That's)f(all!)1022 2600 y(>)h(\(\(\\x.\\y.\(x+y\))d
(3\))i(4\))1022 2650 y(7)1022 2700 y(That's)g(all!)p eop
%%Page: 14 14
14 13 bop -87 -43 2125 2 v -87 2668 2 2711 v -75 38 a Fg(data)21
b(Term)g(=)h(Fail)e(|)i(Amb)f(Term)g(Term)g(|)h(Var)f(String)f(|)i(Lambda)f
(String)f(Term)143 88 y(|)i(App)f(Term)g(Term)g(|)g(Con)g(Int)h(|)f(Add)g
(Term)g(Term)g(|)h(Bogon)-75 165 y(type)f(Value)g(=)g([)h(Value')e(])-75
215 y(data)h(Value')g(=)g(Fun)g(\(Value')g(->)g(Value\))g(|)g(Num)g(Int)g(|)h
(Wrong)-75 292 y(parse)f(s)g(=)h(...)-75 369 y(interp)f(Fail)g(_)g(=)h([])-75
419 y(interp)f(\(Amb)g(x)g(y\))g(env)h(=)f(interp)g(x)g(env)h(++)f(interp)f
(y)i(env)-75 469 y(interp)f(\(Var)g(v\))g(env)g(=)h(lookup)e(v)i(env)f(where)
-31 519 y(lookup)f(v')i(\(\(w,)e(z\))i(:)f(_\))h(|)f(\(v')h(==)f(w\))g(=)h([)
g(z)f(])-31 569 y(lookup)f(v')i(\(_)f(:)g(e\))h(=)f(lookup)g(v')g(e)-31
618 y(lookup)f(v')i([])f(=)g(complain)g(\("unbound)f(variable:)f(")j(++)f
(v'\))-75 668 y(interp)g(\(Lambda)f(v)h(x\))h(env)f(=)h([)f(Fun)g(\(\\)h(z)f
(->)h(interp)e(x)i(\(\(v,)f(z\))g(:)h(env\)\))f(])-75 718 y(interp)g(\(App)g
(x)g(y\))g(env)h(=)-31 768 y(foldr)e(\(++\))h([])h([)f(foldr)g(\(++\))g([])g
([)h(apply)f(a)g(a')h(|)f(a')h(<-)f(interp)g(y)g(env)g(])h(|)g(a)f(<-)g
(interp)g(x)h(env)f(])-75 818 y(interp)g(\(Con)g(x\))g(_)g(=)h([)g(Num)f(x)g
(])-75 867 y(interp)g(\(Add)g(x)g(y\))g(env)h(=)-31 917 y(foldr)e(\(++\))h
([])99 967 y([)h(case)f(a)g(of)187 1017 y(Fun)g(x')g(->)g([)h(Fun)f(x')h(])
187 1067 y(x')f(->)230 1117 y(foldr)g(\(++\))g([])361 1166
y([)g(case)g(a')h(of)448 1216 y(Fun)f(x'')g(->)h([)f(Fun)h(x'')f(])448
1266 y(x'')g(->)492 1316 y(case)g(\(x',)g(x''\))g(of)535 1366
y(\(Num)g(j,)h(Num)f(k\))g(->)g([)h(Num)f(\(j)h(+)f(k\))h(])535
1415 y(\(_,)f(_\))h(->)579 1465 y(complain)e(\("should)g(be)h(numbers:)g(")g
(++)797 1515 y(showval)f([)i(x')f(])h(++)797 1565 y(",)f(")h(++)797
1615 y(showval)e([)i(x'')f(]\))361 1664 y(|)g(a')h(<-)f(interp)g(y)g(env)h(])
99 1714 y(|)g(a)g(<-)f(interp)f(x)i(env)f(])-75 1764 y(interp)g(Bogon)f(_)i
(=)f(complain)g("invalid)f(expression")-75 1841 y(apply)h(\(Fun)g(f\))g(x)h
(=)f(f)h(x)-75 1891 y(apply)f(u)g(_)h(=)g(complain)e(\("should)g(be)h
(function:)f(")i(++)f(showval)f([)i(u)g(]\))-75 1969 y(makefun)e(f)i(=)g(Fun)
f(\(f)g(.)h(\(\\)f(x)h(->)f([)h(x)f(]\)\))-75 2040 y(makenum)f(x)i(=)g([)f
(Num)g(x)h(])-75 2112 y(complain)e(s)i(=)f([)h(Wrong)f(])-75
2189 y(showval)f(m)i(=)-31 2239 y(unlines)e([)i(case)e(x)i(of)230
2289 y(Fun)f(x')h(->)f("<function>")230 2338 y(Num)g(x')h(->)f(show)g(x')230
2388 y(Wrong)g(->)g("<wrong>")143 2438 y(|)h(x)f(<-)g(m)h(])g(++)-31
2488 y("That's)e(all!")-75 2556 y(name)h(=)h("nondeterminist)o(ic)d
(call-by-value)g(numbers)h(interpreter")-24 2647 y Fh(Figure)14
b(13:)k(Simpli\014ed)12 b(co)q(de)i(for)g(the)g(complete)g(nondeterministic)f
(call-b)o(y-v)n(alue)f(n)o(um)o(b)q(ers)h(in)o(terpreter)j(\(parser)f
(elided\))p 2035 2668 V -87 2670 2125 2 v eop
%%Page: 15 15
15 14 bop -87 -73 2125 2 v -87 1369 2 1443 v -75 7 a Fg(data)21
b(TermCBN)f(t'')h(t)h(=)g(Var)f(String)f(|)i(Lambda)f(String)f(t'')h(|)h(App)
f(t'')g(t'')g(|)h(OtherTCBN)e(t)-75 85 y(data)h(ValueCBN)f(v'')h(v)h(=)f(Fun)
h(\(v'')f(->)g(v''\))g(|)h(OtherVCBN)d(v)698 b(--##)-75 156
y(mTCBN)21 b(=)g(...)65 b(--)21 b(identical)f(to)i(mTCBV)f(except)f(names)h
(have)g("N")g(instead)f(of)i("V")-75 234 y(mVCBN)f(=)g(...)65
b(--)21 b(identical)f(to)i(mVCBV)f(except)f(names)h(have)g("N")g(instead)f
(of)i("V")-75 311 y(cbn)f(oldprepkg)f(tmt)h(tmv)g(top)h(=)f(update)g(oldpkg)
12 361 y([ParseR)g(parseCBN,)e(InterpR)i(interpCBN,)f(ShowvalR)g(showvalCBN,)
34 410 y(MakefunR)g(makefunCBN,)g(ApplyR)g(applyCBN,)g(NameR)h(nameCBN])f
(where)-31 460 y(oldpkg)g(=)i(oldprepkg)e(\(tmt)h(&)g(mTCBN\))g(\(tmv)g(&)g
(mVCBN\))g(top)-31 510 y(parseCBN)f(s)h(=)h(...)43 b(--)21
b(identical)f(to)i(parseCBV)-31 560 y(interpCBN)e(\(Var)g(v\))i(env)f(=)h
(lookup)e(v)i(env)f(where)12 610 y(lookup)g(v)g(\(\(w,z\):_\))f(|)i(\(v)f(==)
h(w\))f(=)h(z)1024 b(--##)12 660 y(lookup)21 b(v)g(\(_:e\))g(=)h(lookup)e(v)i
(e)12 709 y(lookup)f(v)g([])h(=)f(complainr)f(top)h(\("unbound)f(variable:)g
(")i(++)f(v\))-31 759 y(interpCBN)f(\(Lambda)g(v)h(x\))h(env)f(=)h(unit)f
(tmv)g(\(Fun)g(\(\\z)g(->)g(interpr)g(top)g(x)g(\(\(v,z\):env\)\)\))-31
809 y(interpCBN)f(\(App)g(x)i(y\))f(env)h(=)f(interpr)g(top)g(x)g(env)g
(<<tmv>>)g(\(\\u)g(->)535 859 y(applyr)g(top)g(u)h(\(interpr)e(top)h(y)g
(env\)\))501 b(--##)-31 909 y(interpCBN)20 b(\(OtherTCBN)f(x\))j(env)f(=)g
(interpr)g(oldpkg)f(x)i(env)-31 958 y(applyCBN)e(\(Fun)h(f\))g(x)h(=)f(f)h(x)
-31 1008 y(applyCBN)e(u)h(_)h(=)f(complainr)f(top)i(\("should)e(be)h
(function:)f(")i(++)644 1058 y(showvalr)e(top)h(\(unit)g(tmv)g(u\)\))-31
1108 y(showvalCBN)e(\(Fun)i(x\))h(=)f("<function>")-31 1158
y(showvalCBN)e(\(OtherVCBN)h(x\))h(=)h(showvalr)e(oldpkg)h(x)-31
1207 y(makefunCBN)e(f)j(=)f(unit)g(tmv)h(\(Fun)f(f\))1111 b(--##)-31
1257 y(nameCBN)20 b(=)i("call-by-name)d(")i(++)h(namer)e(oldpkg)893
b(--##)-45 1349 y Fh(Figure)14 b(14:)k(The)c(call-b)o(y-name)e(building)g
(blo)q(c)o(k)i(\(some)f(parts)h(iden)o(tical)g(to)f(those)i(in)e(call-b)o
(y-v)n(alue)f(building)h(blo)q(c)o(k)g(elided\))p 2035 1369
V -87 1371 2125 2 v -75 1496 a Fg(>)22 b(\(\(\\f.\\x.\(f)d(\(f)j(\(f)f
(x\)\)\))g(\\q.\(q+q\)\))f(3\))-75 1545 y(24)-75 1595 y(That's)h(all!)-75
1645 y(>)h(\(\(\\x.\\y.\(x+y\))d(\(2|3\)\))h(\(5|7\)\))-75
1695 y(7)-75 1745 y(9)-75 1794 y(8)-75 1844 y(10)-75 1894 y(That's)h(all!)-75
1944 y(>)h(\(\(\\x.x|\\y.\(y+y\))o(\))d(3\))-75 1994 y(3)-75
2043 y(6)-75 2093 y(That's)i(all!)-75 2143 y(>)h(\(\\x.x|\\y.\(y+y\)\))-75
2193 y(<function>)-75 2243 y(<function>)-75 2293 y(That's)f(all!)-75
2372 y Fh(This)f(is)g(all)f(exactly)i(as)f(b)q(efore.)38 b(Ho)o(w)20
b(do)g(w)o(e)g(kno)o(w)g(it)g(is)-75 2422 y(call-b)o(y-name?)-75
2501 y Fg(>)i(\(\\x.\(x+x\))e(\(2|3\)\))-75 2551 y(4)-75 2600
y(5)-75 2650 y(5)-75 2700 y(6)1022 1496 y(That's)h(all!)1022
1579 y Fh(This)i(last)f(exc)o(hange)h(indicates)g(that)f(it)h(is)f(truly)g
(call-b)o(y-)1022 1628 y(name:)c(the)c(t)o(w)o(o)g(references)j(to)d
Fg(x)g Fh(in)f(the)i(b)q(o)q(dy)f(of)g Fg(\\x.\(x+x\))1022
1678 y Fh(eac)o(h)f(p)q(erform)f(the)i(calculation)d Fg(\(2|3\))h
Fh(anew,)g(resulting)h(in)f(a)1022 1728 y(total)h(of)h(four)f(p)q
(ossibilities.)1022 1844 y Ff(13)48 b(The)15 b(Con)o(tin)o(uati)o(on)e
(Buildin)o(g)g(Blo)q(c)o(k)1022 1927 y Fh(The)d Fg(continuation)d
Fh(building)h(blo)q(c)o(k)h(extends)i(the)f(term)e(data)1022
1977 y(t)o(yp)q(e)21 b(to)e(include)h(a)g(construct)h Fg(Catch)g
Fe(v)h(y)p Fh(.)35 b(\(W)m(adler)19 b([16)o(])1022 2027 y(called)e(this)g
(construct)i Fg(Callcc)p Fh(,)d(but)h(this)g(w)o(as)g(an)f(error;)j(it)1022
2077 y(has)10 b(the)g(form)e(of)g(the)j(original)c(Sc)o(heme)i
Fg(CATCH)g Fh(construct)i([14)o(].)1022 2127 y(Ho)o(w)o(ev)o(er,)19
b(his)f(function)g Fg(callccK)e Fh(w)o(as)i(indeed)h(a)e(\\callcc"-)1022
2176 y(t)o(yp)q(e)c(op)q(eration.\))k(The)c Fg(continuation)c
Fh(building)i(blo)q(c)o(k)h(also)1022 2226 y(alters)h(the)g(v)n(alue)f(data)g
(t)o(yp)q(e)h(to)g(b)q(e)g(a)f(Hask)o(ell)g(function)g(that,)1022
2276 y(when)f(giv)o(en)e(a)h Fe(c)n(ontinuation)h Fh(\(a)f(Hask)o(ell)f
(function)h(that)g(maps)1022 2326 y(v)n(alues)k(to)g(v)n(alues\))f(pro)q
(duces)j(a)d(v)n(alue.)18 b(See)d(Figure)f(15.)1060 2376 y(The)g
Fg(continuation)d Fh(building)h(blo)q(c)o(k)h(w)o(as)g(the)i(most)d(di\016-)
1022 2425 y(cult)k(to)g(construct|it)g(to)q(ok)g(a)f Fe(long)h
Fh(time)e(to)i(get)g(the)g(t)o(yp)q(es)1022 2475 y(righ)o(t!)25
b(Ev)o(en)17 b(so,)g(problems)e(lurk.)25 b(W)m(e)16 b(w)o(ould)g(m)o(uc)o(h)f
(prefer)1022 2525 y(that)f(the)h(v)n(alue)e(t)o(yp)q(e)h(b)q(e)1060
2608 y Fg(type)21 b(ValueC)f(v'')h(v)h(=)g(\(\(v)f(->)g(r\))g(->)h(r\))p
eop
%%Page: 16 16
16 15 bop -75 -33 a Fh(where)22 b Fg(r)f Fh(is)g(a)g(free)g(t)o(yp)q(e)h(v)n
(ariable.)38 b(In)21 b(other)h(w)o(ords,)g(w)o(e)-75 16 y(w)o(an)o(t)15
b(the)h(lifted)f(v)n(alue)g(t)o(yp)q(e)h(to)g(b)q(e)g(p)q(olymorphic)e(o)o(v)
o(er)h(v)n(ar-)-75 66 y(ious)j(t)o(yp)q(es)i(of)e(con)o(tin)o(uation)g(that)h
(pro)q(duce)h(v)n(arious)e(t)o(yp)q(es)-75 116 y(of)23 b(result,)j(for)d
(there)h(are)g(con\015icting)f(requiremen)o(ts.)47 b(In)-75
166 y Fg(showvalC)p Fh(,)13 b(w)o(e)h(need)i(to)f(b)q(e)g(able)f(to)h
(extract)h(an)e(underlying)-75 216 y(v)n(alue)h(b)o(y)h(feeding)f(the)i(iden)
o(tit)o(y)e(con)o(tin)o(uation)g(to)g(a)h Fg(ValueC)-75 265
y Fh(v)n(alue;)21 b(here)g(w)o(e)e(need)i Fg(r)f Fh(=)h Fg(v)p
Fh(.)34 b(But)20 b(the)g(implemen)o(tation)-75 315 y(of)15
b Fg(Catch)f Fh(sho)o(wn)h(in)f(Figure)i(15)e(requires)j(that)e(a)g
(\\captured)-75 365 y(con)o(tin)o(uation")21 b(return)j(a)f(v)n(alue)f(at)g
(the)h(top)g(of)f(the)h(t)o(yp)q(e)-75 415 y(to)o(w)o(er;)e(here)f(w)o(e)f
(need)h Fg(r)f Fh(=)i Fg(v'')o Fh(.)33 b(The)19 b(net)g(e\013ect)i(is)e(that)
-75 465 y(w)o(e)d(m)o(ust)f(ha)o(v)o(e)g Fg(v)g Fh(=)g Fg(v'')o
Fh(.)24 b(The)16 b(practical)g(e\013ect)h(is)f(to)f(limit)-75
514 y(the)e Fg(continuation)c Fh(building)i(blo)q(c)o(k)h(to)g(b)q(e)h(the)f
Fe(last)g Fh(\(that)g(is,)-75 564 y Fe(leftmost)p Fh(\))j(one)i(applied.)24
b(\(If)16 b(y)o(ou)f(try)i(to)f(build)f(a)h(nondeter-)-75 614
y(ministic)g(con)o(tin)o(uation)g(in)o(terpreter,)k(for)d(example,)f(Hask)o
(ell)-75 664 y(will)f(rep)q(ort)j(a)e(t)o(yp)q(e)h(error)g(on)f(the)h
(simpli\014ed)e(co)q(de;)j(it)e(sim-)-75 714 y(ply)e(do)q(esn't)i(w)o(ork)f
(out.)21 b(A)15 b(con)o(tin)o(uation)f(nondeterministic)-75
764 y(in)o(terpreter)i(w)o(orks)e(\014ne.\))-38 813 y(W)m(e)c(can)g(sp)q
(ecify)h(the)f(con)o(tin)o(uation)f(nondeterministic)h(call-)-75
863 y(b)o(y-v)n(alue)j(n)o(um)o(b)q(ers)g(in)o(terpreter:)-38
944 y Fg(type)21 b(Term)g(=)h(TermC)f(Term)g(\(TermL)f(Term)6
994 y(\(TermCBV)g(Term)h(\(TermN)g(Term)g(TermZ\)\))-38 1044
y(type)g(Value)g(=)h(ValueC)e(Value)h(\(ValueL)f(Value)6 1094
y(\(ValueCBV)g(Value)h(\(ValueN)f(Value)h(ValueZ\)\))-38 1143
y(interp_pkg)f(=)i(complete)e(\(continuation)6 1193 y(\(nondeterministic)e
(\(cbv)50 1243 y(\(numbers)i(interpreter\)\)\)\))-75 1324 y
Fh(When)10 b(w)o(e)g(apply)f(our)h(program)e(simpli\014er)g(to)i(all)e(the)j
(relev)n(an)o(t)-75 1374 y(co)q(de,)i(the)g(result)h(is)e(as)g(sho)o(wn)h(in)
f(Figure)h(16.)k(\(This)12 b(time)f(w)o(e)-75 1424 y(elide)j(the)g(parser)h
Fe(and)g Fh(the)f(in)o(terpreter)i(case)f(for)f Fg(Add)p Fh(.\))-38
1473 y(Insp)q(ection)21 b(of)f(the)g(in)o(terpreter)i(case)f(for)e
Fg(Catch)g Fh(rev)o(eals)-75 1523 y(the)e(exp)q(ected)i(co)q(de:)24
b Fg(x)16 b Fh(is)h(in)o(terpreted)h(in)e(an)h(en)o(vironmen)o(t)-75
1573 y(in)f(whic)o(h)h(v)n(ariable)f Fg(v)g Fh(is)h(b)q(ound)g(to)g(a)f
(function)h(that,)g(when)-75 1623 y(giv)o(en)f(a)g(v)n(alue)g
Fg(z)g Fh(and)g(a)g(con)o(tin)o(uation)g Fg(cc)p Fh(,)g(pro)q(ceeds)i(to)f
(ig-)-75 1673 y(nore)j Fg(cc)g Fh(and)f(instead)h(feeds)h(to)f
Fg(z)f Fh(the)i(con)o(tin)o(uation)e Fg(q)g Fh(of)-75 1722
y(the)d Fg(Catch)f Fh(expression.)25 b(\(Note)17 b(that)e(the)i(simpli\014er)
d(w)o(asn't)-75 1772 y(smart)f(enough)h(to)g(do)f(an)h Fd(\021)q
Fh(-reduction)h(on)e Fg(\\a)22 b(->)f(q)h(a)p Fh(.\))-38 1822
y(It)f(is)f(also)f(of)h(in)o(terest)h(to)f(examine)f(the)i(\014rst)g(argumen)
o(t)-75 1872 y(to)16 b(eac)o(h)g(o)q(ccurrence)j(of)c Fg(foldr)g
Fh(in)g(the)h(in)o(terpreter)i(case)f(for)-75 1922 y Fg(App)p
Fh(.)43 b(Recall)21 b(that)i(the)g(call)e(to)h Fg(foldr)g Fh(comes)f(from)g
(the)-75 1971 y Fg(nondeterministic)g Fh(building)h(blo)q(c)o(k;)28
b(its)c(purp)q(ose)h(is)f(to)-75 2021 y(app)q(end-reduce)f(\(in)d(monad)f
(terminology)m(,)g Fe(join)p Fh(\))i(a)f(list)g(of)-75 2071
y(lists.)35 b(No)o(w)19 b(that)g(w)o(e)h(ha)o(v)o(e)f(added)h(in)f(the)h
Fg(continuation)-75 2121 y Fh(building)12 b(blo)q(c)o(k,)h(w)o(e)h(see)h
(that)f(the)h(\014rst)f(argumen)o(t)f(to)h Fg(foldr)-75 2171
y Fh(is)j(none)h(other)g(than)f(the)i(con)o(tin)o(uation-passing)d(v)o
(ersion)h(of)-75 2221 y Fg(++)p Fh(!)f(And)10 b(its)g(second)i(argumen)o(t)c
(is)i(the)h(con)o(tin)o(uation-passing)-75 2270 y(v)o(ersion)j
Fg(\\c)21 b(->)h(c)f([])14 b Fh(of)f(the)i(empt)o(y)d(list)i
Fg([])-38 2320 y Fh(A)g(sample)f(in)o(teraction)h(with)f(this)h(in)o
(terpreter:)-75 2401 y Fg(Welcome)20 b(to)i(the)f(continuation)e
(nondeterministic)-75 2451 y(call-by-value)g(numbers)h(interpreter!)-75
2501 y(>)i(Catch)e(v)i(\(2+3\))-75 2551 y(5)-75 2600 y(That's)f(all!)-75
2650 y(>)h(Catch)e(v)i(\(2+\(v)f(3\)\))-75 2700 y(3)1022 -33
y(That's)g(all!)1022 16 y(>)h(\(4+Catch)e(v)i(\(2+\(v)e(3\)\)\))1022
66 y(7)1022 116 y(That's)h(all!)1022 166 y(>)h(\(4+Catch)e(v)i(\(2|\(v)e
(3\)\)\))1022 216 y(7)1022 265 y(That's)h(all!)1022 315 y(>)h(\(4|Catch)e(v)i
(\(2|\(v)e(3\)\)\))1022 365 y(4)1022 415 y(3)1022 465 y(That's)h(all!)1022
581 y Ff(14)48 b(The)15 b(Errors)g(Building)d(Blo)q(c)o(k)1022
664 y Fh(The)h Fg(errors)e Fh(building)f(blo)q(c)o(k)i(in)o(tro)q(duces)h(no)
f(new)h(terms;)f(its)1022 714 y(only)f(purp)q(ose)i(is)f(to)f(preserv)o(e)j
(the)e(string)g(argumen)o(t)f(giv)o(en)g(to)1022 764 y(the)g
Fg(complain)c Fh(function)j(rather)g(than)g(discarding)f(it,)h(thereb)o(y)
1022 813 y(pro)q(ducing)15 b(an)f(error)i(message)e(p)q(erhap)q(os)i(more)d
(useful)i(than)1022 863 y(\\)p Fg(<wrong>)p Fh("!)1022 954
y Fg(Welcome)21 b(to)g(the)g(nondeterministic)e(errors)1022
1004 y(call-by-value)g(numbers)i(interpreter!)1022 1054 y(>)h(\(3+x\))1022
1104 y(Error:)f(unbound)f(variable:)g(x)1022 1154 y(That's)h(all!)1022
1204 y(>)h(\(3+\(x|\(5|y\)\)\))1022 1253 y(Error:)f(unbound)f(variable:)g(x)
1022 1303 y(8)1022 1353 y(Error:)h(unbound)f(variable:)g(y)1022
1403 y(That's)h(all!)1022 1453 y(>)h(\(3+\(x|\(|y\)\)\))1022
1502 y(Error:)f(unbound)f(variable:)g(x)1022 1552 y(Error:)h(invalid)f
(expression)1022 1602 y(Error:)h(unbound)f(variable:)g(y)1022
1652 y(That's)h(all!)1022 1702 y(>)h(\(3+\(x|\\y.y\)\))1022
1751 y(Error:)f(unbound)f(variable:)g(x)1022 1801 y(<function>)1022
1851 y(That's)h(all!)1022 1942 y Fh(The)i(last)g(in)o(teraction)f(reminds)g
(us)h(of)e(an)i(unsatisfactory)1022 1992 y(prop)q(ert)o(y)11
b(of)f(the)h(in)o(terpreter)h(framew)o(ork)d(w)o(e)h(ha)o(v)o(e)h(used.)17
b(Be-)1022 2042 y(cause)d(functions)e(are)h(higher)f(in)g(the)h(v)n(alue)f
(to)o(w)o(er)g(than)h(n)o(um-)1022 2092 y(b)q(ers,)f(attempting)e(to)g(add)h
(a)f(function)h(to)f(a)h(n)o(um)o(b)q(er)f(do)q(es)h(not)1022
2142 y(pro)q(duce)22 b(the)e(error)h(message)f(\\)p Fg(should)g(be)h(numbers)
e Fd(:)7 b(:)g(:)e Fh(")1022 2192 y(but)10 b(merely)f(returns)i(the)f
(function)g(\(as)f(dictated)i(b)o(y)e(the)h(pseu-)1022 2241
y(dobind)j(op)q(eration)h Fg(mVCBVbind)e Fh(in)h(Figure)g(12\).)18
b(\(A)c(p)q(ossible)1022 2291 y(solution:)26 b(the)18 b(co)q(de)h(in)f
Fg(interpN)e Fh(for)i Fg(Add)f Fh(should)h(not)g(use)1022 2341
y(pseudobinding)13 b(to)f(extract)h(a)f(n)o(umeric)g(v)n(alue,)g(but)g(a)g
(related)1022 2391 y(op)q(eration)k(that)g(calls)g(an)g(\\error)h(th)o(unk")e
(if)h(it)f(is)h(unable)g(to)1022 2441 y(descend)f(to)e(the)h
Fg(Num)e Fh(represen)o(tation.)20 b(The)13 b(problem)f(is)h(that)1022
2490 y(this)k(op)q(eration)e(m)o(ust)h(b)q(e)g(pro)o(vided)g(b)o(y)g(all)f
(pseudomonads;)1022 2540 y(but)f(it)g(ma)o(y)e(b)q(e)i(w)o(orth)g(it.\))p
eop
%%Page: 17 17
17 16 bop -87 -73 2125 2 v -87 1361 2 1435 v -75 7 a Fg(data)21
b(TermC)g(t'')g(t)g(=)h(Catch)f(String)f(t'')i(|)f(OtherTC)f(t)-75
85 y(type)h(ValueC)g(v'')g(v)g(=)h(\(\(v)f(->)g(v\))h(->)f(v\))-75
162 y(mTC)g(=)h(Pseudomonad)d(\(\\x)i(->)h(OtherTC)e(x\))i(mTCbind)e(where)
-31 212 y(mTCbind)g(m)i(\(Catch)e(v)i(x\))f(f)h(=)f(unit)g(m)h(\(Catch)e(v)i
(x\))-31 262 y(mTCbind)e(m)i(\(OtherTC)e(x\))h(f)h(=)f(f)h(x)-75
333 y(mVC)f(=)h(Pseudomonad)d(\(\\x)i(c)h(->)f(c)h(x\))f(mVCbind)g(where)-31
383 y(mVCbind)f(m)i(x)f(f)h(cc)f(=)h(x)f(\(\\a)g(->)h(f)f(a)h(cc\))-75
454 y(continuation)d(oldprepkg)h(tmt)h(tmv)h(top)f(=)g(update)g(oldpkg)56
504 y([ParseR)f(parseC,)g(InterpR)h(interpC,)f(ShowvalR)g(showvalC,)g(NameR)h
(nameC])f(where)-31 554 y(oldpkg)g(=)i(oldprepkg)e(\(tmt)h(&)g(mTC\))g(qxtmv)
g(top)-31 604 y(qxtmv)f(=)i(tmv)f(&)h(mVC)-31 654 y(parseC)e(s)i(=)f
(\(pcatch)g(s)g(++)h(parser)e(oldpkg)h(s\))g(where)12 704 y(pcatch)g(s)g(=)h
([\(unit)e(tmt)i(\(Catch)e(v)i(x\),)f(s3\))252 753 y(|)g
(\('C':'a':'t':'c':'h')o(:c1:s)o(1\))e(<-)i([dropWhile)f(isSpace)g(s],)295
803 y(isSpace)h(c1,)295 853 y(\(Var)g(v,)h(c2:s2\))e(<-)i(parser)e(top)h(s1,)
295 903 y(isSpace)g(c2,)295 953 y(\(x,)h(s3\))f(<-)g(parser)g(top)g(s2])-31
1002 y(interpC)f(\(Catch)g(v)i(x\))f(env)h(=)12 1052 y(callcc)f(\(\\k)g(->)g
(interp)g(x)g(\(\(v,)g(makefunr)g(top)g(\(\\z)g(->)g(z)h(<<qxtmv>>)e
(k\)\):env\)\))g(where)56 1102 y(callcc)g(h)i(q)f(=)h(h)g(\(\\b)f(d)g(->)h(q)
f(b\))h(q)-31 1152 y(interpC)e(\(OtherTC)g(x\))h(env)h(=)f(interpr)g(oldpkg)f
(x)i(env)-31 1202 y(showvalC)e(x)h(=)h(showvalr)e(oldpkg)h(\(x)g(\(\\q)g(->)h
(q\)\))-31 1252 y(nameC)e(=)i("continuation)d(")j(++)f(namer)g(oldpkg)583
1343 y Fh(Figure)14 b(15:)j(The)d(con)o(tin)o(uation)f(building)g(blo)q(c)o
(k)p 2035 1361 V -87 1363 2125 2 v -75 1487 a Ff(15)47 b(Wh)o(y)16
b(Hask)o(ell?)-75 1570 y Fh(The)21 b(restrictions)i(of)d(the)i(Hask)o(ell)e
(t)o(yp)q(e)i(system)f(certainly)-75 1620 y(caused)e(some)e(problems)g(along)
f(the)i(w)o(a)o(y)m(.)29 b(Sev)o(eral)18 b(times)f(I)-75 1670
y(w)o(as)j(sorely)g(tempted)f(to)h(switc)o(h)g(to)g(Sc)o(heme)f(or)h(Common)
-75 1720 y(Lisp.)j(Had)16 b(I)f(used)i(a)e(dialect)h(of)f(Lisp,)g(it)g(w)o
(ould)g(ha)o(v)o(e)h(b)q(een)-75 1770 y(m)o(uc)o(h)21 b(easier)i(to)f(co)q
(de)h(the)g(program)e(simpli\014er,)h(b)q(ecause)-75 1820 y(Lisp)12
b(already)g(pro)o(vides)g(a)g(parser)h(and)f(prett)o(y-prin)o(ter.)18
b(Then)-75 1869 y(again,)9 b(w)o(orking)h(in)g(Lisp)g(migh)o(t)f(ha)o(v)o(e)h
(a)o(v)o(oided)f(the)i(need)h(for)e(a)-75 1919 y(program)k(simpli\014er)g
(altogether,)h(since)i(the)f(principal)e(prac-)-75 1969 y(tical)g(motiv)n
(atio)o(n)e(for)h(it)h(w)o(as)g(to)h(transform)e(the)h(co)q(de)h(in)o(to)f(a)
-75 2019 y(form)e(acceptable)j(to)f(the)g(Hask)o(ell)g(t)o(yp)q(e-c)o(hec)o
(k)o(er.)-38 2069 y(The)g(truth)h(is)e(that)h(\(a\))g(W)m(adler)f(had)g
(conducted)i(his)f(w)o(ork)-75 2118 y(in)h(Hask)o(ell)g(and)h(it)f(seemed)h
(appropriate)f(to)h(preserv)o(e)h(nota-)-75 2168 y(tional)g(con)o(tin)o(uit)o
(y)m(,)g(and)h(\(b\))h(I)f(w)o(as)g(lo)q(oking)e(for)i(an)g(excuse)-75
2218 y(to)g(gain)f(exp)q(erience)j(with)d(using)h(Hask)o(ell)g(an)o(yw)o(a)o
(y)m(.)28 b(In)18 b(the)-75 2268 y(end,)23 b(I)e(ha)o(v)o(e)g(to)g(sa)o(y)g
(that)g(the)h(t)o(yp)q(e)f(c)o(hec)o(king)h(w)o(as)f(more)-75
2318 y(help)e(than)f(hindrance,)i(esp)q(ecially)f(in)f(the)i(construction)f
(of)-75 2368 y(the)c Fg(continuations)d Fh(building)h(blo)q(c)o(k.)20
b(I)15 b(had)f(the)i(same)d(ex-)-75 2417 y(p)q(erience)j(with)e(Hask)o(ell)g
(that)g(I)g(had)g(t)o(w)o(en)o(t)o(y)h(y)o(ears)f(ago)g(with)-75
2467 y(ECL)20 b([19)o(])f(\(whic)o(h)h(w)o(as,)g(in)g(e\013ect,)i(also)d(a)g
(strongly-t)o(yp)q(ed)-75 2517 y(dialect)e(of)g(Lisp\):)25
b(almost)15 b(alw)o(a)o(ys,)i(once)h(I)f(made)f(the)i(t)o(yp)q(e)-75
2567 y(c)o(hec)o(k)o(er)d(happ)o(y)m(,)e(the)i(program)d(w)o(as)i(correct.)20
b(Moreo)o(v)o(er,)14 b(the)-75 2617 y(c)o(hallenge)e(of)g(trying)g(force)h
(pseudomonads)f(in)o(to)f(the)i(Hask)o(ell)-75 2666 y(t)o(yp)q(e)e(framew)o
(ork)e(taugh)o(t)i(me)e(a)i(lot)f(ab)q(out)g(the)i(strengths)g(and)1022
1487 y(limitations)h(of)j(b)q(oth,)g(in)f(m)o(uc)o(h)g(the)i(same)e(w)o(a)o
(y)g(that)h(trying)1022 1537 y(to)g(hammer)e(a)h(set)i(of)e(lo)o(v)o(ely)g
(but)h(v)n(ague)f(though)o(ts)h(in)o(to)f(the)1022 1587 y(form)f(of)g(a)h
(sonnet)h(yields)f(great)g(insigh)o(t)f(in)o(to)h(the)g(strengths)1022
1637 y(and)k(limitatio)o(ns)e(of)h(the)h(English)f(language)g(\(for)h
(example,)1022 1687 y(the)f(w)o(ealth)e(of)g(synon)o(yms)g(but)g(the)i
(paucit)o(y)e(of)g(rh)o(ymes)g(for)1022 1737 y(\\lo)o(v)o(e"\))h(while)g
(clarifying,)f(not)h(alw)o(a)o(ys)g(comfortably)m(,)e(one's)1022
1786 y(roman)o(tic)e(impulses.)1022 1903 y Ff(16)48 b(Wh)o(y)15
b(Monads?)1022 1986 y Fh(More)25 b(than)g(one)f(reviw)o(er)h(of)f(this)h(w)o
(ork)f(has)h(ask)o(ed)f(me,)1022 2035 y(\\So)e(what's)g(the)h(big)e(deal)h
(ab)q(out)g(monads?)42 b(Isn't)22 b(what)1022 2085 y(y)o(ou)f(ha)o(v)o(e)h
(done)g(simply)d(`go)q(o)q(d)i(functional)g(programmi)o(ng)1022
2135 y(st)o(yle')5 b(?")17 b(I)11 b(feel)g(comp)q(elled)f(to)h(explain)g(m)o
(yself)f(on)h(this)g(p)q(oin)o(t.)1060 2185 y(W)m(ell,)26 b(ma)o(yb)q(e)e
(that's)h(all)e(it)i(is,)i(\\merely")d(go)q(o)q(d)h(st)o(yle)1022
2235 y(\(whic)o(h)12 b(p)q(erhaps)h(I)e(should)g(simply)f(accept)j(as)e(a)g
(complimen)o(t,)1022 2284 y(nev)o(er)20 b(mind)c(that)j(it)f(ma)o(y)e(b)q(e)j
(bac)o(k-handed!\).)32 b(But)19 b(I)f(feel)1022 2334 y(that)c(I)g(nev)o(er)h
(w)o(ould)e(ha)o(v)o(e)g(though)o(t)h(of)f(this)h(st)o(yle)g(of)f(decom-)1022
2384 y(p)q(osing)g(in)o(terpreters)j(without)d(exp)q(osure)i(to)f(the)g
(structuring)1022 2434 y(ideas)g(suggested)h(b)o(y)f(monads)e(and)i(the)g
(use)h(to)e(whic)o(h)h(Philip)1022 2484 y(W)m(adler,)i(Mark)h(Jones,)g(and)f
(others)i(ha)o(v)o(e)e(put)h(them.)25 b(The-)1022 2534 y(ory)19
b(is)f(not)g(automatically)e(w)o(onderful)i(b)o(y)g(virtue)h(of)f(b)q(eing)
1022 2583 y(theory)m(,)12 b(but)h(it)f(justi\014es)g(itself)g(b)o(y)g
(leading)f(one)i(to)f(pragmatic)1022 2633 y(solutions)18 b(that)h(w)o(ould)f
(otherwise)h(ha)o(v)o(e)g(seemed)g(implausi-)1022 2683 y(ble.)27
b(That)16 b(is)h(exactly)f(what)h(happp)q(ened)h(in)e(this)h(instance.)p
eop
%%Page: 18 18
18 17 bop -87 -30 2125 2 v -87 2655 2 2686 v -75 50 a Fg(data)21
b(Term)g(=)h(Catch)e(String)h(Term)g(|)g(Fail)g(|)h(Amb)f(Term)g(Term)g(|)h
(Var)f(String)143 100 y(|)h(Lambda)e(String)h(Term)g(|)g(App)g(Term)g(Term)g
(|)h(Con)f(Int)g(|)h(Add)f(Term)g(Term)g(|)g(Bogon)-75 177
y(type)g(Value)g(=)g(\([)h(Value')e(])i(->)f([)h(Value')e(]\))i(->)f([)h
(Value')e(])-75 227 y(data)h(Value')g(=)g(Fun)g(\(Value')g(->)g(Value\))g(|)g
(Num)g(Int)g(|)h(Wrong)-75 304 y(parse)f(s)g(=)h(...)-75 382
y(interp)f(\(Catch)f(v)i(x\))f(env)g(=)h(\\)f(q)h(->)-31 432
y(interp)e(x)i(\(\(v,)f(makefun)f(\(\\)h(z)h(->)f(\\)h(cc)f(->)h(z)f(\(\\)h
(a)f(->)h(q)f(a\)\)\))g(:)h(env\))f(q)-75 481 y(interp)g(Fail)g(_)g(=)h(\\)f
(c)h(->)f(c)h([])-75 531 y(interp)f(\(Amb)g(x)g(y\))g(env)h(=)f(\\)h(cc)f(->)
h(interp)e(x)i(env)f(\(\\)g(a)h(->)f(interp)g(y)g(env)h(\(\\)f(a')g(->)h(cc)f
(\(a)g(++)h(a'\)\)\))-75 581 y(interp)f(\(Var)g(v\))g(env)g(=)h(lookup)e(v)i
(env)f(where)-31 631 y(lookup)f(v')i(\(\(w,)e(z\))i(:)f(_\))h(|)f(\(v')h(==)f
(w\))g(=)h(\\)g(c)f(->)g(c)h([)g(z)f(])-31 681 y(lookup)f(v')i(\(_)f(:)g(e\))
h(=)f(lookup)g(v')g(e)-31 730 y(lookup)f(v')i([])f(=)g(complain)g(\("unbound)
f(variable:)f(")j(++)f(v'\))-75 780 y(interp)g(\(Lambda)f(v)h(x\))h(env)f(=)h
(\\)f(c)h(->)f(c)h([)f(Fun)h(\(\\)f(z)g(->)h(interp)e(x)i(\(\(v,)f(z\))g(:)h
(env\)\))f(])-75 830 y(interp)g(\(App)g(x)g(y\))g(env)h(=)f(\\)h(cc)f(->)-31
880 y(interp)f(x)i(env)121 930 y(\(\\)g(a)f(->)187 980 y(foldr)f(\(\\)i(x')f
(y')g(->)h(\\)f(cc')h(->)f(x')g(\(\\)h(a')f(->)g(y')h(\(\\)f(a'')g(->)h(cc')f
(\(a')g(++)g(a''\)\)\)\))317 1029 y(\(\\)h(c)f(->)h(c)f([]\))317
1079 y([)h(\\)f(cc')h(->)404 1129 y(interp)f(y)h(env)557 1179
y(\(\\)f(a'')h(->)622 1229 y(foldr)f(\(\\)h(x')f(y')g(->)819
1278 y(\\)g(cc'')g(->)862 1328 y(x')g(\(\\)h(a''')f(->)g(y')h(\(\\)f(a'''')g
(->)g(cc'')g(\(a''')g(++)g(a''''\)\)\)\))753 1378 y(\(\\)h(c)f(->)g(c)h([]\))
753 1428 y([)g(apply)e(a')i(a''')f(|)g(a''')g(<-)h(a'')f(])753
1478 y(cc'\))317 1527 y(|)h(a')f(<-)h(a)f(])317 1577 y(cc\))-75
1627 y(interp)g(\(Con)g(x\))g(_)g(=)h(\\)g(c)f(->)h(c)f([)h(Num)f(x)h(])-75
1677 y(interp)f(\(Add)g(x)g(y\))g(env)h(=)f(\\)h(cc)f(->)h(...)-75
1727 y(interp)f(Bogon)f(_)i(=)f(complain)g("invalid)f(expression")-75
1804 y(apply)h(\(Fun)g(f\))g(x)h(=)f(f)h(x)-75 1854 y(apply)f(u)g(_)h(=)g
(complain)e(\("should)g(be)h(function:)f(")i(++)f(showval)f(\(\\)i(c)f(->)h
(c)f([)h(u)g(]\)\))-75 1931 y(makefun)e(f)i(=)g(Fun)f(\(f)g(.)h(\(\\)f(x)h(c)
f(->)h(c)f(x\))h(.)f(\(\\)h(x)f(->)g([)h(x)g(]\)\))-75 2003
y(makenum)e(x)i(=)g(\\)f(c)h(->)f(c)h([)f(Num)g(x)h(])-75 2074
y(complain)e(s)i(=)f(\\)h(c)f(->)h(c)f([)h(Wrong)f(])-75 2152
y(showval)f(x)i(=)-31 2201 y(unlines)e([)i(case)e(x')i(of)230
2251 y(Fun)f(x'')g(->)h("<function>")230 2301 y(Num)f(x'')g(->)h(show)f(x'')
230 2351 y(Wrong)g(->)g("<wrong>")143 2401 y(|)h(x')f(<-)g(x)h(\(\\)f(q)h(->)
f(q\))h(])f(++)-31 2450 y("That's)f(all!")-75 2518 y(name)h(=)h
("continuation)d(nondeterministic)f(call-by-value)h(numbers)i(interpreter")
-75 2585 y Fh(Figure)14 b(16:)j(Simpli\014ed)12 b(co)q(de)j(for)e(the)h
(complete)g(con)o(tin)o(uation)e(nondeterministic)i(call-b)o(y-v)n(alue)e(n)o
(um)o(b)q(ers)h(in)o(terpreter)j(\(parser)-75 2635 y(and)e(in)o(terpreter)h
(case)g(for)f Fg(Add)f Fh(elided\))p 2035 2655 V -87 2657 2125
2 v eop
%%Page: 19 19
19 18 bop -87 -73 2125 2 v -87 937 2 1011 v -75 4 a Fg(type)21
b(TermE)g(t'')g(t)g(=)h(t)-75 81 y(data)f(ValueE)g(v'')g(v)g(=)h(Err)f
(String)g(|)g(OtherVE)g(v)-75 159 y(mTE)g(=)h(Pseudomonad)d(\(\\x)i(->)h(x\))
f(\(\\x)g(f)h(->)f(f)h(x\))-75 230 y(mVE)f(=)h(Pseudomonad)d(\(\\x)i(->)h
(OtherVE)e(x\))i(mVEbind)e(where)-31 302 y(mVEbind)g(m)i(=)f(parsequux)f
(where)12 351 y(parsequux)g(\(Err)h(x\))g(f)h(=)g(unit)f(m)g(\(Err)g(x\))12
401 y(parsequux)f(\(OtherVE)g(x\))i(f)f(=)h(f)f(x)-75 479 y(errors)g
(oldprepkg)e(tmt)j(tmv)f(top)g(=)h(update)e(oldpkg)-31 528
y([ShowvalR)g(showvalE,)f(ComplainR)h(complainE,)-10 578 y(NameR)h(nameE])g
(where)-31 628 y(oldpkg)f(=)i(oldprepkg)e(\(tmt)h(&)g(mTE\))g(\(tmv)g(&)h
(mVE\))f(top)-31 678 y(complainE)f(s)h(=)h(unit)f(tmv)g(\(Err)g(s\))-31
728 y(showvalE)f(\(Err)h(x\))g(=)h("Error:)e(")i(++)f(x)-31
777 y(showvalE)f(\(OtherVE)g(x\))h(=)h(showvalr)e(oldpkg)h(x)-31
827 y(nameE)f(=)i("errors)e(")i(++)f(namer)g(oldpkg)643 919
y Fh(Figure)14 b(17:)k(The)c(errors)h(building)e(blo)q(c)o(k)p
2035 937 V -87 939 2125 2 v -75 1063 a(\(I)g(dra)o(w)f(a)g(parallel)f(to)i
(the)g(c)o(hanges)g(in)f(st)o(yle)h(of)f(an)g(assem)o(bly)-75
1113 y(language)h(programmer)e(once)k(exp)q(osed)g(to)f(the)g(principles)g
(of)-75 1163 y(structured)20 b(programming.)o(\))28 b(Moreo)o(v)o(er,)19
b(I)f(hold)g(out)g(some)-75 1213 y(hop)q(e)h(that,)g(once)g(the)f(sligh)o
(tly)f(ad)h(ho)q(c)h(tec)o(hniques)h(I)e(ha)o(v)o(e)-75 1262
y(stum)o(bled)10 b(across)j(here)f(ha)o(v)o(e)f(b)q(een)i(bac)o(k-translated)
e(in)o(to)g(ap-)-75 1312 y(propriately)h(mathematical)c(language,)j(some)g
(suitably)h(qual-)-75 1362 y(i\014ed)g(category)g(theorist)g(will)f(remark,)g
(\\Oh,)g(y)o(es,)i(that's)e(sim-)-75 1412 y(ilar)k(to)h(this)g(notion)f(w)o
(e'v)o(e)h(kno)o(wn)g(ab)q(out)g(for)g(y)o(ears;)h(it)e(has)-75
1462 y(the)f(follo)o(wing)e(marv)o(elous)g(prop)q(erties,)j(and)f(if)f(y)o
(ou)g(will)f(only)-75 1512 y(do)e(things)g Fe(this)g Fh(w)o(a)o(y)g(instead)g
(y)o(ou'll)f(ha)o(v)o(e)h(a)g(m)o(uc)o(h)f(easier)i(time)-75
1561 y(of)i(it.")18 b(Whic)o(h)13 b(is)h(an)g(excellen)o(t)g(relation)g(for)f
(theory)i(to)e(hold)-75 1611 y(to)h(practice.)-75 1727 y Ff(17)47
b(Comparison)14 b(with)h(Other)g(W)l(ork)-75 1810 y Fh(This)27
b(pap)q(er)h(is)f(essen)o(tially)g(one)g(long)f(reform)o(ulation)f(of)-75
1860 y(W)m(adler's)12 b(w)o(ork)g([16)o(])g(to)h(add)f(the)h(crucial)g
(capabilit)o(y)e(of)h(com-)-75 1910 y(p)q(osition.)23 b(It)16
b(o)o(w)o(es)g(its)g(ro)q(ots)g(to)f(all)g(the)h(w)o(ork)g(that)f(W)m(adler)
-75 1960 y(cites,)f(of)e(course,)i(notably)e(that)h(of)f(Reynolds)h([10)o(].)
k(It)c(is)g(also)-75 2010 y(in)g(the)i(spirit)f(of)f(m)o(y)f(o)o(wn)i
(earlier)g(w)o(ork)f(with)h(Sussman)f([13)o(].)-38 2059 y(In)f(this)f(presen)
o(tation)h(I)f(ha)o(v)o(e)h(omitted)d(all)i(the)g(pro)q(ofs,)h(par-)-75
2109 y(ticularly)17 b(pro)q(ofs)g(of)g(monad)f(asso)q(ciativit)o(y)m(.)27
b(In)18 b(some)e(cases)-75 2159 y(they)e(do)g(not)g(exist;)g(that)f(is,)h
(some)f(of)g(the)h(putativ)o(e)g(monads)-75 2209 y(that)g(arise)h(in)f(the)h
(in)o(terpreters)i(presen)o(ted)f(here)g(are)f(not)f(re-)-75
2259 y(ally)9 b(asso)q(ciativ)o(e.)16 b(This)10 b(obstructs)i(pro)q(ofs)e(of)
g(program)e(equiv-)-75 2309 y(alence)17 b(of)f(the)h(kind)e(discussed)j(b)o
(y)e(W)m(adler)g([16)o(])g(but)g(other-)-75 2358 y(wise)g(seems)g(to)f(ha)o
(v)o(e)h(little)e(practical)i(e\013ect.)25 b(Nev)o(ertheless,)-75
2408 y(further)18 b(in)o(v)o(estigation)d(is)i(w)o(arran)o(ted.)27
b(Certain)17 b(simple)e(but)-75 2458 y(imp)q(ortan)o(t)j(cases,)k(suc)o(h)e
(as)g(lists)f(and)h(simple)e(copro)q(ducts,)-75 2508 y(are)h(w)o(ell-b)q(eha)
o(v)o(ed;)i(when)e(pro)o(vided)g(as)g(pseudomonads)f(to)-75
2558 y(the)c(comp)q(osition)e(op)q(erator)j Fg(&)e Fh(the)i(result)f(ob)q
(eys)h(the)f(monad)-75 2607 y(asso)q(ciativ)o(e)h(la)o(w)f(and)h(therefore)h
(really)f(is)f(alw)o(a)o(ys)g(a)h(monad.)-75 2657 y(King)10
b(and)h(W)m(adler)e([5],)h(for)g(example,)g(consider)h(not)g(only)f(lists)
1022 1063 y(but)k(also)g(trees,)h(bags,)e(and)h(sets.)1060
1113 y(Simon)8 b(P)o(eyton)j(Jones)h(and)e(W)m(adler)g(ha)o(v)o(e)g(in)o(v)o
(estigated)g(the)1022 1163 y(use)17 b(of)f(monads)f(to)h(p)q(erform)f(I/O)h
(and)g(other)h(\\imp)q(erativ)o(e")1022 1213 y(tasks)e(within)e(a)g(w)o
(orking)g(compiler)g(co)q(ded)i(in)e(Hask)o(ell)g([7].)1060
1262 y(Jonathan)25 b(Rees)h(has)f(co)q(ded)h(monadic)e(in)o(terpreters)j(in)
1022 1312 y(Sc)o(heme)21 b(but)h(this)f(w)o(ork)g(apparen)o(tly)g(has)g(not)h
(b)q(een)g(pub-)1022 1362 y(lished)14 b([9)o(].)1060 1412 y(Mark)f(Jones)h
(has)f(dev)o(elop)q(ed)h(Gofer,)f(a)g(v)n(arian)o(t)f(of)g(Hask)o(ell)1022
1462 y(that)g(allo)o(ws)f(additional)f(p)q(olymorphism)f(through)j(the)h(use)
g(of)1022 1512 y(t)o(yp)q(e)g(classes)f([4].)17 b(Gofer)11
b(supp)q(orts)i(programmi)o(ng)c(with)i(m)o(ul-)1022 1561 y(tiple)k(monads,)e
(including)g(a)i(cleaner)g(v)o(ersion)g(of)f(the)i(monad)1022
1611 y(comprehension)d(syn)o(tax)g(prop)q(osed)h(b)o(y)f(W)m(adler)f([15)o
(].)17 b(Repre-)1022 1661 y(sen)o(ting)g(monads)e(as)h(a)g(Gofer)g(t)o(yp)q
(e)h(class)f(allo)o(ws)f(the)i(Gofer)1022 1711 y(t)o(yp)q(e)11
b(system)e(to)h(deduce)h(whic)o(h)f(monad)e(is)i(in)o(tended)g(in)g(a)f(unit)
1022 1761 y(or)14 b(bind)e(op)q(eration,)h(a)o(v)o(oiding)e(the)j(need)h(to)e
(reify)g(monads)e(in)1022 1810 y(the)19 b(manner)e(sho)o(wn)h(in)g(this)g
(pap)q(er.)31 b(Jones)19 b(has)f(b)q(egun)g(to)1022 1860 y(explore)e(the)f(p)
q(ossibilit)o(y)f(of)h(reco)q(ding)g(the)h(in)o(terpreters)h(pre-)1022
1910 y(sen)o(ted)i(here)g(so)e(as)h(to)f(use)h(Gofer's)f(simpler)f(monadic)g
(pro-)1022 1960 y(gramming)10 b(st)o(yle)15 b([3)o(].)1060
2010 y(Man)o(y)d(of)h(the)h(ideas)f(presen)o(ted)j(here)e(w)o(ere)g(an)o
(ticipated)f(b)o(y)1022 2059 y(Moggi)g([6)o(]:)1126 2131 y(T)m(o)22
b(giv)o(e)g(seman)o(tics)h(to)f(a)h(complex)e(language)1126
2180 y Fd(L)g Fh(w)o(e)h(prop)q(ose)g(a)f(step)o(wise)h(approac)o(h,)g(whic)o
(h)1126 2230 y(starts)11 b(from)c(a)i(monad)f(\(notion)h(of)g(computation\))
1126 2280 y(corresp)q(onding)j(to)f(a)g(to)o(y)f(sublanguage)h(of)f
Fd(L)h Fh(and)1126 2330 y(then)j(at)f(eac)o(h)g(step)h(applies)f(a)f
Fe(monad)j(c)n(onstruc-)1126 2380 y(tor)e Fh(whic)o(h)h(adds)g(one)g(feature)
h(to)f(the)g(language.)1022 2451 y(Moggi)i(then)h(go)q(es)g(on)f(to)g(presen)
o(t)i(theoretical)f(descriptions)1022 2501 y(of)g(sev)o(eral)h(useful)g
(monad)d(constructors,)20 b(including)d(excep-)1022 2551 y(tions,)12
b(side)h(e\013ects,)h(and)e(con)o(tin)o(uations.)17 b(T)m(o)11
b(the)i(b)q(est)g(of)f(our)1022 2600 y(kno)o(wledge,)g(ho)o(w)o(ev)o(er,)g
(the)h(w)o(ork)e(presen)o(ted)k(here)e(is)f(the)g(\014rst)1022
2650 y(to)h(put)g(this)g(idea)f(in)o(to)g(practice)i(to)f(pro)q(duce)h
(actual)e(w)o(orking)1022 2700 y(in)o(terpreters)k(from)d(monad-lik)n(e)f
(building)g(blo)q(c)o(ks.)p eop
%%Page: 20 20
20 19 bop -38 -33 a Fh(Our)15 b(w)o(ork)e(also)g(factors)i(Moggi's)d(monad)g
(constructors)k(in)-75 16 y(an)f(in)o(teresting)g(w)o(a)o(y)f(in)o(to)g(t)o
(w)o(o)h(parts:)20 b(a)15 b(pseudomonad)f(and)-75 66 y(the)i(comp)q(osition)d
(op)q(erator)i Fg(&)p Fh(.)21 b(The)16 b(comp)q(osition)d(op)q(erator)-75
116 y(is)h(a)g(non)o(v)n(arying)f(asso)q(ciativ)o(e)i(op)q(erator)g(with)f
(left)g(and)g(righ)o(t)-75 166 y(iden)o(tit)o(y;)e(a)f(pseudomonad)g(is)h
(almost)e(iden)o(tical)h(in)g(structure)-75 216 y(to)16 b(a)f(monad.)22
b(If)15 b Fg(p)h Fh(is)f(a)h(pseudomonad,)e(then)j Fg(\(&p\))e
Fh(\(whic)o(h)-75 265 y(in)d(Hask)o(ell)g(means)g(the)h(same)f(as)g
Fg(\\x)22 b(->)f(\(x&p\))p Fh(\))12 b(is)g(a)g(monad)-75 315
y(constructor,)22 b(mapping)c(a)h(monad)f(in)o(to)h(a)g(new)h(monad.)34
b(I)-75 365 y(think)13 b(that)h(this)g(factoring)f(usefully)g(structures)j
(and)d(simpli-)-75 415 y(\014es)19 b(the)g(necessary)h(pro)q(ofs)f(that)f(a)g
(comp)q(osed)g(monad)e(will)-75 465 y(satisfy)e(the)g(monad)e(la)o(ws.)-75
581 y Ff(18)47 b(Conclusions)14 b(and)h(F)l(uture)f(W)l(ork)-75
664 y Fh(The)k(title)f(of)g(this)h(pap)q(er)g(slyly)f(pla)o(ys)g(on)g(an)h
(am)o(biguit)o(y)c(in)-75 714 y(the)g(use)g(of)e(the)i(English)f(v)o(erb)h
(\\to)e(comp)q(ose":)17 b(the)d(ob)r(ject)g(of)-75 764 y(the)j(v)o(erb)g(ma)o
(y)e(indicate)i(either)g(the)g Fe(inputs)g Fh(or)g(the)g Fe(outputs)-75
813 y Fh(of)f(the)g(comp)q(osition)f(op)q(eration.)24 b(Indeed,)18
b(y)o(ou)d(can't)h(really)-75 863 y(comp)q(ose)11 b(\(i.e.,)f
Fe(c)n(ombine)p Fh(\))i(t)o(w)o(o)e(monads)g(and)h(get)g(a)g(monad)f(as)-75
913 y(the)i(result.)18 b(But)12 b(y)o(ou)e(can)i(comp)q(ose)f(\(i.e.,)f
Fe(pr)n(o)n(duc)n(e)p Fh(\))i(a)e(monad)-75 963 y(from)i(t)o(w)o(o)i(other)h
(things)f(\(not)h(b)q(oth)f(of)g(whic)o(h)g(are)g(monads\).)-75
1013 y(Our)19 b(tec)o(hnique)h(do)q(es)f(comp)q(ose)f(monads)f(in)h(this)h
(sense)h(b)o(y)-75 1062 y(applying)13 b(a)g(comp)q(osition)f(op)q(erator)j
(to)e(pseudomonads.)-38 1112 y(An)i(imp)q(ortan)o(t)f(lesson)h(from)e(this)i
(w)o(ork)g(is)g(that)g(the)g(com-)-75 1162 y(p)q(osition)c(op)q(eration)g(is)
h(asso)q(ciativ)o(e)f(but)h(in)f(general)h(not)f(com-)-75 1212
y(m)o(utativ)o(e.)21 b(The)15 b(practical)h(result)g(is)f(that)g(it)g(really)
g(matters)-75 1262 y(in)d(what)f(order)i(y)o(ou)f(com)o(bine)e(the)j
(building)d(blo)q(c)o(ks.)18 b(Tw)o(o)11 b(in-)-75 1311 y(terpreters)j(built)
c(from)g(the)i(same)e(building)g(blo)q(c)o(ks)h(com)o(bined)-75
1361 y(in)i(di\013eren)o(t)h(orders)g(ma)o(y)e(ha)o(v)o(e)h(di\013eren)o(t)h
(\(p)q(erhaps)h(m)o(ysteri-)-75 1411 y(ously)e(di\013eren)o(t\))i(b)q(eha)o
(viors.)-38 1461 y(It)g(should)f(b)q(e)h(clear)g(that,)f(ev)o(en)i(using)e
(only)f(the)i(small)e(set)-75 1511 y(of)g(building)e(blo)q(c)o(ks)j(presen)o
(ted)h(here,)f(w)o(e)f(can)h(automatically)-75 1561 y(construct)j(more)d(in)o
(terpreters)k(than)d(y)o(ou)f(can)i(shak)o(e)f(a)g(stic)o(k)-75
1610 y(at.)37 b(\(I)20 b(w)o(as)g(sorely)h(tempted)f(to)g(title)g(this)g(pap)
q(er)h(\\In)o(ter-)-75 1660 y(preters)c(for)d(F)m(ree!")h([17)o(])g(but)g
(though)o(t)f(b)q(etter)j(of)d(it.\))21 b(I)15 b(ha)o(v)o(e)-75
1710 y(constructed)i(man)o(y)c(more)g(in)o(terpreters)k(than)e(I)f(ha)o(v)o
(e)h(sho)o(wn)-75 1760 y(here)e(and)e(am)e(w)o(orking)i(on)g(other)h
(building)e(blo)q(c)o(ks,)h(for)g(state,)-75 1810 y(output,)j(and)f(string)h
(data,)f(for)h(example.)-38 1859 y(The)k(building)d(blo)q(c)o(ks)i(sho)o(wn)g
(here)h(transform)e(the)h(v)n(alue)-75 1909 y(t)o(yp)q(e)11
b(in)f(a)h(v)n(ariet)o(y)f(of)g(w)o(a)o(ys)g(but)h(all)e(do)i(the)g(same)e
(thing)i(to)f(the)-75 1959 y(term)i(t)o(yp)q(e,)h(adding)f(a)h(few)g
(alternativ)o(es)g(to)f(one)h(big)g(disjunc-)-75 2009 y(tion.)28
b(What)17 b(if)f(some)h(pseudomonad)f(did)h(some)f(non)o(trivial)-75
2059 y(computation)9 b(on)i(terms?)17 b(Presto!)i(W)m(e)10
b(ha)o(v)o(e)h(macros.)16 b(There)-75 2108 y(should)g(b)q(e)g(a)g
Fg(macros)e Fh(building)h(blo)q(c)o(k.)23 b(It)16 b(w)o(ould)f(lea)o(v)o(e)h
(the)-75 2158 y(v)n(alue)11 b(t)o(yp)q(e)i(alone)f(but)g(transform)f(the)h
(term)g(data)f(t)o(yp)q(e,)i(p)q(er-)-75 2208 y(haps)h(according)g(to)g(some)
f(macro)f(en)o(vironmen)o(t.)-38 2258 y(Ho)o(w)e(ab)q(out)f(error)i(messages)
f(with)f(p)q(ositions?)16 b(W)m(adler)9 b([16)o(])-75 2308
y(remarks,)19 b(\\The)f(parser)i(will)d(pro)q(duce)i([)p Fg(At)p
Fh(])e(terms)h(as)h(suit-)-75 2358 y(able.")e(So)d(the)g(term)f(t)o(yp)q(e)h
(m)o(ust)e(b)q(e)i(extended,)h(but)f(it)f(turns)-75 2407 y(out)g(that)g(it)g
(is)g(easiest)h(to)f(mo)q(dify)d(the)k(parser)g(so)f(that)g(its)g(in-)-75
2457 y(put)e(data)e(t)o(yp)q(e)i(is)f(not)h(merely)e(a)h(string)g(but)h(a)f
(pair)g(of)g(a)g(string)-75 2507 y(\(remaining)i(to)h(b)q(e)h(parsed\))h(and)
e(a)g(p)q(osition)g(\(of)g(the)h(start)g(of)-75 2557 y(that)d(remaining)f
(string\).)17 b(So)11 b(it)g(is)g(useful)g(to)g(ha)o(v)o(e)g(more)g(than)-75
2607 y(t)o(w)o(o)i(t)o(yp)q(e)g(to)o(w)o(ers.)19 b(W)m(e)13
b(should)g(ha)o(v)o(e)g(left)g(a)g(ho)q(ok)f([8])g(so)i(that)-75
2656 y(the)g(input)g(t)o(yp)q(e)h(to)e(the)i(parser)g(could)f(b)q(e)g(c)o
(hanged.)1060 -33 y(Indeed,)26 b(it)d(is)h(unsatisfactory)g(that)f(the)i
Fg(interp)d Fh(func-)1022 16 y(tions)g(sho)o(wn)h(here)g(m)o(ust)f(alw)o(a)o
(ys)f(accept)i(an)g(extra)f(en)o(vi-)1022 66 y(ronmen)o(t)f(argumen)o(t)f
Fg(env)p Fh(.)39 b(En)o(vironmen)o(ts)20 b(are)i(irrelev)n(an)o(t)1022
116 y(in)c(the)h Fg(numbers)d Fh(building)h(blo)q(c)o(k,)h(for)g(example,)f
(or)h(in)f(the)1022 166 y Fg(nondeterministic)10 b Fh(building)h(blo)q(c)o
(k;)h(they)h(ough)o(t)g(to)f(b)q(e)i(in-)1022 216 y(tro)q(duced)h(explicitly)
d(b)o(y)h(the)h Fg(cbv)f Fh(and)g Fg(cbn)g Fh(building)e(blo)q(c)o(ks,)1022
265 y(for)24 b(only)f(they)h(are)g(explicitly)f(concerned)j(with)d(en)o
(viron-)1022 315 y(men)o(ts.)32 b(An)19 b(in)o(terpreter)h(ough)o(t)e(to)h(b)
q(e)g(purely)g(a)f(mapping)1022 365 y(from)g(terms)i(to)f(v)n(alues,)i(with)e
(no)g(extraneous)i(argumen)o(ts.)1022 415 y(Ho)o(w)o(ev)o(er,)c(it)e(do)q(es)
i(not)e(su\016ce)i(simply)d(to)i(w)o(ork)f(within)g(the)1022
465 y(v)n(alue)c(to)o(w)o(er,)g(extending)h(it)f(so)g(that)h(the)g(call-b)o
(y-v)n(alue)d(build-)1022 514 y(ing)k(blo)q(c)o(k)g(lifts)g(the)h(v)n(alue)f
(t)o(yp)q(e)h Fg(v)f Fh(to)h Fg(env)21 b(->)g(v)p Fh(.)d(The)c(prob-)1022
564 y(lem)c(is)h(that)g(if)g(further)h(building)e(blo)q(c)o(ks)h(are)g(comp)q
(osed,)g(suc)o(h)1022 614 y(as)f Fg(nondeterministic)p Fh(,)d(the)k(en)o
(vironmen)o(ts)e(will)f(not)i(b)q(e)h(\\in-)1022 664 y(herited")g(prop)q
(erly)m(.)16 b(One)11 b(solution)e(seems)h(to)g(b)q(e)g(to)g(in)o(tro)q(duce)
1022 714 y(an)17 b(additional)f(ho)q(ok)h(in)g(the)h(form)d(of)i(a)g(second)i
(term)d(t)o(yp)q(e)1022 764 y(to)o(w)o(er,)e(so)h(that)f(one)g(term)g(t)o(yp)
q(e)g(represen)o(ts)j(the)e(parser)g(out-)1022 813 y(put,)c(the)h(second)f
(represen)o(ts)j(the)d(in)o(terpreter)h(input,)f(and)f(the)1022
863 y(main)i(driv)o(er)i(calls)g(a)f(small)f(function)h(\(initially)f(the)i
(iden)o(tit)o(y)1022 913 y(function\))19 b(to)g(map)e(from)g(one)i(to)g(the)h
(other.)33 b(W)m(e)19 b(susp)q(ect)1022 963 y(that)c(a)f(full-blo)o(wn,)d
(truly)j(mo)q(dular)f(Lisp)h(in)o(terpreter)i(co)q(ded)1022
1013 y(in)g(this)g(st)o(yle)g(w)o(ould)f(need)h(a)g(fairly)e(large)i(n)o(um)o
(b)q(er)f(of)g(t)o(yp)q(es)1022 1062 y(with)f(corresp)q(onding)h(to)o(w)o
(ers.)1060 1112 y(The)h(tec)o(hniques)i(presen)o(ted)g(here)g(are)e(quite)h
(general)f(and)1022 1162 y(need)g(not)f(b)q(e)g(limited)d(to)j(the)g
(construction)h(of)e(in)o(terpreters;)1022 1212 y(in)o(terpreters)23
b(are)e(merely)f(a)g(go)q(o)q(d)g(sub)r(ject)i(for)e(exp)q(osition)1022
1262 y(in)15 b(academic)f(pap)q(ers)i(b)q(ecause)h(their)f(b)q(eha)o(vior)f
(is)g(relatviely)1022 1311 y(complex)h(relativ)o(e)h(to)g(the)h(size)f(of)g
(co)q(de)h(needed)g(to)f(express)1022 1361 y(it.)j(Monads)15
b(\(and)g(pseudomonads\))f(are)h(lik)o(ely)e(to)i(b)q(e)g(useful)1022
1411 y(in)i(an)o(y)g(soft)o(w)o(are)h(system)f(that)h(requires)h(easy)f(and)f
(\015exible)1022 1461 y(extensibilit)o(y)m(.)1060 1511 y(The)j(use)g(of)f(a)g
(monad)f(is)h(a)g(ho)q(ok,)h(a)f(p)q(o)o(w)o(erful)g(ho)q(ok,)h(a)1022
1561 y(ho)q(ok)c(with)h Fe(typ)n(e)g(discipline)p Fh(.)25 b(A)17
b(monad)e(has)h(an)h(ey)o(e;)g(when)1022 1610 y(y)o(ou)h(hang)g(a)g(monad)f
(on)h(the)h(ho)q(ok,)f(it)g(uses)i(up)e(the)h(ho)q(ok.)1022
1660 y(A)d(pseudomonad)f(has)h(an)f(ey)o(e)i(on)e(one)h(end)h(and)e(a)h(ho)q
(ok)f(on)1022 1710 y(the)i(other.)26 b(Y)m(ou)15 b(can)h(c)o(hain)g(them.)24
b(\(Hm.)g(I'm)14 b(mixing)g(m)o(y)1022 1760 y(metaphors.)i(First)11
b(to)o(w)o(ers,)g(no)o(w)e(c)o(hains.\))17 b(When)10 b(y)o(ou)g(hang)f(a)1022
1810 y(pseudomonad)j(on)h(a)g(ho)q(ok,)g(there's)h(still)e(a)h(ho)q(ok)g
(left)g(to)g(use.)1022 1859 y(I)19 b(w)o(onder)g(whether)h(the)f(Macin)o
(tosh)f(to)q(olb)q(o)o(x)g([1)o(])g(could)g(b)q(e)1022 1909
y(de\014ned)13 b(in)e(terms)h(of)f(a)g(large)g(set)i(of)e(pseudomonads,)g
(lending)1022 1959 y(some)16 b(structure)i(to)e(the)h(games)e(pla)o(y)o(ed)h
(b)o(y)g(v)n(arious)f(add-on)1022 2009 y(soft)o(w)o(are)f(pac)o(k)n(ages)g
(to)g(in)o(tercept)h(system)f(calls?)1022 2125 y Ff(19)48 b(Ac)o(kno)o
(wledgmen)o(t)o(s)1022 2208 y Fh(I)23 b(wish)f(to)g(thank)h(Philip)e(W)m
(adler,)i(Mark)g(Jones,)i(Olivier)1022 2258 y(Dan)o(vy)m(,)f(P)o(aul)e
(Hudak,)j(and)e(the)g(conference)i(referees)g(for)1022 2308
y(their)c(helpful)e(remarks.)36 b(P)o(aul)20 b(Hudak,)h(Phil)e(W)m(adler,)i
(Si-)1022 2358 y(mon)c(P)o(eyton)i(Jones,)h(and)e(Lennart)h(Augustsson)g(pro)
o(vided)1022 2407 y(helpful)j(advice)g(on)g(the)h(use)g(of)e(Hask)o(ell.)43
b(I)22 b(am)e(grateful)1022 2457 y(for)c(access)h(to)f(four)f(di\013eren)o(t)
i(implemen)o(tations)c(of)i(Hask)o(ell:)1022 2507 y(Y)m(ale)i(Hask)o(ell,)h
(Glasgo)o(w)e(Hask)o(ell,)i(Chalmers)e(Hask)o(ell,)i(and)1022
2557 y(Jones')i(Gofer)f(system.)34 b(Jonathan)19 b(Rees,)i(Dan)e(F)m
(riedman,)1022 2607 y(and)e(Mitc)o(h)f(W)m(and)f(also)h(pro)o(vided)g(useful)
h(information)c(and)1022 2656 y(encouragemen)o(t.)p eop
%%Page: 21 21
21 20 bop -75 -33 a Ff(References)-54 50 y Fh([1])19 b(Apple)e(Computer,)e
(Inc.)25 b Fe(Inside)17 b(Macintosh)g Fh(\(\014v)o(e)g(v)o(ol-)10
99 y(umes\).)28 b(Addison-W)m(esley)16 b(\(Reading,)h(Massac)o(h)o(usetts,)10
149 y(1985{86\).)-54 214 y([2])i(Hudak,)h(P)o(aul,)g(P)o(eyton)g(Jones,)h
(Simon,)d(and)h(W)m(adler,)10 263 y(Philip,)e(editors.)30 b
Fe(R)n(ep)n(ort)18 b(on)g(the)h(Pr)n(o)n(gr)n(amming)e(L)n(an-)10
313 y(guage)25 b(Haskel)r(l:)35 b(A)23 b(Non-Strict,)i(Pur)n(ely)e(F)m
(unctional)10 363 y(L)n(anguage)e(\(V)m(ersion)d(1.1\))p Fh(.)33
b(T)m(ec)o(hnical)18 b(Rep)q(ort.)32 b(Y)m(ale)10 413 y(Univ)o(ersit)o(y)24
b(and)f(Glasgo)o(w)g(Univ)o(ersit)o(y)g(\(New)i(Ha)o(v)o(en)10
463 y(and)14 b(Glasgo)o(w)e(\(resp)q(ectiv)o(ely\),)k(August)e(1991\).)-54
527 y([3])19 b(Jones,)i(Mark)e(P)m(.)32 b(P)o(ersonal)19 b(comm)o(unication)c
(to)k(Guy)10 577 y(Steele,)c(Septem)o(b)q(er)f(1993.)-54 641
y([4])19 b(Jones,)i(Mark)e(P)m(.)33 b(A)19 b(system)g(of)f(constructor)j
(classes:)10 691 y(Ov)o(erloading)26 b(and)h(implicit)d(higher-order)k(p)q
(olymor-)10 741 y(phism.)36 b(In)20 b Fe(Pr)n(o)n(c.)g(FPCA)h('93:)31
b(The)20 b(Sixth)i(Interna-)10 791 y(tional)11 b(Confer)n(enc)n(e)g(on)g(F)m
(unctional)g(Pr)n(o)n(gr)n(amming)f(L)n(an-)10 840 y(guages)25
b(and)f(Computer)g(A)o(r)n(chite)n(ctur)n(e)p Fh(.)46 b(A)o(CM)23
b(SIG-)10 890 y(PLAN/SIGAR)o(CH)c(and)h(IFIP)g(\(London,)g(Septem)o(b)q(er)10
940 y(1993\).)-54 1004 y([5])f(King,)i(Da)o(vid)e(J.,)h(and)g(W)m(adler,)g
(Philip.)35 b(Com)o(bining)10 1054 y(monads.)14 b(In)e Fe(F)m(unctional)i(Pr)
n(o)n(gr)n(amming,)f(Glasgow)g('92)p Fh(.)10 1104 y(Springer)i(V)m(erlag)e
(\(Berlin,)h(1992\).)-54 1168 y([6])19 b(Moggi,)i(Eugenio.)37
b Fe(A)o(n)21 b(A)o(bstr)n(act)f(View)g(of)h(Pr)n(o)n(gr)n(am-)10
1218 y(ming)16 b(L)n(anguages)p Fh(.)21 b(T)m(ec)o(hnical)14
b(Rep)q(ort)g(ECS-LF)o(CS-90-)10 1268 y(113.)j(Lab)q(oratory)c(for)g(F)m
(oundations)g(of)g(Computer)g(Sci-)10 1318 y(ence,)24 b(Univ)o(ersit)o(y)c
(of)g(Edin)o(burgh)h(\(Edin)o(burgh,)g(Scot-)10 1368 y(land,)11
b(April)f(1990\).)i(Lecture)g(notes)g(for)e(a)h(course)h(taugh)o(t)10
1417 y(at)i(Stanford)g(Univ)o(ersit)o(y)m(,)f(Spring)g(1989.)-54
1482 y([7])19 b(P)o(eyton)e(Jones,)g(Simon)e(L.,)g(and)i(W)m(adler,)e
(Philip.)24 b(Im-)10 1531 y(p)q(erativ)o(e)12 b(functional)f(programming)o(.)
h(In)f Fe(Pr)n(o)n(c.)i(Twenti-)10 1581 y(eth)h(A)o(nnual)f(A)o(CM)g(Symp)n
(osium)h(on)g(Principles)f(of)g(Pr)n(o-)10 1631 y(gr)n(amming)18
b(L)n(anguages)p Fh(.)29 b(Asso)q(ciation)17 b(for)g(Computing)10
1681 y(Mac)o(hinery)k(\(Charleston,)h(South)f(Carolina,)f(Jan)o(uary)10
1731 y(1993\),)13 b(1{14.)-54 1795 y([8])19 b(Ra)o(ymond,)h(Eric,)i(editor.)
38 b Fe(The)21 b(New)g(Hacker's)g(Dic-)10 1845 y(tionary)p
Fh(.)39 b(MIT)20 b(Press)j(\(Cam)o(bridge,)d(Massac)o(h)o(usetts,)10
1895 y(1991\).)-54 1959 y([9])f(Rees,)g(Jonathan.)27 b(P)o(ersonal)17
b(comm)o(unication)d(to)j(Guy)10 2009 y(Steele,)e(Octob)q(er)g(1993.)-75
2073 y([10])k(Reynolds,)25 b(John)e(C.)45 b(De\014nitional)22
b(in)o(terpreters)j(for)10 2123 y(higher)g(order)g(programming)c(languages.)
49 b(In)24 b Fe(Pr)n(o)n(c.)10 2173 y(A)o(CM)18 b(National)g(Confer)n(enc)n
(e)p Fh(.)27 b(Asso)q(ciation)17 b(for)g(Com-)10 2223 y(puting)11
b(Mac)o(hinery)h(\(Boston,)g(August)f(1972\),)g(717{740.)-75
2287 y([11])19 b(Steele,)27 b(Guy)c(L.,)i(Jr.)48 b Fe(How)24
b(to)g(Comp)n(ose)g(Monads)p Fh(.)10 2337 y(T)m(ec)o(hnical)13
b(Rep)q(ort.)j(Thinking)c(Mac)o(hines)h(Corp)q(oration)10 2387
y(\(Cam)o(bridge,)19 b(Massac)o(h)o(usetts,)k(July)c(1993\).)34
b(Unpub-)10 2436 y(lished.)-75 2501 y([12])19 b(Steele,)k(Guy)d(L.,)h(Jr.,)h
(F)m(ahlman,)d(Scott)i(E.,)h(Gabriel,)10 2551 y(Ric)o(hard)17
b(P)m(.,)f(Mo)q(on,)i(Da)o(vid)d(A.,)i(W)m(einreb,)h(Daniel)e(L.,)10
2600 y(Bobro)o(w,)k(Daniel)e(G.,)h(DeMic)o(hiel,)g(Linda)g(G.,)f(Keene,)10
2650 y(Son)o(y)o(a)f(E.,)i(Kiczales,)g(Gregor,)f(P)o(erdue,)i(Crispin,)e
(Pit-)10 2700 y(man,)j(Ken)o(t)h(M.,)f(W)m(aters,)i(Ric)o(hard)d(C.,)i(and)e
(White,)1108 -33 y(Jon)k(L.)48 b Fe(Common)24 b(Lisp:)37 b(The)25
b(L)n(anguage)g(\(Se)n(c)n(ond)1108 16 y(Edition\))p Fh(.)35
b(Digital)17 b(Press)k(\(Bedford,)g(Massac)o(h)o(usetts,)1108
66 y(1990\).)1022 133 y([13])f(Steele,)d(Guy)g(Lewis,)g(Jr.,)f(and)h
(Sussman,)f(Gerald)g(Ja)o(y)m(.)1108 182 y Fe(The)27 b(A)o(rt)g(of)h(the)g
(Interpr)n(eter;)33 b(or,)d(The)e(Mo)n(dular-)1108 232 y(ity)c(Complex)g
(\(Parts)g(Zer)n(o,)j(One,)g(and)e(Two\))p Fh(.)49 b(AI)1108
282 y(Memo)13 b(453.)20 b(MIT)14 b(Arti\014cial)g(In)o(telligence)h(Lab)q
(oratory)1108 332 y(\(Cam)o(bridge,)c(Massac)o(h)o(usetts,)16
b(Ma)o(y)d(1978\).)1022 398 y([14])20 b(Sussman,)d(Gerald)h(Ja)o(y)m(,)g(and)
g(Steele,)i(Guy)d(Lewis,)i(Jr.)1108 448 y Fe(SCHEME:)25 b(A)o(n)g(Interpr)n
(eter)f(for)g(Extende)n(d)j(L)n(amb)n(da)1108 498 y(Calculus)p
Fh(.)13 b(AI)e(Memo)f(349.)j(MIT)e(Arti\014cial)g(In)o(telligence)1108
548 y(Lab)q(oratory)i(\(Cam)o(bridge,)e(Massac)o(h)o(usetts,)k(Decem)o(b)q
(er)1108 597 y(1975\).)1022 664 y([15])20 b(W)m(adler,)30 b(Philip.)60
b(Comprehending)27 b(monads.)59 b(In)1108 714 y Fe(Pr)n(o)n(c.)20
b(1990)i(A)o(CM)f(Symp)n(osium)g(on)h(Lisp)f(and)h(F)m(unc-)1108
764 y(tional)e(Pr)n(o)n(gr)n(amming)p Fh(.)33 b(A)o(CM)20 b(SIGPLAN/SIGA)o
(CT/)1108 813 y(SIGAR)m(T)h(\(Nice,)j(F)m(rance,)g(June)f(1990\),)g(61{77.)42
b(T)m(o)1108 863 y(app)q(ear)18 b(in)g(the)h(journal)f Fe(Mathematic)n(al)g
(Structur)n(es)h(in)1108 913 y(Computer)14 b(Scienc)n(e)p Fh(.)1022
979 y([16])20 b(W)m(adler,)11 b(Philip.)i(The)f(essence)j(of)c(functional)g
(program-)1108 1029 y(ming.)30 b(In)19 b Fe(Pr)n(o)n(c.)g(Ninete)n(enth)g(A)o
(nnual)h(A)o(CM)f(Symp)n(o-)1108 1079 y(sium)11 b(on)h(Principles)g(of)f(Pr)n
(o)n(gr)n(amming)g(L)n(anguages)p Fh(.)j(As-)1108 1129 y(so)q(ciation)f(for)g
(Computing)e(Mac)o(hinery)j(\(Albuquerque,)1108 1179 y(New)g(Mexico,)g(Jan)o
(uary)f(1992\),)g(1{14.)1022 1245 y([17])20 b(W)m(adler,)25
b(Philip.)46 b(Theorems)24 b(for)g(free!)73 b(In)24 b Fe(Pr)n(o)n(c.)1108
1295 y(FPCA)19 b('89:)28 b(The)20 b(F)m(ourth)f(International)h(Confer)n(enc)
n(e)1108 1345 y(on)e(F)m(unctional)g(Pr)n(o)n(gr)n(amming)f(L)n(anguages)i
(and)f(Com-)1108 1394 y(puter)23 b(A)o(r)n(chite)n(ctur)n(e)p
Fh(.)46 b(A)o(CM)24 b(SIGPLAN/SIGAR)o(CH)1108 1444 y(and)13
b(IFIP)i(\(London,)e(Septem)o(b)q(er)h(1989\),)f(347{359.)1022
1511 y([18])20 b(W)m(aters,)e(Ric)o(hard)g(C.)30 b Fe(XP:)18
b(A)g(Common)h(Lisp)g(Pr)n(etty)1108 1561 y(Printing)11 b(System)p
Fh(.)i(AI)e(Memo)e(1102.)j(MIT)e(Arti\014cial)g(In-)1108 1610
y(telligence)17 b(Lab)q(oratory)f(\(Cam)o(bridge,)f(Massac)o(h)o(usetts,)1108
1660 y(Marc)o(h)f(1989\).)1022 1727 y([19])20 b(W)m(egbreit,)13
b(Ben,)h(Hollo)o(w)o(a)o(y)m(,)d(Glenn,)i(Spitzen,)h(Ja)o(y)m(,)f(and)1108
1776 y(T)m(o)o(wnley)m(,)e(Judy)m(.)17 b Fe(ECL)e(Pr)n(o)n(gr)n(ammer's)e
(Manual)p Fh(.)18 b(T)m(ec)o(h-)1108 1826 y(nical)13 b(Rep)q(ort)i(23-74.)k
(Harv)n(ard)14 b(Univ)o(ersit)o(y)h(Cen)o(ter)g(for)1108 1876
y(Researc)o(h)23 b(in)f(Computing)f(T)m(ec)o(hnology)g(\(Cam)o(bridge,)1108
1926 y(Massac)o(h)o(usetts,)15 b(Decem)o(b)q(er)f(1974\).)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
